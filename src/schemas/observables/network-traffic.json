{
  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/observables/network-traffic.json",
  "$schema": "http://json-schema.org/draft/2020-12/schema#",
  "title": "network-traffic",
  "description": "The Network Traffic Object represents arbitrary network traffic that originates from a source and is addressed to a destination.",
  "type": "object",
  "allOf": [
    {
      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/cyber-observable-core.json",
      "$schema": "http://json-schema.org/draft/2020-12/schema#",
      "title": "cyber-observable-core",
      "description": "Common properties and behavior across all Cyber Observable Objects.",
      "type": "object",
      "properties": {
        "type": {
          "type": "string",
          "pattern": "^([a-z][a-z0-9]*)+(-[a-z0-9]+)*\\-?$",
          "minLength": 3,
          "maxLength": 250,
          "description": "Indicates that this object is an Observable Object. The value of this property MUST be a valid Observable Object type name, but to allow for custom objects this has been removed from the schema.",
          "not": {
            "enum": [
              "action"
            ]
          }
        },
        "spec_version": {
          "type": "string",
          "enum": [
            "2.0",
            "2.1"
          ],
          "description": "The version of the STIX specification used to represent the content in this cyber-observable."
        },
        "object_marking_refs": {
          "type": "array",
          "description": "The list of marking-definition objects to be applied to this object.",
          "items": {
            "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/identifier.json",
            "$schema": "http://json-schema.org/draft/2020-12/schema#",
            "title": "identifier",
            "description": "Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.",
            "type": "string",
            "pattern": "^[a-z][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
          },
          "minItems": 1
        },
        "granular_markings": {
          "type": "array",
          "description": "The set of granular markings that apply to this object.",
          "items": {
            "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/granular-marking.json",
            "$schema": "http://json-schema.org/draft/2020-12/schema#",
            "title": "granular-marking",
            "description": "The granular-marking type defines how the list of marking-definition objects referenced by the marking_refs property to apply to a set of content identified by the list of selectors in the selectors property.",
            "type": "object",
            "properties": {
              "selectors": {
                "type": "array",
                "description": "A list of selectors for content contained within the STIX object in which this property appears.",
                "items": {
                  "type": "string",
                  "pattern": "^([a-z0-9_-]{3,249}(\\.(\\[\\d+\\]|[a-z0-9_-]{1,250}))*|id)$"
                },
                "minItems": 1
              },
              "lang": {
                "type": "string",
                "description": "Identifies the language of the text identified by this marking."
              },
              "marking_ref": {
                "allOf": [
                  {
                    "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/identifier.json",
                    "$schema": "http://json-schema.org/draft/2020-12/schema#",
                    "title": "identifier",
                    "description": "Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.",
                    "type": "string",
                    "pattern": "^[a-z][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
                  },
                  {
                    "pattern": "^marking-definition--",
                    "description": "The marking_ref property specifies the ID of the marking-definition object that describes the marking."
                  }
                ]
              }
            },
            "required": [
              "selectors",
              "marking_ref"
            ]
          },
          "minItems": 1
        },
        "defanged": {
          "type": "boolean",
          "description": "Defines whether or not the data contained within the object has been defanged."
        },
        "id": {
          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/identifier.json",
          "$schema": "http://json-schema.org/draft/2020-12/schema#",
          "title": "identifier",
          "description": "Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.",
          "type": "string",
          "pattern": "^[a-z][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
        },
        "extensions": {
          "description": "Specifies any extensions of the object, as a dictionary.",
          "type": "object",
          "minProperties": 1,
          "patternProperties": {
            "^([a-z][a-z0-9]*)+(-[a-z0-9]+)*\\-ext$": {
              "type": "object",
              "minProperties": 1,
              "allOf": [
                {
                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/properties.json",
                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                  "title": "properties",
                  "description": "Rules for custom properties",
                  "patternProperties": {
                    "^[a-z][a-z0-9_]{0,245}_bin$": {
                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/binary.json",
                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                      "title": "binary",
                      "description": "The ​binary data type represents a sequence of bytes. In order to allow pattern matching on custom objects, for all properties that use the binary type, the property name MUST end with '_bin'. The JSON MTI serialization represents this as a base64-­encoded string as specified in RFC4648​. Other serializations SHOULD use a native binary type, if available.",
                      "type": "string",
                      "pattern": "^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$"
                    },
                    "^[a-z][a-z0-9_]{0,245}_hex$": {
                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                      "title": "hex",
                      "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                      "type": "string",
                      "pattern": "^([a-fA-F0-9]{2})+$"
                    },
                    "^([a-z][a-z0-9_]{2,249})|id$": {
                      "anyOf": [
                        {
                          "type": "array",
                          "minItems": 1
                        },
                        {
                          "type": "string"
                        },
                        {
                          "type": "integer"
                        },
                        {
                          "type": "boolean"
                        },
                        {
                          "type": "number"
                        },
                        {
                          "type": "object"
                        }
                      ]
                    }
                  },
                  "additionalProperties": false
                }
              ]
            },
            "^extension-definition--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$": {
              "allOf": [
                {
                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/extension.json",
                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                  "type": "object",
                  "minProperties": 1,
                  "properties": {
                    "extension_type": {
                      "description": "The type of extension.",
                      "type": "string",
                      "enum": [
                        "new-sdo",
                        "new-sco",
                        "new-sro",
                        "property-extension",
                        "toplevel-property-extension"
                      ]
                    }
                  },
                  "allOf": [
                    {
                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/properties.json",
                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                      "title": "properties",
                      "description": "Rules for custom properties",
                      "patternProperties": {
                        "^[a-z][a-z0-9_]{0,245}_bin$": {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/binary.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "binary",
                          "description": "The ​binary data type represents a sequence of bytes. In order to allow pattern matching on custom objects, for all properties that use the binary type, the property name MUST end with '_bin'. The JSON MTI serialization represents this as a base64-­encoded string as specified in RFC4648​. Other serializations SHOULD use a native binary type, if available.",
                          "type": "string",
                          "pattern": "^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$"
                        },
                        "^[a-z][a-z0-9_]{0,245}_hex$": {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "hex",
                          "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                          "type": "string",
                          "pattern": "^([a-fA-F0-9]{2})+$"
                        },
                        "^([a-z][a-z0-9_]{2,249})|id$": {
                          "anyOf": [
                            {
                              "type": "array",
                              "minItems": 1
                            },
                            {
                              "type": "string"
                            },
                            {
                              "type": "integer"
                            },
                            {
                              "type": "boolean"
                            },
                            {
                              "type": "number"
                            },
                            {
                              "type": "object"
                            }
                          ]
                        }
                      },
                      "additionalProperties": false
                    }
                  ],
                  "required": [
                    "extension_type"
                  ],
                  "definitions": {
                    "extension-type-enum": {
                      "type": "string",
                      "enum": [
                        "new-sdo",
                        "new-sco",
                        "new-sro",
                        "property-extension",
                        "toplevel-property-extension"
                      ]
                    }
                  }
                }
              ]
            }
          },
          "additionalProperties": false
        }
      },
      "allOf": [
        {
          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/properties.json",
          "$schema": "http://json-schema.org/draft/2020-12/schema#",
          "title": "properties",
          "description": "Rules for custom properties",
          "patternProperties": {
            "^[a-z][a-z0-9_]{0,245}_bin$": {
              "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/binary.json",
              "$schema": "http://json-schema.org/draft/2020-12/schema#",
              "title": "binary",
              "description": "The ​binary data type represents a sequence of bytes. In order to allow pattern matching on custom objects, for all properties that use the binary type, the property name MUST end with '_bin'. The JSON MTI serialization represents this as a base64-­encoded string as specified in RFC4648​. Other serializations SHOULD use a native binary type, if available.",
              "type": "string",
              "pattern": "^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$"
            },
            "^[a-z][a-z0-9_]{0,245}_hex$": {
              "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
              "$schema": "http://json-schema.org/draft/2020-12/schema#",
              "title": "hex",
              "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
              "type": "string",
              "pattern": "^([a-fA-F0-9]{2})+$"
            },
            "^([a-z][a-z0-9_]{2,249})|id$": {
              "anyOf": [
                {
                  "type": "array",
                  "minItems": 1
                },
                {
                  "type": "string"
                },
                {
                  "type": "integer"
                },
                {
                  "type": "boolean"
                },
                {
                  "type": "number"
                },
                {
                  "type": "object"
                }
              ]
            }
          },
          "additionalProperties": false
        }
      ],
      "not": {
        "anyOf": [
          {
            "required": [
              "severity"
            ]
          },
          {
            "required": [
              "action"
            ]
          },
          {
            "required": [
              "username"
            ]
          },
          {
            "required": [
              "phone_numbers"
            ]
          }
        ]
      },
      "required": [
        "type",
        "id"
      ]
    },
    {
      "properties": {
        "type": {
          "type": "string",
          "description": "The value of this property MUST be `network-traffic`.",
          "enum": [
            "network-traffic"
          ]
        },
        "id": {
          "title": "id",
          "pattern": "^network-traffic--"
        },
        "extensions": {
          "description": "The Network Traffic Object defines the following extensions. In addition to these, producers MAY create their own. Extensions: http-ext, tcp-ext, icmp-ext, socket-ext",
          "allOf": [
            {
              "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/dictionary.json",
              "$schema": "http://json-schema.org/draft/2020-12/schema#",
              "title": "dictionary",
              "description": "A dictionary captures a set of key/value pairs",
              "type": "object",
              "minProperties": 1,
              "patternProperties": {
                "^[a-zA-Z0-9_-]{0,250}$": {
                  "anyOf": [
                    {
                      "type": "array",
                      "minItems": 1
                    },
                    {
                      "type": "string"
                    },
                    {
                      "type": "integer"
                    },
                    {
                      "type": "boolean"
                    },
                    {
                      "type": "number"
                    },
                    {
                      "type": "object"
                    }
                  ]
                }
              },
              "additionalProperties": false
            }
          ],
          "patternProperties": {
            "^http-request-ext$": {
              "type": "object",
              "description": "The HTTP request extension specifies a default extension for capturing network traffic properties specific to HTTP requests.",
              "properties": {
                "request_method": {
                  "type": "string",
                  "description": "Specifies the HTTP method portion of the HTTP request line, as a lowercase string."
                },
                "request_value": {
                  "type": "string",
                  "description": "Specifies the value (typically a resource path) portion of the HTTP request line."
                },
                "request_version": {
                  "type": "string",
                  "description": "Specifies the HTTP version portion of the HTTP request line, as a lowercase string."
                },
                "request_header": {
                  "allOf": [
                    {
                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/dictionary.json",
                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                      "title": "dictionary",
                      "description": "A dictionary captures a set of key/value pairs",
                      "type": "object",
                      "minProperties": 1,
                      "patternProperties": {
                        "^[a-zA-Z0-9_-]{0,250}$": {
                          "anyOf": [
                            {
                              "type": "array",
                              "minItems": 1
                            },
                            {
                              "type": "string"
                            },
                            {
                              "type": "integer"
                            },
                            {
                              "type": "boolean"
                            },
                            {
                              "type": "number"
                            },
                            {
                              "type": "object"
                            }
                          ]
                        }
                      },
                      "additionalProperties": false
                    }
                  ],
                  "description": "Specifies all of the HTTP header fields that may be found in the HTTP client request, as a dictionary.",
                  "patternProperties": {
                    "^.+$": {
                      "type": "array",
                      "items": {
                        "type": "string"
                      }
                    }
                  },
                  "additionalProperties": false
                },
                "message_body_length": {
                  "type": "integer",
                  "description": "Specifies the length of the HTTP message body, if included, in bytes."
                },
                "message_body_data_ref": {
                  "description": "Specifies the data contained in the HTTP message body, if included.",
                  "type": "string"
                }
              },
              "required": [
                "request_method",
                "request_value"
              ]
            },
            "^icmp-ext$": {
              "type": "object",
              "description": "The ICMP extension specifies a default extension for capturing network traffic properties specific to ICMP.",
              "properties": {
                "icmp_type_hex": {
                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                  "title": "hex",
                  "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                  "type": "string",
                  "pattern": "^([a-fA-F0-9]{2})+$"
                },
                "icmp_code_hex": {
                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                  "title": "hex",
                  "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                  "type": "string",
                  "pattern": "^([a-fA-F0-9]{2})+$"
                }
              },
              "required": [
                "icmp_type_hex",
                "icmp_code_hex"
              ]
            },
            "^socket-ext$": {
              "type": "object",
              "description": "The Network Socket extension specifies a default extension for capturing network traffic properties associated with network sockets.",
              "properties": {
                "address_family": {
                  "type": "string",
                  "description": "Specifies the address family (AF_*) that the socket is configured for.",
                  "enum": [
                    "AF_UNSPEC",
                    "AF_INET",
                    "AF_IPX",
                    "AF_APPLETALK",
                    "AF_NETBIOS",
                    "AF_INET6",
                    "AF_IRDA",
                    "AF_BTH"
                  ]
                },
                "is_blocking": {
                  "type": "boolean",
                  "description": "Specifies whether the socket is in blocking mode."
                },
                "is_listening": {
                  "type": "boolean",
                  "description": "Specifies whether the socket is in listening mode."
                },
                "options": {
                  "allOf": [
                    {
                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/dictionary.json",
                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                      "title": "dictionary",
                      "description": "A dictionary captures a set of key/value pairs",
                      "type": "object",
                      "minProperties": 1,
                      "patternProperties": {
                        "^[a-zA-Z0-9_-]{0,250}$": {
                          "anyOf": [
                            {
                              "type": "array",
                              "minItems": 1
                            },
                            {
                              "type": "string"
                            },
                            {
                              "type": "integer"
                            },
                            {
                              "type": "boolean"
                            },
                            {
                              "type": "number"
                            },
                            {
                              "type": "object"
                            }
                          ]
                        }
                      },
                      "additionalProperties": false
                    }
                  ],
                  "description": "Specifies any options (SO_*) that may be used by the socket, as a dictionary.",
                  "patternProperties": {
                    "^(SO|ICMP|ICMP6|IP|IPV6|MCAST|TCP|IRLMP)(_[A-Z]+)+$": {
                      "type": "integer"
                    }
                  },
                  "additionalProperties": false
                },
                "socket_type": {
                  "type": "string",
                  "description": "Specifies the type of the socket.",
                  "enum": [
                    "SOCK_STREAM",
                    "SOCK_DGRAM",
                    "SOCK_RAW",
                    "SOCK_RDM",
                    "SOCK_SEQPACKET"
                  ]
                },
                "socket_descriptor": {
                  "type": "integer",
                  "minimum": 0,
                  "description": "Specifies the socket file descriptor value associated with the socket, as a non-negative integer."
                },
                "socket_handle": {
                  "type": "integer",
                  "description": "Specifies the handle or inode value associated with the socket."
                }
              },
              "required": [
                "address_family"
              ]
            },
            "^tcp-ext$": {
              "type": "object",
              "description": "The TCP extension specifies a default extension for capturing network traffic properties specific to TCP.",
              "allOf": [
                {
                  "properties": {
                    "src_flags_hex": {
                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                      "title": "hex",
                      "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                      "type": "string",
                      "pattern": "^([a-fA-F0-9]{2})+$"
                    },
                    "dst_flags_hex": {
                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                      "title": "hex",
                      "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                      "type": "string",
                      "pattern": "^([a-fA-F0-9]{2})+$"
                    }
                  }
                },
                {
                  "anyOf": [
                    {
                      "required": [
                        "src_flags_hex"
                      ]
                    },
                    {
                      "required": [
                        "dst_flags_hex"
                      ]
                    }
                  ]
                }
              ]
            }
          },
          "additionalProperties": {
            "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/dictionary.json",
            "$schema": "http://json-schema.org/draft/2020-12/schema#",
            "title": "dictionary",
            "description": "A dictionary captures a set of key/value pairs",
            "type": "object",
            "minProperties": 1,
            "patternProperties": {
              "^[a-zA-Z0-9_-]{0,250}$": {
                "anyOf": [
                  {
                    "type": "array",
                    "minItems": 1
                  },
                  {
                    "type": "string"
                  },
                  {
                    "type": "integer"
                  },
                  {
                    "type": "boolean"
                  },
                  {
                    "type": "number"
                  },
                  {
                    "type": "object"
                  }
                ]
              }
            },
            "additionalProperties": false
          }
        },
        "start": {
          "description": "Specifies the date/time the network traffic was initiated, if known.",
          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/timestamp.json",
          "$schema": "http://json-schema.org/draft/2020-12/schema#",
          "title": "timestamp",
          "type": "string",
          "pattern": "^[0-9]{4}-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])T([01][0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9]|60)(\\.[0-9]+)?Z$"
        },
        "end": {
          "description": "Specifies the date/time the network traffic ended, if known.",
          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/timestamp.json",
          "$schema": "http://json-schema.org/draft/2020-12/schema#",
          "title": "timestamp",
          "type": "string",
          "pattern": "^[0-9]{4}-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])T([01][0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9]|60)(\\.[0-9]+)?Z$"
        },
        "src_ref": {
          "description": "Specifies the source of the network traffic, as a reference to an Observable Object.",
          "type": "string"
        },
        "dst_ref": {
          "description": "Specifies the destination of the network traffic, as a reference to an Observable Object.",
          "type": "string"
        },
        "src_port": {
          "type": "integer",
          "description": "Specifies the source port used in the network traffic, as an integer. The port value MUST be in the range of 0 - 65535.",
          "minimum": 0,
          "maximum": 65535
        },
        "dst_port": {
          "type": "integer",
          "description": "Specifies the destination port used in the network traffic, as an integer. The port value MUST be in the range of 0 - 65535.",
          "minimum": 0,
          "maximum": 65535
        },
        "protocols": {
          "type": "array",
          "description": "Specifies the protocols observed in the network traffic, along with their corresponding state.",
          "items": {
            "type": "string"
          },
          "minItems": 1
        },
        "src_byte_count": {
          "type": "integer",
          "description": "Specifies the number of bytes sent from the source to the destination."
        },
        "dst_byte_count": {
          "type": "integer",
          "description": "Specifies the number of bytes sent from the destination to the source."
        },
        "src_packets": {
          "type": "integer",
          "description": "Specifies the number of packets sent from the source to the destination."
        },
        "dst_packets": {
          "type": "integer",
          "description": "Specifies the number of packets sent destination to the source."
        },
        "ipfix": {
          "description": "Specifies any IP Flow Information Export (IPFIX) data for the traffic.",
          "allOf": [
            {
              "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/dictionary.json",
              "$schema": "http://json-schema.org/draft/2020-12/schema#",
              "title": "dictionary",
              "description": "A dictionary captures a set of key/value pairs",
              "type": "object",
              "minProperties": 1,
              "patternProperties": {
                "^[a-zA-Z0-9_-]{0,250}$": {
                  "anyOf": [
                    {
                      "type": "array",
                      "minItems": 1
                    },
                    {
                      "type": "string"
                    },
                    {
                      "type": "integer"
                    },
                    {
                      "type": "boolean"
                    },
                    {
                      "type": "number"
                    },
                    {
                      "type": "object"
                    }
                  ]
                }
              },
              "additionalProperties": false
            }
          ],
          "patternProperties": {
            "^[a-zA-Z0-9_-]{0,250}$": {
              "anyOf": [
                {
                  "type": "string"
                },
                {
                  "type": "integer"
                }
              ]
            }
          }
        },
        "src_payload_ref": {
          "description": "Specifies the bytes sent from the source to the destination.",
          "type": "string"
        },
        "dst_payload_ref": {
          "description": "Specifies the bytes sent from the source to the destination.",
          "type": "string"
        },
        "encapsulates_refs": {
          "type": "array",
          "description": "Links to other network-traffic objects encapsulated by a network-traffic.",
          "items": {
            "type": "string"
          },
          "minItems": 1
        },
        "encapsulated_by_ref": {
          "description": "Links to another network-traffic object which encapsulates this object.",
          "type": "string"
        }
      }
    }
  ],
  "required": [
    "protocols"
  ],
  "anyOf": [
    {
      "required": [
        "src_ref"
      ]
    },
    {
      "required": [
        "dst_ref"
      ]
    }
  ],
  "oneOf": [
    {
      "properties": {
        "is_active": {
          "type": "boolean",
          "enum": [
            false
          ],
          "description": "Indicates whether the network traffic is still ongoing."
        }
      },
      "required": [
        "is_active"
      ]
    },
    {
      "properties": {
        "is_active": {
          "type": "boolean",
          "enum": [
            true
          ],
          "description": "Indicates whether the network traffic is still ongoing."
        }
      },
      "required": [
        "is_active"
      ],
      "not": {
        "required": [
          "end"
        ]
      }
    },
    {
      "not": {
        "required": [
          "is_active"
        ]
      }
    }
  ],
  "definitions": {
    "network-traffic-extensions-dictionary": {
      "allOf": [
        {
          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/dictionary.json",
          "$schema": "http://json-schema.org/draft/2020-12/schema#",
          "title": "dictionary",
          "description": "A dictionary captures a set of key/value pairs",
          "type": "object",
          "minProperties": 1,
          "patternProperties": {
            "^[a-zA-Z0-9_-]{0,250}$": {
              "anyOf": [
                {
                  "type": "array",
                  "minItems": 1
                },
                {
                  "type": "string"
                },
                {
                  "type": "integer"
                },
                {
                  "type": "boolean"
                },
                {
                  "type": "number"
                },
                {
                  "type": "object"
                }
              ]
            }
          },
          "additionalProperties": false
        }
      ],
      "patternProperties": {
        "^http-request-ext$": {
          "type": "object",
          "description": "The HTTP request extension specifies a default extension for capturing network traffic properties specific to HTTP requests.",
          "properties": {
            "request_method": {
              "type": "string",
              "description": "Specifies the HTTP method portion of the HTTP request line, as a lowercase string."
            },
            "request_value": {
              "type": "string",
              "description": "Specifies the value (typically a resource path) portion of the HTTP request line."
            },
            "request_version": {
              "type": "string",
              "description": "Specifies the HTTP version portion of the HTTP request line, as a lowercase string."
            },
            "request_header": {
              "allOf": [
                {
                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/dictionary.json",
                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                  "title": "dictionary",
                  "description": "A dictionary captures a set of key/value pairs",
                  "type": "object",
                  "minProperties": 1,
                  "patternProperties": {
                    "^[a-zA-Z0-9_-]{0,250}$": {
                      "anyOf": [
                        {
                          "type": "array",
                          "minItems": 1
                        },
                        {
                          "type": "string"
                        },
                        {
                          "type": "integer"
                        },
                        {
                          "type": "boolean"
                        },
                        {
                          "type": "number"
                        },
                        {
                          "type": "object"
                        }
                      ]
                    }
                  },
                  "additionalProperties": false
                }
              ],
              "description": "Specifies all of the HTTP header fields that may be found in the HTTP client request, as a dictionary.",
              "patternProperties": {
                "^.+$": {
                  "type": "array",
                  "items": {
                    "type": "string"
                  }
                }
              },
              "additionalProperties": false
            },
            "message_body_length": {
              "type": "integer",
              "description": "Specifies the length of the HTTP message body, if included, in bytes."
            },
            "message_body_data_ref": {
              "description": "Specifies the data contained in the HTTP message body, if included.",
              "type": "string"
            }
          },
          "required": [
            "request_method",
            "request_value"
          ]
        },
        "^icmp-ext$": {
          "type": "object",
          "description": "The ICMP extension specifies a default extension for capturing network traffic properties specific to ICMP.",
          "properties": {
            "icmp_type_hex": {
              "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
              "$schema": "http://json-schema.org/draft/2020-12/schema#",
              "title": "hex",
              "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
              "type": "string",
              "pattern": "^([a-fA-F0-9]{2})+$"
            },
            "icmp_code_hex": {
              "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
              "$schema": "http://json-schema.org/draft/2020-12/schema#",
              "title": "hex",
              "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
              "type": "string",
              "pattern": "^([a-fA-F0-9]{2})+$"
            }
          },
          "required": [
            "icmp_type_hex",
            "icmp_code_hex"
          ]
        },
        "^socket-ext$": {
          "type": "object",
          "description": "The Network Socket extension specifies a default extension for capturing network traffic properties associated with network sockets.",
          "properties": {
            "address_family": {
              "type": "string",
              "description": "Specifies the address family (AF_*) that the socket is configured for.",
              "enum": [
                "AF_UNSPEC",
                "AF_INET",
                "AF_IPX",
                "AF_APPLETALK",
                "AF_NETBIOS",
                "AF_INET6",
                "AF_IRDA",
                "AF_BTH"
              ]
            },
            "is_blocking": {
              "type": "boolean",
              "description": "Specifies whether the socket is in blocking mode."
            },
            "is_listening": {
              "type": "boolean",
              "description": "Specifies whether the socket is in listening mode."
            },
            "options": {
              "allOf": [
                {
                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/dictionary.json",
                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                  "title": "dictionary",
                  "description": "A dictionary captures a set of key/value pairs",
                  "type": "object",
                  "minProperties": 1,
                  "patternProperties": {
                    "^[a-zA-Z0-9_-]{0,250}$": {
                      "anyOf": [
                        {
                          "type": "array",
                          "minItems": 1
                        },
                        {
                          "type": "string"
                        },
                        {
                          "type": "integer"
                        },
                        {
                          "type": "boolean"
                        },
                        {
                          "type": "number"
                        },
                        {
                          "type": "object"
                        }
                      ]
                    }
                  },
                  "additionalProperties": false
                }
              ],
              "description": "Specifies any options (SO_*) that may be used by the socket, as a dictionary.",
              "patternProperties": {
                "^(SO|ICMP|ICMP6|IP|IPV6|MCAST|TCP|IRLMP)(_[A-Z]+)+$": {
                  "type": "integer"
                }
              },
              "additionalProperties": false
            },
            "socket_type": {
              "type": "string",
              "description": "Specifies the type of the socket.",
              "enum": [
                "SOCK_STREAM",
                "SOCK_DGRAM",
                "SOCK_RAW",
                "SOCK_RDM",
                "SOCK_SEQPACKET"
              ]
            },
            "socket_descriptor": {
              "type": "integer",
              "minimum": 0,
              "description": "Specifies the socket file descriptor value associated with the socket, as a non-negative integer."
            },
            "socket_handle": {
              "type": "integer",
              "description": "Specifies the handle or inode value associated with the socket."
            }
          },
          "required": [
            "address_family"
          ]
        },
        "^tcp-ext$": {
          "type": "object",
          "description": "The TCP extension specifies a default extension for capturing network traffic properties specific to TCP.",
          "allOf": [
            {
              "properties": {
                "src_flags_hex": {
                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                  "title": "hex",
                  "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                  "type": "string",
                  "pattern": "^([a-fA-F0-9]{2})+$"
                },
                "dst_flags_hex": {
                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                  "title": "hex",
                  "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                  "type": "string",
                  "pattern": "^([a-fA-F0-9]{2})+$"
                }
              }
            },
            {
              "anyOf": [
                {
                  "required": [
                    "src_flags_hex"
                  ]
                },
                {
                  "required": [
                    "dst_flags_hex"
                  ]
                }
              ]
            }
          ]
        }
      },
      "additionalProperties": {
        "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/dictionary.json",
        "$schema": "http://json-schema.org/draft/2020-12/schema#",
        "title": "dictionary",
        "description": "A dictionary captures a set of key/value pairs",
        "type": "object",
        "minProperties": 1,
        "patternProperties": {
          "^[a-zA-Z0-9_-]{0,250}$": {
            "anyOf": [
              {
                "type": "array",
                "minItems": 1
              },
              {
                "type": "string"
              },
              {
                "type": "integer"
              },
              {
                "type": "boolean"
              },
              {
                "type": "number"
              },
              {
                "type": "object"
              }
            ]
          }
        },
        "additionalProperties": false
      }
    }
  }
}