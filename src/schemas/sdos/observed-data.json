{
  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/sdos/observed-data.json",
  "$schema": "http://json-schema.org/draft/2020-12/schema#",
  "title": "observed-data",
  "description": "Observed data conveys information that was observed on systems and networks, such as log data or network traffic, using the Cyber Observable specification.",
  "type": "object",
  "allOf": [
    {
      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/core.json",
      "$schema": "https://json-schema.org/draft/2020-12/schema",
      "title": "core",
      "description": "Common properties and behavior across all STIX Domain Objects and STIX Relationship Objects.",
      "type": "object",
      "properties": {
        "type": {
          "title": "type",
          "type": "string",
          "pattern": "^([a-z][a-z0-9]*)+(-[a-z0-9]+)*\\-?$",
          "minLength": 3,
          "maxLength": 250,
          "description": "The type property identifies the type of STIX Object (SDO, Relationship Object, etc). The value of the type field MUST be one of the types defined by a STIX Object (e.g., indicator).",
          "not": {
            "enum": [
              "action"
            ]
          }
        },
        "spec_version": {
          "type": "string",
          "enum": [
            "2.0",
            "2.1"
          ],
          "description": "The version of the STIX specification used to represent this object."
        },
        "id": {
          "description": "The id property universally and uniquely identifies this object.",
          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/identifier.json",
          "$schema": "http://json-schema.org/draft/2020-12/schema#",
          "title": "identifier",
          "type": "string",
          "pattern": "^[a-z][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
        },
        "created_by_ref": {
          "description": "The ID of the Source object that describes who created this object.",
          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/identifier.json",
          "$schema": "http://json-schema.org/draft/2020-12/schema#",
          "title": "identifier",
          "type": "string",
          "pattern": "^[a-z][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
        },
        "labels": {
          "type": "array",
          "description": "The labels property specifies a set of terms used to describe this object.",
          "items": {
            "type": "string"
          },
          "minItems": 1
        },
        "created": {
          "description": "The created property represents the time at which the first version of this object was created. The timstamp value MUST be precise to the nearest millisecond.",
          "allOf": [
            {
              "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/timestamp.json",
              "$schema": "http://json-schema.org/draft/2020-12/schema#",
              "title": "timestamp",
              "description": "Represents timestamps across the CTI specifications. The format is an RFC3339 timestamp, with a required timezone specification of 'Z'.",
              "type": "string",
              "pattern": "^[0-9]{4}-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])T([01][0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9]|60)(\\.[0-9]+)?Z$"
            },
            {
              "title": "timestamp_millis",
              "pattern": "T\\d{2}:\\d{2}:\\d{2}\\.\\d{3,}Z$"
            }
          ]
        },
        "modified": {
          "description": "The modified property represents the time that this particular version of the object was modified. The timstamp value MUST be precise to the nearest millisecond.",
          "allOf": [
            {
              "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/timestamp.json",
              "$schema": "http://json-schema.org/draft/2020-12/schema#",
              "title": "timestamp",
              "description": "Represents timestamps across the CTI specifications. The format is an RFC3339 timestamp, with a required timezone specification of 'Z'.",
              "type": "string",
              "pattern": "^[0-9]{4}-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])T([01][0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9]|60)(\\.[0-9]+)?Z$"
            },
            {
              "title": "timestamp_millis",
              "pattern": "T\\d{2}:\\d{2}:\\d{2}\\.\\d{3,}Z$"
            }
          ]
        },
        "revoked": {
          "type": "boolean",
          "description": "The revoked property indicates whether the object has been revoked."
        },
        "confidence": {
          "type": "integer",
          "minimum": 0,
          "maximum": 100,
          "description": "Identifies the confidence that the creator has in the correctness of their data."
        },
        "lang": {
          "type": "string",
          "description": "Identifies the language of the text content in this object."
        },
        "external_references": {
          "type": "array",
          "description": "A list of external references which refers to non-STIX information.",
          "items": {
            "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/external-reference.json",
            "$schema": "http://json-schema.org/draft/2020-12/schema#",
            "title": "external-reference",
            "description": "External references are used to describe pointers to information represented outside of STIX.",
            "type": "object",
            "properties": {
              "description": {
                "type": "string",
                "description": "A human readable description"
              },
              "url": {
                "description": "A URL reference to an external resource.",
                "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/url-regex.json",
                "$schema": "http://json-schema.org/draft/2020-12/schema#",
                "title": "url-regex",
                "type": "string",
                "format": "uri"
              },
              "hashes": {
                "description": "Specifies a dictionary of hashes for the file.",
                "allOf": [
                  {
                    "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hashes-type.json",
                    "$schema": "http://json-schema.org/draft/2020-12/schema#",
                    "title": "hashes",
                    "description": "The Hashes type represents one or more cryptographic hashes, as a special set of key/value pairs",
                    "type": "object",
                    "allOf": [
                      {
                        "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/dictionary.json",
                        "$schema": "http://json-schema.org/draft/2020-12/schema#",
                        "title": "dictionary",
                        "description": "A dictionary captures a set of key/value pairs",
                        "type": "object",
                        "minProperties": 1,
                        "patternProperties": {
                          "^[a-zA-Z0-9_-]{0,250}$": {
                            "anyOf": [
                              {
                                "type": "array",
                                "minItems": 1
                              },
                              {
                                "type": "string"
                              },
                              {
                                "type": "integer"
                              },
                              {
                                "type": "boolean"
                              },
                              {
                                "type": "number"
                              },
                              {
                                "type": "object"
                              }
                            ]
                          }
                        },
                        "additionalProperties": false
                      }
                    ],
                    "patternProperties": {
                      "^[a-zA-Z0-9_-]{3,250}$": {
                        "type": "string",
                        "description": "Custom hash key"
                      },
                      "^MD5$": {
                        "type": "string",
                        "description": "Specifies the MD5 message digest algorithm.",
                        "pattern": "^[a-fA-F0-9]{32}$"
                      },
                      "^SHA-1$": {
                        "type": "string",
                        "description": "Specifies the SHA-1 (secure-hash algorithm 1) cryptographic hash function.",
                        "pattern": "^[a-fA-F0-9]{40}$"
                      },
                      "^SHA-256$": {
                        "type": "string",
                        "description": "Specifies the SHA-256 cryptographic hash function (part of the SHA2 family).",
                        "pattern": "^[a-fA-F0-9]{64}$"
                      },
                      "^SHA-512$": {
                        "type": "string",
                        "description": "Specifies the SHA-512 cryptographic hash function (part of the SHA2 family).",
                        "pattern": "^[a-fA-F0-9]{128}$"
                      },
                      "^SHA3-256$": {
                        "type": "string",
                        "description": "Specifies the SHA3-256 cryptographic hash function.",
                        "pattern": "^[a-fA-F0-9]{64}$"
                      },
                      "^SHA3-512$": {
                        "type": "string",
                        "description": "Specifies the SHA3-512 cryptographic hash function.",
                        "pattern": "^[a-fA-F0-9]{128}$"
                      },
                      "^SSDEEP$": {
                        "type": "string",
                        "description": "Specifies the ssdeep fuzzy hashing algorithm.",
                        "pattern": "^[a-zA-Z0-9/+:.]{1,128}$"
                      },
                      "^TLSH$": {
                        "type": "string",
                        "description": "Specifies the TLSH locality-sensitive hashing algorithm.",
                        "pattern": "^[a-zA-Z0-9]{70}$"
                      }
                    },
                    "additionalProperties": false
                  },
                  {
                    "propertyNames": {
                      "pattern": "^MD5|SHA-1|SHA-256|SHA-512|SHA3-256|SHA3-512|SSDEEP|TLSH$"
                    }
                  }
                ]
              }
            },
            "oneOf": [
              {
                "properties": {
                  "source_name": {
                    "type": "string",
                    "description": "The source within which the external-reference is defined (system, registry, organization, etc.)",
                    "pattern": "^cve$"
                  },
                  "external_id": {
                    "type": "string",
                    "description": "An identifier for the external reference content.",
                    "pattern": "^CVE-\\d{4}-(0\\d{3}|[1-9]\\d{3,})$"
                  }
                },
                "required": [
                  "source_name",
                  "external_id"
                ]
              },
              {
                "properties": {
                  "source_name": {
                    "type": "string",
                    "description": "The source within which the external-reference is defined (system, registry, organization, etc.)",
                    "pattern": "^capec$"
                  },
                  "external_id": {
                    "type": "string",
                    "description": "An identifier for the external reference content.",
                    "pattern": "^CAPEC-\\d+$"
                  }
                },
                "required": [
                  "source_name",
                  "external_id"
                ]
              },
              {
                "properties": {
                  "source_name": {
                    "type": "string",
                    "description": "The source within which the external-reference is defined (system, registry, organization, etc.)",
                    "not": {
                      "pattern": "^((cve)|(capec))$"
                    }
                  },
                  "external_id": {
                    "type": "string",
                    "description": "An identifier for the external reference content.",
                    "not": {
                      "pattern": "^((CVE-\\d{4}-(0\\d{3}|[1-9]\\d{3,}))|(CAPEC-\\d+))$"
                    }
                  }
                },
                "required": [
                  "source_name"
                ],
                "anyOf": [
                  {
                    "required": [
                      "external_id"
                    ]
                  },
                  {
                    "required": [
                      "description"
                    ]
                  },
                  {
                    "required": [
                      "url"
                    ]
                  }
                ]
              }
            ]
          },
          "minItems": 1
        },
        "object_marking_refs": {
          "type": "array",
          "description": "The list of marking-definition objects to be applied to this object.",
          "items": {
            "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/identifier.json",
            "$schema": "http://json-schema.org/draft/2020-12/schema#",
            "title": "identifier",
            "description": "Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.",
            "type": "string",
            "pattern": "^[a-z][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
          },
          "minItems": 1
        },
        "granular_markings": {
          "type": "array",
          "description": "The set of granular markings that apply to this object.",
          "items": {
            "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/granular-marking.json",
            "$schema": "http://json-schema.org/draft/2020-12/schema#",
            "title": "granular-marking",
            "description": "The granular-marking type defines how the list of marking-definition objects referenced by the marking_refs property to apply to a set of content identified by the list of selectors in the selectors property.",
            "type": "object",
            "properties": {
              "selectors": {
                "type": "array",
                "description": "A list of selectors for content contained within the STIX object in which this property appears.",
                "items": {
                  "type": "string",
                  "pattern": "^([a-z0-9_-]{3,249}(\\.(\\[\\d+\\]|[a-z0-9_-]{1,250}))*|id)$"
                },
                "minItems": 1
              },
              "lang": {
                "type": "string",
                "description": "Identifies the language of the text identified by this marking."
              },
              "marking_ref": {
                "allOf": [
                  {
                    "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/identifier.json",
                    "$schema": "http://json-schema.org/draft/2020-12/schema#",
                    "title": "identifier",
                    "description": "Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.",
                    "type": "string",
                    "pattern": "^[a-z][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
                  },
                  {
                    "pattern": "^marking-definition--",
                    "description": "The marking_ref property specifies the ID of the marking-definition object that describes the marking."
                  }
                ]
              }
            },
            "required": [
              "selectors",
              "marking_ref"
            ]
          },
          "minItems": 1
        },
        "extensions": {
          "description": "Specifies any extensions of the object, as a dictionary.",
          "type": "object",
          "minProperties": 1,
          "patternProperties": {
            "^([a-z][a-z0-9]*)+(-[a-z0-9]+)*\\-ext$": {
              "type": "object",
              "minProperties": 1,
              "allOf": [
                {
                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/properties.json",
                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                  "title": "properties",
                  "description": "Rules for custom properties",
                  "patternProperties": {
                    "^[a-z][a-z0-9_]{0,245}_bin$": {
                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/binary.json",
                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                      "title": "binary",
                      "description": "The ​binary data type represents a sequence of bytes. In order to allow pattern matching on custom objects, for all properties that use the binary type, the property name MUST end with '_bin'. The JSON MTI serialization represents this as a base64-­encoded string as specified in RFC4648​. Other serializations SHOULD use a native binary type, if available.",
                      "type": "string",
                      "pattern": "^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$"
                    },
                    "^[a-z][a-z0-9_]{0,245}_hex$": {
                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                      "title": "hex",
                      "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                      "type": "string",
                      "pattern": "^([a-fA-F0-9]{2})+$"
                    },
                    "^([a-z][a-z0-9_]{2,249})|id$": {
                      "anyOf": [
                        {
                          "type": "array",
                          "minItems": 1
                        },
                        {
                          "type": "string"
                        },
                        {
                          "type": "integer"
                        },
                        {
                          "type": "boolean"
                        },
                        {
                          "type": "number"
                        },
                        {
                          "type": "object"
                        }
                      ]
                    }
                  },
                  "additionalProperties": false
                }
              ]
            },
            "^extension-definition--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$": {
              "allOf": [
                {
                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/extension.json",
                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                  "type": "object",
                  "minProperties": 1,
                  "properties": {
                    "extension_type": {
                      "description": "The type of extension.",
                      "type": "string",
                      "enum": [
                        "new-sdo",
                        "new-sco",
                        "new-sro",
                        "property-extension",
                        "toplevel-property-extension"
                      ]
                    }
                  },
                  "allOf": [
                    {
                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/properties.json",
                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                      "title": "properties",
                      "description": "Rules for custom properties",
                      "patternProperties": {
                        "^[a-z][a-z0-9_]{0,245}_bin$": {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/binary.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "binary",
                          "description": "The ​binary data type represents a sequence of bytes. In order to allow pattern matching on custom objects, for all properties that use the binary type, the property name MUST end with '_bin'. The JSON MTI serialization represents this as a base64-­encoded string as specified in RFC4648​. Other serializations SHOULD use a native binary type, if available.",
                          "type": "string",
                          "pattern": "^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$"
                        },
                        "^[a-z][a-z0-9_]{0,245}_hex$": {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "hex",
                          "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                          "type": "string",
                          "pattern": "^([a-fA-F0-9]{2})+$"
                        },
                        "^([a-z][a-z0-9_]{2,249})|id$": {
                          "anyOf": [
                            {
                              "type": "array",
                              "minItems": 1
                            },
                            {
                              "type": "string"
                            },
                            {
                              "type": "integer"
                            },
                            {
                              "type": "boolean"
                            },
                            {
                              "type": "number"
                            },
                            {
                              "type": "object"
                            }
                          ]
                        }
                      },
                      "additionalProperties": false
                    }
                  ],
                  "required": [
                    "extension_type"
                  ],
                  "definitions": {
                    "extension-type-enum": {
                      "type": "string",
                      "enum": [
                        "new-sdo",
                        "new-sco",
                        "new-sro",
                        "property-extension",
                        "toplevel-property-extension"
                      ]
                    }
                  }
                }
              ]
            }
          },
          "additionalProperties": false
        }
      },
      "allOf": [
        {
          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/properties.json",
          "$schema": "http://json-schema.org/draft/2020-12/schema#",
          "title": "properties",
          "description": "Rules for custom properties",
          "patternProperties": {
            "^[a-z][a-z0-9_]{0,245}_bin$": {
              "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/binary.json",
              "$schema": "http://json-schema.org/draft/2020-12/schema#",
              "title": "binary",
              "description": "The ​binary data type represents a sequence of bytes. In order to allow pattern matching on custom objects, for all properties that use the binary type, the property name MUST end with '_bin'. The JSON MTI serialization represents this as a base64-­encoded string as specified in RFC4648​. Other serializations SHOULD use a native binary type, if available.",
              "type": "string",
              "pattern": "^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$"
            },
            "^[a-z][a-z0-9_]{0,245}_hex$": {
              "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
              "$schema": "http://json-schema.org/draft/2020-12/schema#",
              "title": "hex",
              "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
              "type": "string",
              "pattern": "^([a-fA-F0-9]{2})+$"
            },
            "^([a-z][a-z0-9_]{2,249})|id$": {
              "anyOf": [
                {
                  "type": "array",
                  "minItems": 1
                },
                {
                  "type": "string"
                },
                {
                  "type": "integer"
                },
                {
                  "type": "boolean"
                },
                {
                  "type": "number"
                },
                {
                  "type": "object"
                }
              ]
            }
          },
          "additionalProperties": false
        }
      ],
      "not": {
        "anyOf": [
          {
            "required": [
              "severity"
            ]
          },
          {
            "required": [
              "action"
            ]
          },
          {
            "required": [
              "username"
            ]
          },
          {
            "required": [
              "phone_numbers"
            ]
          }
        ]
      },
      "required": [
        "type",
        "spec_version",
        "id",
        "created",
        "modified"
      ]
    },
    {
      "properties": {
        "type": {
          "type": "string",
          "description": "The type of this object, which MUST be the literal `observed-data`.",
          "enum": [
            "observed-data"
          ]
        },
        "id": {
          "title": "id",
          "pattern": "^observed-data--"
        },
        "first_observed": {
          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/timestamp.json",
          "$schema": "http://json-schema.org/draft/2020-12/schema#",
          "title": "timestamp",
          "description": "Represents timestamps across the CTI specifications. The format is an RFC3339 timestamp, with a required timezone specification of 'Z'.",
          "type": "string",
          "pattern": "^[0-9]{4}-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])T([01][0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9]|60)(\\.[0-9]+)?Z$"
        },
        "last_observed": {
          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/timestamp.json",
          "$schema": "http://json-schema.org/draft/2020-12/schema#",
          "title": "timestamp",
          "description": "Represents timestamps across the CTI specifications. The format is an RFC3339 timestamp, with a required timezone specification of 'Z'.",
          "type": "string",
          "pattern": "^[0-9]{4}-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])T([01][0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9]|60)(\\.[0-9]+)?Z$"
        },
        "number_observed": {
          "type": "integer",
          "description": "The number of times the data represented in the objects property was observed. This MUST be an integer between 1 and 999,999,999 inclusive.",
          "minimum": 1,
          "maximum": 999999999
        },
        "objects": {
          "type": "object",
          "description": "A dictionary of Cyber Observable Objects that describes the single 'fact' that was observed.",
          "minProperties": 1,
          "patternProperties": {
            "^.*$": {
              "type": "object",
              "oneOf": [
                {
                  "allOf": [
                    {
                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/cyber-observable-core.json",
                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                      "title": "cyber-observable-core",
                      "description": "Common properties and behavior across all Cyber Observable Objects.",
                      "type": "object",
                      "properties": {
                        "type": {
                          "type": "string",
                          "pattern": "^([a-z][a-z0-9]*)+(-[a-z0-9]+)*\\-?$",
                          "minLength": 3,
                          "maxLength": 250,
                          "description": "Indicates that this object is an Observable Object. The value of this property MUST be a valid Observable Object type name, but to allow for custom objects this has been removed from the schema.",
                          "not": {
                            "enum": [
                              "action"
                            ]
                          }
                        },
                        "spec_version": {
                          "type": "string",
                          "enum": [
                            "2.0",
                            "2.1"
                          ],
                          "description": "The version of the STIX specification used to represent the content in this cyber-observable."
                        },
                        "object_marking_refs": {
                          "type": "array",
                          "description": "The list of marking-definition objects to be applied to this object.",
                          "items": {
                            "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/identifier.json",
                            "$schema": "http://json-schema.org/draft/2020-12/schema#",
                            "title": "identifier",
                            "description": "Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.",
                            "type": "string",
                            "pattern": "^[a-z][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
                          },
                          "minItems": 1
                        },
                        "granular_markings": {
                          "type": "array",
                          "description": "The set of granular markings that apply to this object.",
                          "items": {
                            "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/granular-marking.json",
                            "$schema": "http://json-schema.org/draft/2020-12/schema#",
                            "title": "granular-marking",
                            "description": "The granular-marking type defines how the list of marking-definition objects referenced by the marking_refs property to apply to a set of content identified by the list of selectors in the selectors property.",
                            "type": "object",
                            "properties": {
                              "selectors": {
                                "type": "array",
                                "description": "A list of selectors for content contained within the STIX object in which this property appears.",
                                "items": {
                                  "type": "string",
                                  "pattern": "^([a-z0-9_-]{3,249}(\\.(\\[\\d+\\]|[a-z0-9_-]{1,250}))*|id)$"
                                },
                                "minItems": 1
                              },
                              "lang": {
                                "type": "string",
                                "description": "Identifies the language of the text identified by this marking."
                              },
                              "marking_ref": {
                                "allOf": [
                                  {
                                    "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/identifier.json",
                                    "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                    "title": "identifier",
                                    "description": "Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.",
                                    "type": "string",
                                    "pattern": "^[a-z][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
                                  },
                                  {
                                    "pattern": "^marking-definition--",
                                    "description": "The marking_ref property specifies the ID of the marking-definition object that describes the marking."
                                  }
                                ]
                              }
                            },
                            "required": [
                              "selectors",
                              "marking_ref"
                            ]
                          },
                          "minItems": 1
                        },
                        "defanged": {
                          "type": "boolean",
                          "description": "Defines whether or not the data contained within the object has been defanged."
                        },
                        "id": {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/identifier.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "identifier",
                          "description": "Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.",
                          "type": "string",
                          "pattern": "^[a-z][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
                        },
                        "extensions": {
                          "description": "Specifies any extensions of the object, as a dictionary.",
                          "type": "object",
                          "minProperties": 1,
                          "patternProperties": {
                            "^([a-z][a-z0-9]*)+(-[a-z0-9]+)*\\-ext$": {
                              "type": "object",
                              "minProperties": 1,
                              "allOf": [
                                {
                                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/properties.json",
                                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                  "title": "properties",
                                  "description": "Rules for custom properties",
                                  "patternProperties": {
                                    "^[a-z][a-z0-9_]{0,245}_bin$": {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/binary.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "binary",
                                      "description": "The ​binary data type represents a sequence of bytes. In order to allow pattern matching on custom objects, for all properties that use the binary type, the property name MUST end with '_bin'. The JSON MTI serialization represents this as a base64-­encoded string as specified in RFC4648​. Other serializations SHOULD use a native binary type, if available.",
                                      "type": "string",
                                      "pattern": "^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$"
                                    },
                                    "^[a-z][a-z0-9_]{0,245}_hex$": {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "hex",
                                      "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                                      "type": "string",
                                      "pattern": "^([a-fA-F0-9]{2})+$"
                                    },
                                    "^([a-z][a-z0-9_]{2,249})|id$": {
                                      "anyOf": [
                                        {
                                          "type": "array",
                                          "minItems": 1
                                        },
                                        {
                                          "type": "string"
                                        },
                                        {
                                          "type": "integer"
                                        },
                                        {
                                          "type": "boolean"
                                        },
                                        {
                                          "type": "number"
                                        },
                                        {
                                          "type": "object"
                                        }
                                      ]
                                    }
                                  },
                                  "additionalProperties": false
                                }
                              ]
                            },
                            "^extension-definition--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$": {
                              "allOf": [
                                {
                                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/extension.json",
                                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                  "type": "object",
                                  "minProperties": 1,
                                  "properties": {
                                    "extension_type": {
                                      "description": "The type of extension.",
                                      "type": "string",
                                      "enum": [
                                        "new-sdo",
                                        "new-sco",
                                        "new-sro",
                                        "property-extension",
                                        "toplevel-property-extension"
                                      ]
                                    }
                                  },
                                  "allOf": [
                                    {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/properties.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "properties",
                                      "description": "Rules for custom properties",
                                      "patternProperties": {
                                        "^[a-z][a-z0-9_]{0,245}_bin$": {
                                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/binary.json",
                                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                          "title": "binary",
                                          "description": "The ​binary data type represents a sequence of bytes. In order to allow pattern matching on custom objects, for all properties that use the binary type, the property name MUST end with '_bin'. The JSON MTI serialization represents this as a base64-­encoded string as specified in RFC4648​. Other serializations SHOULD use a native binary type, if available.",
                                          "type": "string",
                                          "pattern": "^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$"
                                        },
                                        "^[a-z][a-z0-9_]{0,245}_hex$": {
                                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                          "title": "hex",
                                          "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                                          "type": "string",
                                          "pattern": "^([a-fA-F0-9]{2})+$"
                                        },
                                        "^([a-z][a-z0-9_]{2,249})|id$": {
                                          "anyOf": [
                                            {
                                              "type": "array",
                                              "minItems": 1
                                            },
                                            {
                                              "type": "string"
                                            },
                                            {
                                              "type": "integer"
                                            },
                                            {
                                              "type": "boolean"
                                            },
                                            {
                                              "type": "number"
                                            },
                                            {
                                              "type": "object"
                                            }
                                          ]
                                        }
                                      },
                                      "additionalProperties": false
                                    }
                                  ],
                                  "required": [
                                    "extension_type"
                                  ],
                                  "definitions": {
                                    "extension-type-enum": {
                                      "type": "string",
                                      "enum": [
                                        "new-sdo",
                                        "new-sco",
                                        "new-sro",
                                        "property-extension",
                                        "toplevel-property-extension"
                                      ]
                                    }
                                  }
                                }
                              ]
                            }
                          },
                          "additionalProperties": false
                        }
                      },
                      "allOf": [
                        {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/properties.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "properties",
                          "description": "Rules for custom properties",
                          "patternProperties": {
                            "^[a-z][a-z0-9_]{0,245}_bin$": {
                              "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/binary.json",
                              "$schema": "http://json-schema.org/draft/2020-12/schema#",
                              "title": "binary",
                              "description": "The ​binary data type represents a sequence of bytes. In order to allow pattern matching on custom objects, for all properties that use the binary type, the property name MUST end with '_bin'. The JSON MTI serialization represents this as a base64-­encoded string as specified in RFC4648​. Other serializations SHOULD use a native binary type, if available.",
                              "type": "string",
                              "pattern": "^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$"
                            },
                            "^[a-z][a-z0-9_]{0,245}_hex$": {
                              "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                              "$schema": "http://json-schema.org/draft/2020-12/schema#",
                              "title": "hex",
                              "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                              "type": "string",
                              "pattern": "^([a-fA-F0-9]{2})+$"
                            },
                            "^([a-z][a-z0-9_]{2,249})|id$": {
                              "anyOf": [
                                {
                                  "type": "array",
                                  "minItems": 1
                                },
                                {
                                  "type": "string"
                                },
                                {
                                  "type": "integer"
                                },
                                {
                                  "type": "boolean"
                                },
                                {
                                  "type": "number"
                                },
                                {
                                  "type": "object"
                                }
                              ]
                            }
                          },
                          "additionalProperties": false
                        }
                      ],
                      "not": {
                        "anyOf": [
                          {
                            "required": [
                              "severity"
                            ]
                          },
                          {
                            "required": [
                              "action"
                            ]
                          },
                          {
                            "required": [
                              "username"
                            ]
                          },
                          {
                            "required": [
                              "phone_numbers"
                            ]
                          }
                        ]
                      },
                      "required": [
                        "type",
                        "id"
                      ]
                    },
                    {
                      "not": {
                        "properties": {
                          "type": {
                            "type": "string",
                            "pattern": "^artifact|directory|file|mutex|process|software|user-account|windows-registry-key|x509-certificate|autonomous-system|domain-name|email-addr|email-message|ipv4-addr|ipv6-addr|mac-addr|network-traffic|url$",
                            "description": "Indicates that this object is a custom Observable Object."
                          }
                        }
                      }
                    }
                  ]
                },
                {
                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/observables/artifact.json",
                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                  "title": "artifact",
                  "description": "The Artifact Object permits capturing an array of bytes (8-bits), as a base64-encoded string string, or linking to a file-like payload.",
                  "type": "object",
                  "allOf": [
                    {
                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/cyber-observable-core.json",
                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                      "title": "cyber-observable-core",
                      "description": "Common properties and behavior across all Cyber Observable Objects.",
                      "type": "object",
                      "properties": {
                        "type": {
                          "type": "string",
                          "pattern": "^([a-z][a-z0-9]*)+(-[a-z0-9]+)*\\-?$",
                          "minLength": 3,
                          "maxLength": 250,
                          "description": "Indicates that this object is an Observable Object. The value of this property MUST be a valid Observable Object type name, but to allow for custom objects this has been removed from the schema.",
                          "not": {
                            "enum": [
                              "action"
                            ]
                          }
                        },
                        "spec_version": {
                          "type": "string",
                          "enum": [
                            "2.0",
                            "2.1"
                          ],
                          "description": "The version of the STIX specification used to represent the content in this cyber-observable."
                        },
                        "object_marking_refs": {
                          "type": "array",
                          "description": "The list of marking-definition objects to be applied to this object.",
                          "items": {
                            "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/identifier.json",
                            "$schema": "http://json-schema.org/draft/2020-12/schema#",
                            "title": "identifier",
                            "description": "Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.",
                            "type": "string",
                            "pattern": "^[a-z][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
                          },
                          "minItems": 1
                        },
                        "granular_markings": {
                          "type": "array",
                          "description": "The set of granular markings that apply to this object.",
                          "items": {
                            "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/granular-marking.json",
                            "$schema": "http://json-schema.org/draft/2020-12/schema#",
                            "title": "granular-marking",
                            "description": "The granular-marking type defines how the list of marking-definition objects referenced by the marking_refs property to apply to a set of content identified by the list of selectors in the selectors property.",
                            "type": "object",
                            "properties": {
                              "selectors": {
                                "type": "array",
                                "description": "A list of selectors for content contained within the STIX object in which this property appears.",
                                "items": {
                                  "type": "string",
                                  "pattern": "^([a-z0-9_-]{3,249}(\\.(\\[\\d+\\]|[a-z0-9_-]{1,250}))*|id)$"
                                },
                                "minItems": 1
                              },
                              "lang": {
                                "type": "string",
                                "description": "Identifies the language of the text identified by this marking."
                              },
                              "marking_ref": {
                                "allOf": [
                                  {
                                    "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/identifier.json",
                                    "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                    "title": "identifier",
                                    "description": "Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.",
                                    "type": "string",
                                    "pattern": "^[a-z][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
                                  },
                                  {
                                    "pattern": "^marking-definition--",
                                    "description": "The marking_ref property specifies the ID of the marking-definition object that describes the marking."
                                  }
                                ]
                              }
                            },
                            "required": [
                              "selectors",
                              "marking_ref"
                            ]
                          },
                          "minItems": 1
                        },
                        "defanged": {
                          "type": "boolean",
                          "description": "Defines whether or not the data contained within the object has been defanged."
                        },
                        "id": {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/identifier.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "identifier",
                          "description": "Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.",
                          "type": "string",
                          "pattern": "^[a-z][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
                        },
                        "extensions": {
                          "description": "Specifies any extensions of the object, as a dictionary.",
                          "type": "object",
                          "minProperties": 1,
                          "patternProperties": {
                            "^([a-z][a-z0-9]*)+(-[a-z0-9]+)*\\-ext$": {
                              "type": "object",
                              "minProperties": 1,
                              "allOf": [
                                {
                                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/properties.json",
                                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                  "title": "properties",
                                  "description": "Rules for custom properties",
                                  "patternProperties": {
                                    "^[a-z][a-z0-9_]{0,245}_bin$": {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/binary.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "binary",
                                      "description": "The ​binary data type represents a sequence of bytes. In order to allow pattern matching on custom objects, for all properties that use the binary type, the property name MUST end with '_bin'. The JSON MTI serialization represents this as a base64-­encoded string as specified in RFC4648​. Other serializations SHOULD use a native binary type, if available.",
                                      "type": "string",
                                      "pattern": "^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$"
                                    },
                                    "^[a-z][a-z0-9_]{0,245}_hex$": {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "hex",
                                      "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                                      "type": "string",
                                      "pattern": "^([a-fA-F0-9]{2})+$"
                                    },
                                    "^([a-z][a-z0-9_]{2,249})|id$": {
                                      "anyOf": [
                                        {
                                          "type": "array",
                                          "minItems": 1
                                        },
                                        {
                                          "type": "string"
                                        },
                                        {
                                          "type": "integer"
                                        },
                                        {
                                          "type": "boolean"
                                        },
                                        {
                                          "type": "number"
                                        },
                                        {
                                          "type": "object"
                                        }
                                      ]
                                    }
                                  },
                                  "additionalProperties": false
                                }
                              ]
                            },
                            "^extension-definition--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$": {
                              "allOf": [
                                {
                                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/extension.json",
                                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                  "type": "object",
                                  "minProperties": 1,
                                  "properties": {
                                    "extension_type": {
                                      "description": "The type of extension.",
                                      "type": "string",
                                      "enum": [
                                        "new-sdo",
                                        "new-sco",
                                        "new-sro",
                                        "property-extension",
                                        "toplevel-property-extension"
                                      ]
                                    }
                                  },
                                  "allOf": [
                                    {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/properties.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "properties",
                                      "description": "Rules for custom properties",
                                      "patternProperties": {
                                        "^[a-z][a-z0-9_]{0,245}_bin$": {
                                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/binary.json",
                                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                          "title": "binary",
                                          "description": "The ​binary data type represents a sequence of bytes. In order to allow pattern matching on custom objects, for all properties that use the binary type, the property name MUST end with '_bin'. The JSON MTI serialization represents this as a base64-­encoded string as specified in RFC4648​. Other serializations SHOULD use a native binary type, if available.",
                                          "type": "string",
                                          "pattern": "^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$"
                                        },
                                        "^[a-z][a-z0-9_]{0,245}_hex$": {
                                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                          "title": "hex",
                                          "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                                          "type": "string",
                                          "pattern": "^([a-fA-F0-9]{2})+$"
                                        },
                                        "^([a-z][a-z0-9_]{2,249})|id$": {
                                          "anyOf": [
                                            {
                                              "type": "array",
                                              "minItems": 1
                                            },
                                            {
                                              "type": "string"
                                            },
                                            {
                                              "type": "integer"
                                            },
                                            {
                                              "type": "boolean"
                                            },
                                            {
                                              "type": "number"
                                            },
                                            {
                                              "type": "object"
                                            }
                                          ]
                                        }
                                      },
                                      "additionalProperties": false
                                    }
                                  ],
                                  "required": [
                                    "extension_type"
                                  ],
                                  "definitions": {
                                    "extension-type-enum": {
                                      "type": "string",
                                      "enum": [
                                        "new-sdo",
                                        "new-sco",
                                        "new-sro",
                                        "property-extension",
                                        "toplevel-property-extension"
                                      ]
                                    }
                                  }
                                }
                              ]
                            }
                          },
                          "additionalProperties": false
                        }
                      },
                      "allOf": [
                        {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/properties.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "properties",
                          "description": "Rules for custom properties",
                          "patternProperties": {
                            "^[a-z][a-z0-9_]{0,245}_bin$": {
                              "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/binary.json",
                              "$schema": "http://json-schema.org/draft/2020-12/schema#",
                              "title": "binary",
                              "description": "The ​binary data type represents a sequence of bytes. In order to allow pattern matching on custom objects, for all properties that use the binary type, the property name MUST end with '_bin'. The JSON MTI serialization represents this as a base64-­encoded string as specified in RFC4648​. Other serializations SHOULD use a native binary type, if available.",
                              "type": "string",
                              "pattern": "^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$"
                            },
                            "^[a-z][a-z0-9_]{0,245}_hex$": {
                              "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                              "$schema": "http://json-schema.org/draft/2020-12/schema#",
                              "title": "hex",
                              "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                              "type": "string",
                              "pattern": "^([a-fA-F0-9]{2})+$"
                            },
                            "^([a-z][a-z0-9_]{2,249})|id$": {
                              "anyOf": [
                                {
                                  "type": "array",
                                  "minItems": 1
                                },
                                {
                                  "type": "string"
                                },
                                {
                                  "type": "integer"
                                },
                                {
                                  "type": "boolean"
                                },
                                {
                                  "type": "number"
                                },
                                {
                                  "type": "object"
                                }
                              ]
                            }
                          },
                          "additionalProperties": false
                        }
                      ],
                      "not": {
                        "anyOf": [
                          {
                            "required": [
                              "severity"
                            ]
                          },
                          {
                            "required": [
                              "action"
                            ]
                          },
                          {
                            "required": [
                              "username"
                            ]
                          },
                          {
                            "required": [
                              "phone_numbers"
                            ]
                          }
                        ]
                      },
                      "required": [
                        "type",
                        "id"
                      ]
                    },
                    {
                      "properties": {
                        "type": {
                          "type": "string",
                          "description": "The value of this property MUST be `artifact`.",
                          "enum": [
                            "artifact"
                          ]
                        },
                        "id": {
                          "title": "id",
                          "pattern": "^artifact--"
                        },
                        "mime_type": {
                          "type": "string",
                          "pattern": "^(application|audio|font|image|message|model|multipart|text|video)/[a-zA-Z0-9.+_-]+",
                          "description": "The value of this property MUST be a valid MIME type as specified in the IANA Media Types registry."
                        },
                        "payload_bin": {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/binary.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "binary",
                          "description": "The ​binary data type represents a sequence of bytes. In order to allow pattern matching on custom objects, for all properties that use the binary type, the property name MUST end with '_bin'. The JSON MTI serialization represents this as a base64-­encoded string as specified in RFC4648​. Other serializations SHOULD use a native binary type, if available.",
                          "type": "string",
                          "pattern": "^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$"
                        },
                        "url": {
                          "description": "The value of this property MUST be a valid URL that resolves to the unencoded content.",
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/url-regex.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "url-regex",
                          "type": "string",
                          "format": "uri"
                        },
                        "hashes": {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hashes-type.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "hashes",
                          "description": "The Hashes type represents one or more cryptographic hashes, as a special set of key/value pairs",
                          "type": "object",
                          "allOf": [
                            {
                              "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/dictionary.json",
                              "$schema": "http://json-schema.org/draft/2020-12/schema#",
                              "title": "dictionary",
                              "description": "A dictionary captures a set of key/value pairs",
                              "type": "object",
                              "minProperties": 1,
                              "patternProperties": {
                                "^[a-zA-Z0-9_-]{0,250}$": {
                                  "anyOf": [
                                    {
                                      "type": "array",
                                      "minItems": 1
                                    },
                                    {
                                      "type": "string"
                                    },
                                    {
                                      "type": "integer"
                                    },
                                    {
                                      "type": "boolean"
                                    },
                                    {
                                      "type": "number"
                                    },
                                    {
                                      "type": "object"
                                    }
                                  ]
                                }
                              },
                              "additionalProperties": false
                            }
                          ],
                          "patternProperties": {
                            "^[a-zA-Z0-9_-]{3,250}$": {
                              "type": "string",
                              "description": "Custom hash key"
                            },
                            "^MD5$": {
                              "type": "string",
                              "description": "Specifies the MD5 message digest algorithm.",
                              "pattern": "^[a-fA-F0-9]{32}$"
                            },
                            "^SHA-1$": {
                              "type": "string",
                              "description": "Specifies the SHA-1 (secure-hash algorithm 1) cryptographic hash function.",
                              "pattern": "^[a-fA-F0-9]{40}$"
                            },
                            "^SHA-256$": {
                              "type": "string",
                              "description": "Specifies the SHA-256 cryptographic hash function (part of the SHA2 family).",
                              "pattern": "^[a-fA-F0-9]{64}$"
                            },
                            "^SHA-512$": {
                              "type": "string",
                              "description": "Specifies the SHA-512 cryptographic hash function (part of the SHA2 family).",
                              "pattern": "^[a-fA-F0-9]{128}$"
                            },
                            "^SHA3-256$": {
                              "type": "string",
                              "description": "Specifies the SHA3-256 cryptographic hash function.",
                              "pattern": "^[a-fA-F0-9]{64}$"
                            },
                            "^SHA3-512$": {
                              "type": "string",
                              "description": "Specifies the SHA3-512 cryptographic hash function.",
                              "pattern": "^[a-fA-F0-9]{128}$"
                            },
                            "^SSDEEP$": {
                              "type": "string",
                              "description": "Specifies the ssdeep fuzzy hashing algorithm.",
                              "pattern": "^[a-zA-Z0-9/+:.]{1,128}$"
                            },
                            "^TLSH$": {
                              "type": "string",
                              "description": "Specifies the TLSH locality-sensitive hashing algorithm.",
                              "pattern": "^[a-zA-Z0-9]{70}$"
                            }
                          },
                          "additionalProperties": false
                        },
                        "encryption_algorithm": {
                          "description": "If the artifact is encrypted, specifies the type of encryption algorithm the binary data  (either via payload_bin or url) is encoded in.",
                          "type": "string",
                          "enum": [
                            "AES-256-GCM",
                            "ChaCha20-Poly1305",
                            "mime-type-indicated"
                          ]
                        },
                        "decryption_key": {
                          "type": "string",
                          "description": "Specifies the decryption key for the encrypted binary data (either via payload_bin or url)."
                        }
                      }
                    },
                    {
                      "oneOf": [
                        {
                          "required": [
                            "payload_bin"
                          ],
                          "not": {
                            "required": [
                              "url"
                            ]
                          }
                        },
                        {
                          "required": [
                            "url",
                            "hashes"
                          ],
                          "not": {
                            "required": [
                              "payload_bin"
                            ]
                          }
                        }
                      ]
                    },
                    {
                      "oneOf": [
                        {
                          "required": [
                            "encryption_algorithm"
                          ],
                          "not": {
                            "required": [
                              "decryption_key"
                            ]
                          }
                        },
                        {
                          "required": [
                            "encryption_algorithm",
                            "decryption_key"
                          ]
                        },
                        {
                          "allOf": [
                            {
                              "not": {
                                "required": [
                                  "encryption_algorithm"
                                ]
                              }
                            },
                            {
                              "not": {
                                "required": [
                                  "decryption_key"
                                ]
                              }
                            }
                          ]
                        }
                      ]
                    }
                  ],
                  "definitions": {
                    "encryption-algorithm-enum": {
                      "type": "string",
                      "enum": [
                        "AES-256-GCM",
                        "ChaCha20-Poly1305",
                        "mime-type-indicated"
                      ]
                    }
                  }
                },
                {
                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/observables/autonomous-system.json",
                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                  "title": "autonomous-system",
                  "description": "The AS object represents the properties of an Autonomous Systems (AS).",
                  "type": "object",
                  "allOf": [
                    {
                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/cyber-observable-core.json",
                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                      "title": "cyber-observable-core",
                      "description": "Common properties and behavior across all Cyber Observable Objects.",
                      "type": "object",
                      "properties": {
                        "type": {
                          "type": "string",
                          "pattern": "^([a-z][a-z0-9]*)+(-[a-z0-9]+)*\\-?$",
                          "minLength": 3,
                          "maxLength": 250,
                          "description": "Indicates that this object is an Observable Object. The value of this property MUST be a valid Observable Object type name, but to allow for custom objects this has been removed from the schema.",
                          "not": {
                            "enum": [
                              "action"
                            ]
                          }
                        },
                        "spec_version": {
                          "type": "string",
                          "enum": [
                            "2.0",
                            "2.1"
                          ],
                          "description": "The version of the STIX specification used to represent the content in this cyber-observable."
                        },
                        "object_marking_refs": {
                          "type": "array",
                          "description": "The list of marking-definition objects to be applied to this object.",
                          "items": {
                            "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/identifier.json",
                            "$schema": "http://json-schema.org/draft/2020-12/schema#",
                            "title": "identifier",
                            "description": "Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.",
                            "type": "string",
                            "pattern": "^[a-z][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
                          },
                          "minItems": 1
                        },
                        "granular_markings": {
                          "type": "array",
                          "description": "The set of granular markings that apply to this object.",
                          "items": {
                            "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/granular-marking.json",
                            "$schema": "http://json-schema.org/draft/2020-12/schema#",
                            "title": "granular-marking",
                            "description": "The granular-marking type defines how the list of marking-definition objects referenced by the marking_refs property to apply to a set of content identified by the list of selectors in the selectors property.",
                            "type": "object",
                            "properties": {
                              "selectors": {
                                "type": "array",
                                "description": "A list of selectors for content contained within the STIX object in which this property appears.",
                                "items": {
                                  "type": "string",
                                  "pattern": "^([a-z0-9_-]{3,249}(\\.(\\[\\d+\\]|[a-z0-9_-]{1,250}))*|id)$"
                                },
                                "minItems": 1
                              },
                              "lang": {
                                "type": "string",
                                "description": "Identifies the language of the text identified by this marking."
                              },
                              "marking_ref": {
                                "allOf": [
                                  {
                                    "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/identifier.json",
                                    "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                    "title": "identifier",
                                    "description": "Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.",
                                    "type": "string",
                                    "pattern": "^[a-z][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
                                  },
                                  {
                                    "pattern": "^marking-definition--",
                                    "description": "The marking_ref property specifies the ID of the marking-definition object that describes the marking."
                                  }
                                ]
                              }
                            },
                            "required": [
                              "selectors",
                              "marking_ref"
                            ]
                          },
                          "minItems": 1
                        },
                        "defanged": {
                          "type": "boolean",
                          "description": "Defines whether or not the data contained within the object has been defanged."
                        },
                        "id": {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/identifier.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "identifier",
                          "description": "Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.",
                          "type": "string",
                          "pattern": "^[a-z][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
                        },
                        "extensions": {
                          "description": "Specifies any extensions of the object, as a dictionary.",
                          "type": "object",
                          "minProperties": 1,
                          "patternProperties": {
                            "^([a-z][a-z0-9]*)+(-[a-z0-9]+)*\\-ext$": {
                              "type": "object",
                              "minProperties": 1,
                              "allOf": [
                                {
                                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/properties.json",
                                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                  "title": "properties",
                                  "description": "Rules for custom properties",
                                  "patternProperties": {
                                    "^[a-z][a-z0-9_]{0,245}_bin$": {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/binary.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "binary",
                                      "description": "The ​binary data type represents a sequence of bytes. In order to allow pattern matching on custom objects, for all properties that use the binary type, the property name MUST end with '_bin'. The JSON MTI serialization represents this as a base64-­encoded string as specified in RFC4648​. Other serializations SHOULD use a native binary type, if available.",
                                      "type": "string",
                                      "pattern": "^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$"
                                    },
                                    "^[a-z][a-z0-9_]{0,245}_hex$": {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "hex",
                                      "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                                      "type": "string",
                                      "pattern": "^([a-fA-F0-9]{2})+$"
                                    },
                                    "^([a-z][a-z0-9_]{2,249})|id$": {
                                      "anyOf": [
                                        {
                                          "type": "array",
                                          "minItems": 1
                                        },
                                        {
                                          "type": "string"
                                        },
                                        {
                                          "type": "integer"
                                        },
                                        {
                                          "type": "boolean"
                                        },
                                        {
                                          "type": "number"
                                        },
                                        {
                                          "type": "object"
                                        }
                                      ]
                                    }
                                  },
                                  "additionalProperties": false
                                }
                              ]
                            },
                            "^extension-definition--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$": {
                              "allOf": [
                                {
                                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/extension.json",
                                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                  "type": "object",
                                  "minProperties": 1,
                                  "properties": {
                                    "extension_type": {
                                      "description": "The type of extension.",
                                      "type": "string",
                                      "enum": [
                                        "new-sdo",
                                        "new-sco",
                                        "new-sro",
                                        "property-extension",
                                        "toplevel-property-extension"
                                      ]
                                    }
                                  },
                                  "allOf": [
                                    {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/properties.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "properties",
                                      "description": "Rules for custom properties",
                                      "patternProperties": {
                                        "^[a-z][a-z0-9_]{0,245}_bin$": {
                                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/binary.json",
                                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                          "title": "binary",
                                          "description": "The ​binary data type represents a sequence of bytes. In order to allow pattern matching on custom objects, for all properties that use the binary type, the property name MUST end with '_bin'. The JSON MTI serialization represents this as a base64-­encoded string as specified in RFC4648​. Other serializations SHOULD use a native binary type, if available.",
                                          "type": "string",
                                          "pattern": "^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$"
                                        },
                                        "^[a-z][a-z0-9_]{0,245}_hex$": {
                                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                          "title": "hex",
                                          "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                                          "type": "string",
                                          "pattern": "^([a-fA-F0-9]{2})+$"
                                        },
                                        "^([a-z][a-z0-9_]{2,249})|id$": {
                                          "anyOf": [
                                            {
                                              "type": "array",
                                              "minItems": 1
                                            },
                                            {
                                              "type": "string"
                                            },
                                            {
                                              "type": "integer"
                                            },
                                            {
                                              "type": "boolean"
                                            },
                                            {
                                              "type": "number"
                                            },
                                            {
                                              "type": "object"
                                            }
                                          ]
                                        }
                                      },
                                      "additionalProperties": false
                                    }
                                  ],
                                  "required": [
                                    "extension_type"
                                  ],
                                  "definitions": {
                                    "extension-type-enum": {
                                      "type": "string",
                                      "enum": [
                                        "new-sdo",
                                        "new-sco",
                                        "new-sro",
                                        "property-extension",
                                        "toplevel-property-extension"
                                      ]
                                    }
                                  }
                                }
                              ]
                            }
                          },
                          "additionalProperties": false
                        }
                      },
                      "allOf": [
                        {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/properties.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "properties",
                          "description": "Rules for custom properties",
                          "patternProperties": {
                            "^[a-z][a-z0-9_]{0,245}_bin$": {
                              "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/binary.json",
                              "$schema": "http://json-schema.org/draft/2020-12/schema#",
                              "title": "binary",
                              "description": "The ​binary data type represents a sequence of bytes. In order to allow pattern matching on custom objects, for all properties that use the binary type, the property name MUST end with '_bin'. The JSON MTI serialization represents this as a base64-­encoded string as specified in RFC4648​. Other serializations SHOULD use a native binary type, if available.",
                              "type": "string",
                              "pattern": "^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$"
                            },
                            "^[a-z][a-z0-9_]{0,245}_hex$": {
                              "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                              "$schema": "http://json-schema.org/draft/2020-12/schema#",
                              "title": "hex",
                              "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                              "type": "string",
                              "pattern": "^([a-fA-F0-9]{2})+$"
                            },
                            "^([a-z][a-z0-9_]{2,249})|id$": {
                              "anyOf": [
                                {
                                  "type": "array",
                                  "minItems": 1
                                },
                                {
                                  "type": "string"
                                },
                                {
                                  "type": "integer"
                                },
                                {
                                  "type": "boolean"
                                },
                                {
                                  "type": "number"
                                },
                                {
                                  "type": "object"
                                }
                              ]
                            }
                          },
                          "additionalProperties": false
                        }
                      ],
                      "not": {
                        "anyOf": [
                          {
                            "required": [
                              "severity"
                            ]
                          },
                          {
                            "required": [
                              "action"
                            ]
                          },
                          {
                            "required": [
                              "username"
                            ]
                          },
                          {
                            "required": [
                              "phone_numbers"
                            ]
                          }
                        ]
                      },
                      "required": [
                        "type",
                        "id"
                      ]
                    },
                    {
                      "properties": {
                        "type": {
                          "type": "string",
                          "description": "The value of this property MUST be `autonomous-system`.",
                          "enum": [
                            "autonomous-system"
                          ]
                        },
                        "id": {
                          "title": "id",
                          "pattern": "^autonomous-system--"
                        },
                        "number": {
                          "type": "integer",
                          "description": "Specifies the number assigned to the AS. Such assignments are typically performed by a Regional Internet Registries (RIR)."
                        },
                        "name": {
                          "type": "string",
                          "description": "Specifies the name of the AS."
                        },
                        "rir": {
                          "type": "string",
                          "description": "Specifies the name of the Regional Internet Registry (RIR) that assigned the number to the AS."
                        }
                      },
                      "required": [
                        "number"
                      ]
                    }
                  ]
                },
                {
                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/observables/directory.json",
                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                  "title": "directory",
                  "description": "The Directory Object represents the properties common to a file system directory.",
                  "type": "object",
                  "allOf": [
                    {
                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/cyber-observable-core.json",
                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                      "title": "cyber-observable-core",
                      "description": "Common properties and behavior across all Cyber Observable Objects.",
                      "type": "object",
                      "properties": {
                        "type": {
                          "type": "string",
                          "pattern": "^([a-z][a-z0-9]*)+(-[a-z0-9]+)*\\-?$",
                          "minLength": 3,
                          "maxLength": 250,
                          "description": "Indicates that this object is an Observable Object. The value of this property MUST be a valid Observable Object type name, but to allow for custom objects this has been removed from the schema.",
                          "not": {
                            "enum": [
                              "action"
                            ]
                          }
                        },
                        "spec_version": {
                          "type": "string",
                          "enum": [
                            "2.0",
                            "2.1"
                          ],
                          "description": "The version of the STIX specification used to represent the content in this cyber-observable."
                        },
                        "object_marking_refs": {
                          "type": "array",
                          "description": "The list of marking-definition objects to be applied to this object.",
                          "items": {
                            "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/identifier.json",
                            "$schema": "http://json-schema.org/draft/2020-12/schema#",
                            "title": "identifier",
                            "description": "Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.",
                            "type": "string",
                            "pattern": "^[a-z][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
                          },
                          "minItems": 1
                        },
                        "granular_markings": {
                          "type": "array",
                          "description": "The set of granular markings that apply to this object.",
                          "items": {
                            "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/granular-marking.json",
                            "$schema": "http://json-schema.org/draft/2020-12/schema#",
                            "title": "granular-marking",
                            "description": "The granular-marking type defines how the list of marking-definition objects referenced by the marking_refs property to apply to a set of content identified by the list of selectors in the selectors property.",
                            "type": "object",
                            "properties": {
                              "selectors": {
                                "type": "array",
                                "description": "A list of selectors for content contained within the STIX object in which this property appears.",
                                "items": {
                                  "type": "string",
                                  "pattern": "^([a-z0-9_-]{3,249}(\\.(\\[\\d+\\]|[a-z0-9_-]{1,250}))*|id)$"
                                },
                                "minItems": 1
                              },
                              "lang": {
                                "type": "string",
                                "description": "Identifies the language of the text identified by this marking."
                              },
                              "marking_ref": {
                                "allOf": [
                                  {
                                    "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/identifier.json",
                                    "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                    "title": "identifier",
                                    "description": "Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.",
                                    "type": "string",
                                    "pattern": "^[a-z][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
                                  },
                                  {
                                    "pattern": "^marking-definition--",
                                    "description": "The marking_ref property specifies the ID of the marking-definition object that describes the marking."
                                  }
                                ]
                              }
                            },
                            "required": [
                              "selectors",
                              "marking_ref"
                            ]
                          },
                          "minItems": 1
                        },
                        "defanged": {
                          "type": "boolean",
                          "description": "Defines whether or not the data contained within the object has been defanged."
                        },
                        "id": {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/identifier.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "identifier",
                          "description": "Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.",
                          "type": "string",
                          "pattern": "^[a-z][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
                        },
                        "extensions": {
                          "description": "Specifies any extensions of the object, as a dictionary.",
                          "type": "object",
                          "minProperties": 1,
                          "patternProperties": {
                            "^([a-z][a-z0-9]*)+(-[a-z0-9]+)*\\-ext$": {
                              "type": "object",
                              "minProperties": 1,
                              "allOf": [
                                {
                                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/properties.json",
                                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                  "title": "properties",
                                  "description": "Rules for custom properties",
                                  "patternProperties": {
                                    "^[a-z][a-z0-9_]{0,245}_bin$": {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/binary.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "binary",
                                      "description": "The ​binary data type represents a sequence of bytes. In order to allow pattern matching on custom objects, for all properties that use the binary type, the property name MUST end with '_bin'. The JSON MTI serialization represents this as a base64-­encoded string as specified in RFC4648​. Other serializations SHOULD use a native binary type, if available.",
                                      "type": "string",
                                      "pattern": "^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$"
                                    },
                                    "^[a-z][a-z0-9_]{0,245}_hex$": {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "hex",
                                      "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                                      "type": "string",
                                      "pattern": "^([a-fA-F0-9]{2})+$"
                                    },
                                    "^([a-z][a-z0-9_]{2,249})|id$": {
                                      "anyOf": [
                                        {
                                          "type": "array",
                                          "minItems": 1
                                        },
                                        {
                                          "type": "string"
                                        },
                                        {
                                          "type": "integer"
                                        },
                                        {
                                          "type": "boolean"
                                        },
                                        {
                                          "type": "number"
                                        },
                                        {
                                          "type": "object"
                                        }
                                      ]
                                    }
                                  },
                                  "additionalProperties": false
                                }
                              ]
                            },
                            "^extension-definition--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$": {
                              "allOf": [
                                {
                                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/extension.json",
                                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                  "type": "object",
                                  "minProperties": 1,
                                  "properties": {
                                    "extension_type": {
                                      "description": "The type of extension.",
                                      "type": "string",
                                      "enum": [
                                        "new-sdo",
                                        "new-sco",
                                        "new-sro",
                                        "property-extension",
                                        "toplevel-property-extension"
                                      ]
                                    }
                                  },
                                  "allOf": [
                                    {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/properties.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "properties",
                                      "description": "Rules for custom properties",
                                      "patternProperties": {
                                        "^[a-z][a-z0-9_]{0,245}_bin$": {
                                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/binary.json",
                                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                          "title": "binary",
                                          "description": "The ​binary data type represents a sequence of bytes. In order to allow pattern matching on custom objects, for all properties that use the binary type, the property name MUST end with '_bin'. The JSON MTI serialization represents this as a base64-­encoded string as specified in RFC4648​. Other serializations SHOULD use a native binary type, if available.",
                                          "type": "string",
                                          "pattern": "^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$"
                                        },
                                        "^[a-z][a-z0-9_]{0,245}_hex$": {
                                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                          "title": "hex",
                                          "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                                          "type": "string",
                                          "pattern": "^([a-fA-F0-9]{2})+$"
                                        },
                                        "^([a-z][a-z0-9_]{2,249})|id$": {
                                          "anyOf": [
                                            {
                                              "type": "array",
                                              "minItems": 1
                                            },
                                            {
                                              "type": "string"
                                            },
                                            {
                                              "type": "integer"
                                            },
                                            {
                                              "type": "boolean"
                                            },
                                            {
                                              "type": "number"
                                            },
                                            {
                                              "type": "object"
                                            }
                                          ]
                                        }
                                      },
                                      "additionalProperties": false
                                    }
                                  ],
                                  "required": [
                                    "extension_type"
                                  ],
                                  "definitions": {
                                    "extension-type-enum": {
                                      "type": "string",
                                      "enum": [
                                        "new-sdo",
                                        "new-sco",
                                        "new-sro",
                                        "property-extension",
                                        "toplevel-property-extension"
                                      ]
                                    }
                                  }
                                }
                              ]
                            }
                          },
                          "additionalProperties": false
                        }
                      },
                      "allOf": [
                        {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/properties.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "properties",
                          "description": "Rules for custom properties",
                          "patternProperties": {
                            "^[a-z][a-z0-9_]{0,245}_bin$": {
                              "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/binary.json",
                              "$schema": "http://json-schema.org/draft/2020-12/schema#",
                              "title": "binary",
                              "description": "The ​binary data type represents a sequence of bytes. In order to allow pattern matching on custom objects, for all properties that use the binary type, the property name MUST end with '_bin'. The JSON MTI serialization represents this as a base64-­encoded string as specified in RFC4648​. Other serializations SHOULD use a native binary type, if available.",
                              "type": "string",
                              "pattern": "^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$"
                            },
                            "^[a-z][a-z0-9_]{0,245}_hex$": {
                              "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                              "$schema": "http://json-schema.org/draft/2020-12/schema#",
                              "title": "hex",
                              "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                              "type": "string",
                              "pattern": "^([a-fA-F0-9]{2})+$"
                            },
                            "^([a-z][a-z0-9_]{2,249})|id$": {
                              "anyOf": [
                                {
                                  "type": "array",
                                  "minItems": 1
                                },
                                {
                                  "type": "string"
                                },
                                {
                                  "type": "integer"
                                },
                                {
                                  "type": "boolean"
                                },
                                {
                                  "type": "number"
                                },
                                {
                                  "type": "object"
                                }
                              ]
                            }
                          },
                          "additionalProperties": false
                        }
                      ],
                      "not": {
                        "anyOf": [
                          {
                            "required": [
                              "severity"
                            ]
                          },
                          {
                            "required": [
                              "action"
                            ]
                          },
                          {
                            "required": [
                              "username"
                            ]
                          },
                          {
                            "required": [
                              "phone_numbers"
                            ]
                          }
                        ]
                      },
                      "required": [
                        "type",
                        "id"
                      ]
                    },
                    {
                      "properties": {
                        "type": {
                          "type": "string",
                          "description": "The value of this property MUST be `directory`.",
                          "enum": [
                            "directory"
                          ]
                        },
                        "id": {
                          "title": "id",
                          "pattern": "^directory--"
                        },
                        "path": {
                          "type": "string",
                          "description": "Specifies the path, as originally observed, to the directory on the file system."
                        },
                        "path_enc": {
                          "type": "string",
                          "pattern": "^[a-zA-Z0-9/\\.+_:-]{2,250}$",
                          "description": "Specifies the observed encoding for the path."
                        },
                        "ctime": {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/timestamp.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "timestamp",
                          "description": "Represents timestamps across the CTI specifications. The format is an RFC3339 timestamp, with a required timezone specification of 'Z'.",
                          "type": "string",
                          "pattern": "^[0-9]{4}-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])T([01][0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9]|60)(\\.[0-9]+)?Z$"
                        },
                        "mtime": {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/timestamp.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "timestamp",
                          "description": "Represents timestamps across the CTI specifications. The format is an RFC3339 timestamp, with a required timezone specification of 'Z'.",
                          "type": "string",
                          "pattern": "^[0-9]{4}-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])T([01][0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9]|60)(\\.[0-9]+)?Z$"
                        },
                        "atime": {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/timestamp.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "timestamp",
                          "description": "Represents timestamps across the CTI specifications. The format is an RFC3339 timestamp, with a required timezone specification of 'Z'.",
                          "type": "string",
                          "pattern": "^[0-9]{4}-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])T([01][0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9]|60)(\\.[0-9]+)?Z$"
                        },
                        "contains_refs": {
                          "type": "array",
                          "description": "Specifies a list of references to other File and/or Directory Objects contained within the directory.",
                          "items": {
                            "type": "string"
                          },
                          "minItems": 1
                        }
                      },
                      "required": [
                        "path"
                      ]
                    }
                  ]
                },
                {
                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/observables/domain-name.json",
                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                  "title": "domain-name",
                  "description": "The Domain Name represents the properties of a network domain name.",
                  "type": "object",
                  "allOf": [
                    {
                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/cyber-observable-core.json",
                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                      "title": "cyber-observable-core",
                      "description": "Common properties and behavior across all Cyber Observable Objects.",
                      "type": "object",
                      "properties": {
                        "type": {
                          "type": "string",
                          "pattern": "^([a-z][a-z0-9]*)+(-[a-z0-9]+)*\\-?$",
                          "minLength": 3,
                          "maxLength": 250,
                          "description": "Indicates that this object is an Observable Object. The value of this property MUST be a valid Observable Object type name, but to allow for custom objects this has been removed from the schema.",
                          "not": {
                            "enum": [
                              "action"
                            ]
                          }
                        },
                        "spec_version": {
                          "type": "string",
                          "enum": [
                            "2.0",
                            "2.1"
                          ],
                          "description": "The version of the STIX specification used to represent the content in this cyber-observable."
                        },
                        "object_marking_refs": {
                          "type": "array",
                          "description": "The list of marking-definition objects to be applied to this object.",
                          "items": {
                            "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/identifier.json",
                            "$schema": "http://json-schema.org/draft/2020-12/schema#",
                            "title": "identifier",
                            "description": "Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.",
                            "type": "string",
                            "pattern": "^[a-z][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
                          },
                          "minItems": 1
                        },
                        "granular_markings": {
                          "type": "array",
                          "description": "The set of granular markings that apply to this object.",
                          "items": {
                            "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/granular-marking.json",
                            "$schema": "http://json-schema.org/draft/2020-12/schema#",
                            "title": "granular-marking",
                            "description": "The granular-marking type defines how the list of marking-definition objects referenced by the marking_refs property to apply to a set of content identified by the list of selectors in the selectors property.",
                            "type": "object",
                            "properties": {
                              "selectors": {
                                "type": "array",
                                "description": "A list of selectors for content contained within the STIX object in which this property appears.",
                                "items": {
                                  "type": "string",
                                  "pattern": "^([a-z0-9_-]{3,249}(\\.(\\[\\d+\\]|[a-z0-9_-]{1,250}))*|id)$"
                                },
                                "minItems": 1
                              },
                              "lang": {
                                "type": "string",
                                "description": "Identifies the language of the text identified by this marking."
                              },
                              "marking_ref": {
                                "allOf": [
                                  {
                                    "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/identifier.json",
                                    "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                    "title": "identifier",
                                    "description": "Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.",
                                    "type": "string",
                                    "pattern": "^[a-z][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
                                  },
                                  {
                                    "pattern": "^marking-definition--",
                                    "description": "The marking_ref property specifies the ID of the marking-definition object that describes the marking."
                                  }
                                ]
                              }
                            },
                            "required": [
                              "selectors",
                              "marking_ref"
                            ]
                          },
                          "minItems": 1
                        },
                        "defanged": {
                          "type": "boolean",
                          "description": "Defines whether or not the data contained within the object has been defanged."
                        },
                        "id": {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/identifier.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "identifier",
                          "description": "Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.",
                          "type": "string",
                          "pattern": "^[a-z][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
                        },
                        "extensions": {
                          "description": "Specifies any extensions of the object, as a dictionary.",
                          "type": "object",
                          "minProperties": 1,
                          "patternProperties": {
                            "^([a-z][a-z0-9]*)+(-[a-z0-9]+)*\\-ext$": {
                              "type": "object",
                              "minProperties": 1,
                              "allOf": [
                                {
                                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/properties.json",
                                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                  "title": "properties",
                                  "description": "Rules for custom properties",
                                  "patternProperties": {
                                    "^[a-z][a-z0-9_]{0,245}_bin$": {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/binary.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "binary",
                                      "description": "The ​binary data type represents a sequence of bytes. In order to allow pattern matching on custom objects, for all properties that use the binary type, the property name MUST end with '_bin'. The JSON MTI serialization represents this as a base64-­encoded string as specified in RFC4648​. Other serializations SHOULD use a native binary type, if available.",
                                      "type": "string",
                                      "pattern": "^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$"
                                    },
                                    "^[a-z][a-z0-9_]{0,245}_hex$": {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "hex",
                                      "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                                      "type": "string",
                                      "pattern": "^([a-fA-F0-9]{2})+$"
                                    },
                                    "^([a-z][a-z0-9_]{2,249})|id$": {
                                      "anyOf": [
                                        {
                                          "type": "array",
                                          "minItems": 1
                                        },
                                        {
                                          "type": "string"
                                        },
                                        {
                                          "type": "integer"
                                        },
                                        {
                                          "type": "boolean"
                                        },
                                        {
                                          "type": "number"
                                        },
                                        {
                                          "type": "object"
                                        }
                                      ]
                                    }
                                  },
                                  "additionalProperties": false
                                }
                              ]
                            },
                            "^extension-definition--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$": {
                              "allOf": [
                                {
                                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/extension.json",
                                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                  "type": "object",
                                  "minProperties": 1,
                                  "properties": {
                                    "extension_type": {
                                      "description": "The type of extension.",
                                      "type": "string",
                                      "enum": [
                                        "new-sdo",
                                        "new-sco",
                                        "new-sro",
                                        "property-extension",
                                        "toplevel-property-extension"
                                      ]
                                    }
                                  },
                                  "allOf": [
                                    {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/properties.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "properties",
                                      "description": "Rules for custom properties",
                                      "patternProperties": {
                                        "^[a-z][a-z0-9_]{0,245}_bin$": {
                                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/binary.json",
                                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                          "title": "binary",
                                          "description": "The ​binary data type represents a sequence of bytes. In order to allow pattern matching on custom objects, for all properties that use the binary type, the property name MUST end with '_bin'. The JSON MTI serialization represents this as a base64-­encoded string as specified in RFC4648​. Other serializations SHOULD use a native binary type, if available.",
                                          "type": "string",
                                          "pattern": "^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$"
                                        },
                                        "^[a-z][a-z0-9_]{0,245}_hex$": {
                                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                          "title": "hex",
                                          "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                                          "type": "string",
                                          "pattern": "^([a-fA-F0-9]{2})+$"
                                        },
                                        "^([a-z][a-z0-9_]{2,249})|id$": {
                                          "anyOf": [
                                            {
                                              "type": "array",
                                              "minItems": 1
                                            },
                                            {
                                              "type": "string"
                                            },
                                            {
                                              "type": "integer"
                                            },
                                            {
                                              "type": "boolean"
                                            },
                                            {
                                              "type": "number"
                                            },
                                            {
                                              "type": "object"
                                            }
                                          ]
                                        }
                                      },
                                      "additionalProperties": false
                                    }
                                  ],
                                  "required": [
                                    "extension_type"
                                  ],
                                  "definitions": {
                                    "extension-type-enum": {
                                      "type": "string",
                                      "enum": [
                                        "new-sdo",
                                        "new-sco",
                                        "new-sro",
                                        "property-extension",
                                        "toplevel-property-extension"
                                      ]
                                    }
                                  }
                                }
                              ]
                            }
                          },
                          "additionalProperties": false
                        }
                      },
                      "allOf": [
                        {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/properties.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "properties",
                          "description": "Rules for custom properties",
                          "patternProperties": {
                            "^[a-z][a-z0-9_]{0,245}_bin$": {
                              "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/binary.json",
                              "$schema": "http://json-schema.org/draft/2020-12/schema#",
                              "title": "binary",
                              "description": "The ​binary data type represents a sequence of bytes. In order to allow pattern matching on custom objects, for all properties that use the binary type, the property name MUST end with '_bin'. The JSON MTI serialization represents this as a base64-­encoded string as specified in RFC4648​. Other serializations SHOULD use a native binary type, if available.",
                              "type": "string",
                              "pattern": "^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$"
                            },
                            "^[a-z][a-z0-9_]{0,245}_hex$": {
                              "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                              "$schema": "http://json-schema.org/draft/2020-12/schema#",
                              "title": "hex",
                              "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                              "type": "string",
                              "pattern": "^([a-fA-F0-9]{2})+$"
                            },
                            "^([a-z][a-z0-9_]{2,249})|id$": {
                              "anyOf": [
                                {
                                  "type": "array",
                                  "minItems": 1
                                },
                                {
                                  "type": "string"
                                },
                                {
                                  "type": "integer"
                                },
                                {
                                  "type": "boolean"
                                },
                                {
                                  "type": "number"
                                },
                                {
                                  "type": "object"
                                }
                              ]
                            }
                          },
                          "additionalProperties": false
                        }
                      ],
                      "not": {
                        "anyOf": [
                          {
                            "required": [
                              "severity"
                            ]
                          },
                          {
                            "required": [
                              "action"
                            ]
                          },
                          {
                            "required": [
                              "username"
                            ]
                          },
                          {
                            "required": [
                              "phone_numbers"
                            ]
                          }
                        ]
                      },
                      "required": [
                        "type",
                        "id"
                      ]
                    },
                    {
                      "properties": {
                        "type": {
                          "type": "string",
                          "description": "The value of this property MUST be `domain-name`.",
                          "enum": [
                            "domain-name"
                          ]
                        },
                        "id": {
                          "title": "id",
                          "pattern": "^domain-name--"
                        },
                        "value": {
                          "type": "string",
                          "description": "Specifies the value of the domain name.",
                          "format": "idn-hostname"
                        },
                        "resolves_to_refs": {
                          "type": "array",
                          "description": "Specifies a list of references to one or more IP addresses or domain names that the domain name resolves to.",
                          "items": {
                            "type": "string"
                          },
                          "minItems": 1
                        }
                      },
                      "required": [
                        "value"
                      ]
                    }
                  ]
                },
                {
                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/observables/email-addr.json",
                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                  "title": "email-addr",
                  "description": "The Email Address Object represents a single email address.",
                  "type": "object",
                  "allOf": [
                    {
                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/cyber-observable-core.json",
                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                      "title": "cyber-observable-core",
                      "description": "Common properties and behavior across all Cyber Observable Objects.",
                      "type": "object",
                      "properties": {
                        "type": {
                          "type": "string",
                          "pattern": "^([a-z][a-z0-9]*)+(-[a-z0-9]+)*\\-?$",
                          "minLength": 3,
                          "maxLength": 250,
                          "description": "Indicates that this object is an Observable Object. The value of this property MUST be a valid Observable Object type name, but to allow for custom objects this has been removed from the schema.",
                          "not": {
                            "enum": [
                              "action"
                            ]
                          }
                        },
                        "spec_version": {
                          "type": "string",
                          "enum": [
                            "2.0",
                            "2.1"
                          ],
                          "description": "The version of the STIX specification used to represent the content in this cyber-observable."
                        },
                        "object_marking_refs": {
                          "type": "array",
                          "description": "The list of marking-definition objects to be applied to this object.",
                          "items": {
                            "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/identifier.json",
                            "$schema": "http://json-schema.org/draft/2020-12/schema#",
                            "title": "identifier",
                            "description": "Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.",
                            "type": "string",
                            "pattern": "^[a-z][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
                          },
                          "minItems": 1
                        },
                        "granular_markings": {
                          "type": "array",
                          "description": "The set of granular markings that apply to this object.",
                          "items": {
                            "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/granular-marking.json",
                            "$schema": "http://json-schema.org/draft/2020-12/schema#",
                            "title": "granular-marking",
                            "description": "The granular-marking type defines how the list of marking-definition objects referenced by the marking_refs property to apply to a set of content identified by the list of selectors in the selectors property.",
                            "type": "object",
                            "properties": {
                              "selectors": {
                                "type": "array",
                                "description": "A list of selectors for content contained within the STIX object in which this property appears.",
                                "items": {
                                  "type": "string",
                                  "pattern": "^([a-z0-9_-]{3,249}(\\.(\\[\\d+\\]|[a-z0-9_-]{1,250}))*|id)$"
                                },
                                "minItems": 1
                              },
                              "lang": {
                                "type": "string",
                                "description": "Identifies the language of the text identified by this marking."
                              },
                              "marking_ref": {
                                "allOf": [
                                  {
                                    "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/identifier.json",
                                    "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                    "title": "identifier",
                                    "description": "Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.",
                                    "type": "string",
                                    "pattern": "^[a-z][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
                                  },
                                  {
                                    "pattern": "^marking-definition--",
                                    "description": "The marking_ref property specifies the ID of the marking-definition object that describes the marking."
                                  }
                                ]
                              }
                            },
                            "required": [
                              "selectors",
                              "marking_ref"
                            ]
                          },
                          "minItems": 1
                        },
                        "defanged": {
                          "type": "boolean",
                          "description": "Defines whether or not the data contained within the object has been defanged."
                        },
                        "id": {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/identifier.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "identifier",
                          "description": "Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.",
                          "type": "string",
                          "pattern": "^[a-z][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
                        },
                        "extensions": {
                          "description": "Specifies any extensions of the object, as a dictionary.",
                          "type": "object",
                          "minProperties": 1,
                          "patternProperties": {
                            "^([a-z][a-z0-9]*)+(-[a-z0-9]+)*\\-ext$": {
                              "type": "object",
                              "minProperties": 1,
                              "allOf": [
                                {
                                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/properties.json",
                                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                  "title": "properties",
                                  "description": "Rules for custom properties",
                                  "patternProperties": {
                                    "^[a-z][a-z0-9_]{0,245}_bin$": {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/binary.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "binary",
                                      "description": "The ​binary data type represents a sequence of bytes. In order to allow pattern matching on custom objects, for all properties that use the binary type, the property name MUST end with '_bin'. The JSON MTI serialization represents this as a base64-­encoded string as specified in RFC4648​. Other serializations SHOULD use a native binary type, if available.",
                                      "type": "string",
                                      "pattern": "^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$"
                                    },
                                    "^[a-z][a-z0-9_]{0,245}_hex$": {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "hex",
                                      "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                                      "type": "string",
                                      "pattern": "^([a-fA-F0-9]{2})+$"
                                    },
                                    "^([a-z][a-z0-9_]{2,249})|id$": {
                                      "anyOf": [
                                        {
                                          "type": "array",
                                          "minItems": 1
                                        },
                                        {
                                          "type": "string"
                                        },
                                        {
                                          "type": "integer"
                                        },
                                        {
                                          "type": "boolean"
                                        },
                                        {
                                          "type": "number"
                                        },
                                        {
                                          "type": "object"
                                        }
                                      ]
                                    }
                                  },
                                  "additionalProperties": false
                                }
                              ]
                            },
                            "^extension-definition--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$": {
                              "allOf": [
                                {
                                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/extension.json",
                                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                  "type": "object",
                                  "minProperties": 1,
                                  "properties": {
                                    "extension_type": {
                                      "description": "The type of extension.",
                                      "type": "string",
                                      "enum": [
                                        "new-sdo",
                                        "new-sco",
                                        "new-sro",
                                        "property-extension",
                                        "toplevel-property-extension"
                                      ]
                                    }
                                  },
                                  "allOf": [
                                    {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/properties.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "properties",
                                      "description": "Rules for custom properties",
                                      "patternProperties": {
                                        "^[a-z][a-z0-9_]{0,245}_bin$": {
                                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/binary.json",
                                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                          "title": "binary",
                                          "description": "The ​binary data type represents a sequence of bytes. In order to allow pattern matching on custom objects, for all properties that use the binary type, the property name MUST end with '_bin'. The JSON MTI serialization represents this as a base64-­encoded string as specified in RFC4648​. Other serializations SHOULD use a native binary type, if available.",
                                          "type": "string",
                                          "pattern": "^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$"
                                        },
                                        "^[a-z][a-z0-9_]{0,245}_hex$": {
                                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                          "title": "hex",
                                          "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                                          "type": "string",
                                          "pattern": "^([a-fA-F0-9]{2})+$"
                                        },
                                        "^([a-z][a-z0-9_]{2,249})|id$": {
                                          "anyOf": [
                                            {
                                              "type": "array",
                                              "minItems": 1
                                            },
                                            {
                                              "type": "string"
                                            },
                                            {
                                              "type": "integer"
                                            },
                                            {
                                              "type": "boolean"
                                            },
                                            {
                                              "type": "number"
                                            },
                                            {
                                              "type": "object"
                                            }
                                          ]
                                        }
                                      },
                                      "additionalProperties": false
                                    }
                                  ],
                                  "required": [
                                    "extension_type"
                                  ],
                                  "definitions": {
                                    "extension-type-enum": {
                                      "type": "string",
                                      "enum": [
                                        "new-sdo",
                                        "new-sco",
                                        "new-sro",
                                        "property-extension",
                                        "toplevel-property-extension"
                                      ]
                                    }
                                  }
                                }
                              ]
                            }
                          },
                          "additionalProperties": false
                        }
                      },
                      "allOf": [
                        {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/properties.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "properties",
                          "description": "Rules for custom properties",
                          "patternProperties": {
                            "^[a-z][a-z0-9_]{0,245}_bin$": {
                              "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/binary.json",
                              "$schema": "http://json-schema.org/draft/2020-12/schema#",
                              "title": "binary",
                              "description": "The ​binary data type represents a sequence of bytes. In order to allow pattern matching on custom objects, for all properties that use the binary type, the property name MUST end with '_bin'. The JSON MTI serialization represents this as a base64-­encoded string as specified in RFC4648​. Other serializations SHOULD use a native binary type, if available.",
                              "type": "string",
                              "pattern": "^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$"
                            },
                            "^[a-z][a-z0-9_]{0,245}_hex$": {
                              "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                              "$schema": "http://json-schema.org/draft/2020-12/schema#",
                              "title": "hex",
                              "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                              "type": "string",
                              "pattern": "^([a-fA-F0-9]{2})+$"
                            },
                            "^([a-z][a-z0-9_]{2,249})|id$": {
                              "anyOf": [
                                {
                                  "type": "array",
                                  "minItems": 1
                                },
                                {
                                  "type": "string"
                                },
                                {
                                  "type": "integer"
                                },
                                {
                                  "type": "boolean"
                                },
                                {
                                  "type": "number"
                                },
                                {
                                  "type": "object"
                                }
                              ]
                            }
                          },
                          "additionalProperties": false
                        }
                      ],
                      "not": {
                        "anyOf": [
                          {
                            "required": [
                              "severity"
                            ]
                          },
                          {
                            "required": [
                              "action"
                            ]
                          },
                          {
                            "required": [
                              "username"
                            ]
                          },
                          {
                            "required": [
                              "phone_numbers"
                            ]
                          }
                        ]
                      },
                      "required": [
                        "type",
                        "id"
                      ]
                    },
                    {
                      "properties": {
                        "type": {
                          "type": "string",
                          "description": "The value of this property MUST be `email-addr`.",
                          "enum": [
                            "email-addr"
                          ]
                        },
                        "id": {
                          "title": "id",
                          "pattern": "^email-addr--"
                        },
                        "value": {
                          "type": "string",
                          "format": "email",
                          "description": "Specifies a single email address. This MUST not include the display name."
                        },
                        "display_name": {
                          "type": "string",
                          "description": "Specifies a single email display name, i.e., the name that is displayed to the human user of a mail application."
                        },
                        "belongs_to_ref": {
                          "description": "Specifies the user account that the email address belongs to, as a reference to a User Account Object.",
                          "type": "string"
                        }
                      },
                      "required": [
                        "value"
                      ]
                    }
                  ]
                },
                {
                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/observables/email-message.json",
                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                  "title": "email-message",
                  "description": "The Email Message Object represents an instance of an email message.",
                  "type": "object",
                  "allOf": [
                    {
                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/cyber-observable-core.json",
                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                      "title": "cyber-observable-core",
                      "description": "Common properties and behavior across all Cyber Observable Objects.",
                      "type": "object",
                      "properties": {
                        "type": {
                          "type": "string",
                          "pattern": "^([a-z][a-z0-9]*)+(-[a-z0-9]+)*\\-?$",
                          "minLength": 3,
                          "maxLength": 250,
                          "description": "Indicates that this object is an Observable Object. The value of this property MUST be a valid Observable Object type name, but to allow for custom objects this has been removed from the schema.",
                          "not": {
                            "enum": [
                              "action"
                            ]
                          }
                        },
                        "spec_version": {
                          "type": "string",
                          "enum": [
                            "2.0",
                            "2.1"
                          ],
                          "description": "The version of the STIX specification used to represent the content in this cyber-observable."
                        },
                        "object_marking_refs": {
                          "type": "array",
                          "description": "The list of marking-definition objects to be applied to this object.",
                          "items": {
                            "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/identifier.json",
                            "$schema": "http://json-schema.org/draft/2020-12/schema#",
                            "title": "identifier",
                            "description": "Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.",
                            "type": "string",
                            "pattern": "^[a-z][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
                          },
                          "minItems": 1
                        },
                        "granular_markings": {
                          "type": "array",
                          "description": "The set of granular markings that apply to this object.",
                          "items": {
                            "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/granular-marking.json",
                            "$schema": "http://json-schema.org/draft/2020-12/schema#",
                            "title": "granular-marking",
                            "description": "The granular-marking type defines how the list of marking-definition objects referenced by the marking_refs property to apply to a set of content identified by the list of selectors in the selectors property.",
                            "type": "object",
                            "properties": {
                              "selectors": {
                                "type": "array",
                                "description": "A list of selectors for content contained within the STIX object in which this property appears.",
                                "items": {
                                  "type": "string",
                                  "pattern": "^([a-z0-9_-]{3,249}(\\.(\\[\\d+\\]|[a-z0-9_-]{1,250}))*|id)$"
                                },
                                "minItems": 1
                              },
                              "lang": {
                                "type": "string",
                                "description": "Identifies the language of the text identified by this marking."
                              },
                              "marking_ref": {
                                "allOf": [
                                  {
                                    "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/identifier.json",
                                    "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                    "title": "identifier",
                                    "description": "Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.",
                                    "type": "string",
                                    "pattern": "^[a-z][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
                                  },
                                  {
                                    "pattern": "^marking-definition--",
                                    "description": "The marking_ref property specifies the ID of the marking-definition object that describes the marking."
                                  }
                                ]
                              }
                            },
                            "required": [
                              "selectors",
                              "marking_ref"
                            ]
                          },
                          "minItems": 1
                        },
                        "defanged": {
                          "type": "boolean",
                          "description": "Defines whether or not the data contained within the object has been defanged."
                        },
                        "id": {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/identifier.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "identifier",
                          "description": "Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.",
                          "type": "string",
                          "pattern": "^[a-z][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
                        },
                        "extensions": {
                          "description": "Specifies any extensions of the object, as a dictionary.",
                          "type": "object",
                          "minProperties": 1,
                          "patternProperties": {
                            "^([a-z][a-z0-9]*)+(-[a-z0-9]+)*\\-ext$": {
                              "type": "object",
                              "minProperties": 1,
                              "allOf": [
                                {
                                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/properties.json",
                                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                  "title": "properties",
                                  "description": "Rules for custom properties",
                                  "patternProperties": {
                                    "^[a-z][a-z0-9_]{0,245}_bin$": {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/binary.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "binary",
                                      "description": "The ​binary data type represents a sequence of bytes. In order to allow pattern matching on custom objects, for all properties that use the binary type, the property name MUST end with '_bin'. The JSON MTI serialization represents this as a base64-­encoded string as specified in RFC4648​. Other serializations SHOULD use a native binary type, if available.",
                                      "type": "string",
                                      "pattern": "^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$"
                                    },
                                    "^[a-z][a-z0-9_]{0,245}_hex$": {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "hex",
                                      "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                                      "type": "string",
                                      "pattern": "^([a-fA-F0-9]{2})+$"
                                    },
                                    "^([a-z][a-z0-9_]{2,249})|id$": {
                                      "anyOf": [
                                        {
                                          "type": "array",
                                          "minItems": 1
                                        },
                                        {
                                          "type": "string"
                                        },
                                        {
                                          "type": "integer"
                                        },
                                        {
                                          "type": "boolean"
                                        },
                                        {
                                          "type": "number"
                                        },
                                        {
                                          "type": "object"
                                        }
                                      ]
                                    }
                                  },
                                  "additionalProperties": false
                                }
                              ]
                            },
                            "^extension-definition--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$": {
                              "allOf": [
                                {
                                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/extension.json",
                                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                  "type": "object",
                                  "minProperties": 1,
                                  "properties": {
                                    "extension_type": {
                                      "description": "The type of extension.",
                                      "type": "string",
                                      "enum": [
                                        "new-sdo",
                                        "new-sco",
                                        "new-sro",
                                        "property-extension",
                                        "toplevel-property-extension"
                                      ]
                                    }
                                  },
                                  "allOf": [
                                    {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/properties.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "properties",
                                      "description": "Rules for custom properties",
                                      "patternProperties": {
                                        "^[a-z][a-z0-9_]{0,245}_bin$": {
                                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/binary.json",
                                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                          "title": "binary",
                                          "description": "The ​binary data type represents a sequence of bytes. In order to allow pattern matching on custom objects, for all properties that use the binary type, the property name MUST end with '_bin'. The JSON MTI serialization represents this as a base64-­encoded string as specified in RFC4648​. Other serializations SHOULD use a native binary type, if available.",
                                          "type": "string",
                                          "pattern": "^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$"
                                        },
                                        "^[a-z][a-z0-9_]{0,245}_hex$": {
                                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                          "title": "hex",
                                          "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                                          "type": "string",
                                          "pattern": "^([a-fA-F0-9]{2})+$"
                                        },
                                        "^([a-z][a-z0-9_]{2,249})|id$": {
                                          "anyOf": [
                                            {
                                              "type": "array",
                                              "minItems": 1
                                            },
                                            {
                                              "type": "string"
                                            },
                                            {
                                              "type": "integer"
                                            },
                                            {
                                              "type": "boolean"
                                            },
                                            {
                                              "type": "number"
                                            },
                                            {
                                              "type": "object"
                                            }
                                          ]
                                        }
                                      },
                                      "additionalProperties": false
                                    }
                                  ],
                                  "required": [
                                    "extension_type"
                                  ],
                                  "definitions": {
                                    "extension-type-enum": {
                                      "type": "string",
                                      "enum": [
                                        "new-sdo",
                                        "new-sco",
                                        "new-sro",
                                        "property-extension",
                                        "toplevel-property-extension"
                                      ]
                                    }
                                  }
                                }
                              ]
                            }
                          },
                          "additionalProperties": false
                        }
                      },
                      "allOf": [
                        {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/properties.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "properties",
                          "description": "Rules for custom properties",
                          "patternProperties": {
                            "^[a-z][a-z0-9_]{0,245}_bin$": {
                              "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/binary.json",
                              "$schema": "http://json-schema.org/draft/2020-12/schema#",
                              "title": "binary",
                              "description": "The ​binary data type represents a sequence of bytes. In order to allow pattern matching on custom objects, for all properties that use the binary type, the property name MUST end with '_bin'. The JSON MTI serialization represents this as a base64-­encoded string as specified in RFC4648​. Other serializations SHOULD use a native binary type, if available.",
                              "type": "string",
                              "pattern": "^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$"
                            },
                            "^[a-z][a-z0-9_]{0,245}_hex$": {
                              "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                              "$schema": "http://json-schema.org/draft/2020-12/schema#",
                              "title": "hex",
                              "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                              "type": "string",
                              "pattern": "^([a-fA-F0-9]{2})+$"
                            },
                            "^([a-z][a-z0-9_]{2,249})|id$": {
                              "anyOf": [
                                {
                                  "type": "array",
                                  "minItems": 1
                                },
                                {
                                  "type": "string"
                                },
                                {
                                  "type": "integer"
                                },
                                {
                                  "type": "boolean"
                                },
                                {
                                  "type": "number"
                                },
                                {
                                  "type": "object"
                                }
                              ]
                            }
                          },
                          "additionalProperties": false
                        }
                      ],
                      "not": {
                        "anyOf": [
                          {
                            "required": [
                              "severity"
                            ]
                          },
                          {
                            "required": [
                              "action"
                            ]
                          },
                          {
                            "required": [
                              "username"
                            ]
                          },
                          {
                            "required": [
                              "phone_numbers"
                            ]
                          }
                        ]
                      },
                      "required": [
                        "type",
                        "id"
                      ]
                    },
                    {
                      "properties": {
                        "type": {
                          "type": "string",
                          "description": "The value of this property MUST be `email-message`.",
                          "enum": [
                            "email-message"
                          ]
                        },
                        "id": {
                          "title": "id",
                          "pattern": "^email-message--"
                        },
                        "date": {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/timestamp.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "timestamp",
                          "description": "Represents timestamps across the CTI specifications. The format is an RFC3339 timestamp, with a required timezone specification of 'Z'.",
                          "type": "string",
                          "pattern": "^[0-9]{4}-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])T([01][0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9]|60)(\\.[0-9]+)?Z$"
                        },
                        "content_type": {
                          "type": "string",
                          "description": "Specifies the value of the 'Content-Type' header of the email message."
                        },
                        "from_ref": {
                          "description": "Specifies the value of the 'From:' header of the email message.",
                          "type": "string"
                        },
                        "sender_ref": {
                          "description": "Specifies the value of the 'From' field of the email message.",
                          "type": "string"
                        },
                        "to_refs": {
                          "type": "array",
                          "description": "Specifies the mailboxes that are 'To:' recipients of the email message.",
                          "items": {
                            "type": "string"
                          },
                          "minItems": 1
                        },
                        "cc_refs": {
                          "type": "array",
                          "description": "Specifies the mailboxes that are 'CC:' recipients of the email message.",
                          "items": {
                            "type": "string"
                          },
                          "minItems": 1
                        },
                        "bcc_refs": {
                          "type": "array",
                          "description": "Specifies the mailboxes that are 'BCC:' recipients of the email message.",
                          "items": {
                            "type": "string"
                          },
                          "minItems": 1
                        },
                        "message_id": {
                          "type": "string",
                          "description": "Specifies the Message-ID field of the email message."
                        },
                        "subject": {
                          "type": "string",
                          "description": "Specifies the subject of the email message."
                        },
                        "received_lines": {
                          "type": "array",
                          "description": "Specifies one or more Received header fields that may be included in the email headers.",
                          "items": {
                            "type": "string"
                          }
                        },
                        "additional_header_fields": {
                          "description": "Specifies any other header fields found in the email message, as a dictionary.",
                          "allOf": [
                            {
                              "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/dictionary.json",
                              "$schema": "http://json-schema.org/draft/2020-12/schema#",
                              "title": "dictionary",
                              "description": "A dictionary captures a set of key/value pairs",
                              "type": "object",
                              "minProperties": 1,
                              "patternProperties": {
                                "^[a-zA-Z0-9_-]{0,250}$": {
                                  "anyOf": [
                                    {
                                      "type": "array",
                                      "minItems": 1
                                    },
                                    {
                                      "type": "string"
                                    },
                                    {
                                      "type": "integer"
                                    },
                                    {
                                      "type": "boolean"
                                    },
                                    {
                                      "type": "number"
                                    },
                                    {
                                      "type": "object"
                                    }
                                  ]
                                }
                              },
                              "additionalProperties": false
                            }
                          ],
                          "not": {
                            "patternProperties": {
                              "^date|received_lines|content_type|from_ref|sender_ref|to_refs|cc_refs|bcc_refs|subject$": {
                                "description": "Invalid additional header field types"
                              }
                            },
                            "additionalProperties": false
                          },
                          "patternProperties": {
                            "^[a-zA-Z0-9_-]{0,250}$": {
                              "oneOf": [
                                {
                                  "type": "array",
                                  "items": {
                                    "type": "string"
                                  },
                                  "minItems": 2
                                },
                                {
                                  "type": "string"
                                }
                              ]
                            }
                          }
                        },
                        "raw_email_ref": {
                          "description": "Specifies the raw binary contents of the email message, including both the headers and body, as a reference to an Artifact Object.",
                          "type": "string"
                        }
                      }
                    }
                  ],
                  "oneOf": [
                    {
                      "properties": {
                        "is_multipart": {
                          "type": "boolean",
                          "enum": [
                            false
                          ],
                          "description": "Indicates whether the email body contains multiple MIME parts."
                        },
                        "body": {
                          "type": "string",
                          "description": "Specifies a string containing the email body. This field MAY only be used if is_multipart is false."
                        }
                      },
                      "required": [
                        "is_multipart"
                      ],
                      "not": {
                        "required": [
                          "body_multipart"
                        ]
                      }
                    },
                    {
                      "properties": {
                        "is_multipart": {
                          "type": "boolean",
                          "enum": [
                            true
                          ],
                          "description": "Indicates whether the email body contains multiple MIME parts."
                        },
                        "body_multipart": {
                          "type": "array",
                          "description": "Specifies a list of the MIME parts that make up the email body. This property MAY only be used if is_multipart is true.",
                          "items": {
                            "type": "object",
                            "description": "Specifies a component of a multi-part email body.",
                            "properties": {
                              "body": {
                                "type": "string",
                                "description": "Specifies the contents of the MIME part if the content_type is not provided OR starts with text/"
                              },
                              "body_raw_ref": {
                                "type": "string",
                                "description": "Specifies the contents of non-textual MIME parts, that is those whose content_type does not start with text/, as a reference to an Artifact Object or File Object."
                              },
                              "content_type": {
                                "type": "string",
                                "description": "Specifies the value of the 'Content-Type' header field of the MIME part."
                              },
                              "content_disposition": {
                                "type": "string",
                                "description": "Specifies the value of the 'Content-Disposition' header field of the MIME part."
                              }
                            },
                            "oneOf": [
                              {
                                "required": [
                                  "body"
                                ]
                              },
                              {
                                "required": [
                                  "body_raw_ref"
                                ]
                              }
                            ]
                          }
                        }
                      },
                      "required": [
                        "is_multipart"
                      ],
                      "not": {
                        "required": [
                          "body"
                        ]
                      }
                    }
                  ],
                  "definitions": {
                    "mime-part-type": {
                      "type": "object",
                      "description": "Specifies a component of a multi-part email body.",
                      "properties": {
                        "body": {
                          "type": "string",
                          "description": "Specifies the contents of the MIME part if the content_type is not provided OR starts with text/"
                        },
                        "body_raw_ref": {
                          "type": "string",
                          "description": "Specifies the contents of non-textual MIME parts, that is those whose content_type does not start with text/, as a reference to an Artifact Object or File Object."
                        },
                        "content_type": {
                          "type": "string",
                          "description": "Specifies the value of the 'Content-Type' header field of the MIME part."
                        },
                        "content_disposition": {
                          "type": "string",
                          "description": "Specifies the value of the 'Content-Disposition' header field of the MIME part."
                        }
                      },
                      "oneOf": [
                        {
                          "required": [
                            "body"
                          ]
                        },
                        {
                          "required": [
                            "body_raw_ref"
                          ]
                        }
                      ]
                    },
                    "email-additional-header-fields": {
                      "allOf": [
                        {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/dictionary.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "dictionary",
                          "description": "A dictionary captures a set of key/value pairs",
                          "type": "object",
                          "minProperties": 1,
                          "patternProperties": {
                            "^[a-zA-Z0-9_-]{0,250}$": {
                              "anyOf": [
                                {
                                  "type": "array",
                                  "minItems": 1
                                },
                                {
                                  "type": "string"
                                },
                                {
                                  "type": "integer"
                                },
                                {
                                  "type": "boolean"
                                },
                                {
                                  "type": "number"
                                },
                                {
                                  "type": "object"
                                }
                              ]
                            }
                          },
                          "additionalProperties": false
                        }
                      ],
                      "description": "Specifies any other header fields (except for date, received_lines, content_type, from_ref, sender_ref, to_refs, cc_refs, bcc_refs, and subject) found in the email message, as a dictionary.",
                      "not": {
                        "patternProperties": {
                          "^date|received_lines|content_type|from_ref|sender_ref|to_refs|cc_refs|bcc_refs|subject$": {
                            "description": "Invalid additional header field types"
                          }
                        },
                        "additionalProperties": false
                      },
                      "patternProperties": {
                        "^[a-zA-Z0-9_-]{0,250}$": {
                          "oneOf": [
                            {
                              "type": "array",
                              "items": {
                                "type": "string"
                              },
                              "minItems": 2
                            },
                            {
                              "type": "string"
                            }
                          ]
                        }
                      }
                    }
                  }
                },
                {
                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/observables/file.json",
                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                  "title": "file",
                  "description": "The File Object represents the properties of a file.",
                  "type": "object",
                  "allOf": [
                    {
                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/cyber-observable-core.json",
                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                      "title": "cyber-observable-core",
                      "description": "Common properties and behavior across all Cyber Observable Objects.",
                      "type": "object",
                      "properties": {
                        "type": {
                          "type": "string",
                          "pattern": "^([a-z][a-z0-9]*)+(-[a-z0-9]+)*\\-?$",
                          "minLength": 3,
                          "maxLength": 250,
                          "description": "Indicates that this object is an Observable Object. The value of this property MUST be a valid Observable Object type name, but to allow for custom objects this has been removed from the schema.",
                          "not": {
                            "enum": [
                              "action"
                            ]
                          }
                        },
                        "spec_version": {
                          "type": "string",
                          "enum": [
                            "2.0",
                            "2.1"
                          ],
                          "description": "The version of the STIX specification used to represent the content in this cyber-observable."
                        },
                        "object_marking_refs": {
                          "type": "array",
                          "description": "The list of marking-definition objects to be applied to this object.",
                          "items": {
                            "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/identifier.json",
                            "$schema": "http://json-schema.org/draft/2020-12/schema#",
                            "title": "identifier",
                            "description": "Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.",
                            "type": "string",
                            "pattern": "^[a-z][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
                          },
                          "minItems": 1
                        },
                        "granular_markings": {
                          "type": "array",
                          "description": "The set of granular markings that apply to this object.",
                          "items": {
                            "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/granular-marking.json",
                            "$schema": "http://json-schema.org/draft/2020-12/schema#",
                            "title": "granular-marking",
                            "description": "The granular-marking type defines how the list of marking-definition objects referenced by the marking_refs property to apply to a set of content identified by the list of selectors in the selectors property.",
                            "type": "object",
                            "properties": {
                              "selectors": {
                                "type": "array",
                                "description": "A list of selectors for content contained within the STIX object in which this property appears.",
                                "items": {
                                  "type": "string",
                                  "pattern": "^([a-z0-9_-]{3,249}(\\.(\\[\\d+\\]|[a-z0-9_-]{1,250}))*|id)$"
                                },
                                "minItems": 1
                              },
                              "lang": {
                                "type": "string",
                                "description": "Identifies the language of the text identified by this marking."
                              },
                              "marking_ref": {
                                "allOf": [
                                  {
                                    "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/identifier.json",
                                    "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                    "title": "identifier",
                                    "description": "Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.",
                                    "type": "string",
                                    "pattern": "^[a-z][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
                                  },
                                  {
                                    "pattern": "^marking-definition--",
                                    "description": "The marking_ref property specifies the ID of the marking-definition object that describes the marking."
                                  }
                                ]
                              }
                            },
                            "required": [
                              "selectors",
                              "marking_ref"
                            ]
                          },
                          "minItems": 1
                        },
                        "defanged": {
                          "type": "boolean",
                          "description": "Defines whether or not the data contained within the object has been defanged."
                        },
                        "id": {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/identifier.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "identifier",
                          "description": "Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.",
                          "type": "string",
                          "pattern": "^[a-z][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
                        },
                        "extensions": {
                          "description": "Specifies any extensions of the object, as a dictionary.",
                          "type": "object",
                          "minProperties": 1,
                          "patternProperties": {
                            "^([a-z][a-z0-9]*)+(-[a-z0-9]+)*\\-ext$": {
                              "type": "object",
                              "minProperties": 1,
                              "allOf": [
                                {
                                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/properties.json",
                                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                  "title": "properties",
                                  "description": "Rules for custom properties",
                                  "patternProperties": {
                                    "^[a-z][a-z0-9_]{0,245}_bin$": {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/binary.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "binary",
                                      "description": "The ​binary data type represents a sequence of bytes. In order to allow pattern matching on custom objects, for all properties that use the binary type, the property name MUST end with '_bin'. The JSON MTI serialization represents this as a base64-­encoded string as specified in RFC4648​. Other serializations SHOULD use a native binary type, if available.",
                                      "type": "string",
                                      "pattern": "^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$"
                                    },
                                    "^[a-z][a-z0-9_]{0,245}_hex$": {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "hex",
                                      "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                                      "type": "string",
                                      "pattern": "^([a-fA-F0-9]{2})+$"
                                    },
                                    "^([a-z][a-z0-9_]{2,249})|id$": {
                                      "anyOf": [
                                        {
                                          "type": "array",
                                          "minItems": 1
                                        },
                                        {
                                          "type": "string"
                                        },
                                        {
                                          "type": "integer"
                                        },
                                        {
                                          "type": "boolean"
                                        },
                                        {
                                          "type": "number"
                                        },
                                        {
                                          "type": "object"
                                        }
                                      ]
                                    }
                                  },
                                  "additionalProperties": false
                                }
                              ]
                            },
                            "^extension-definition--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$": {
                              "allOf": [
                                {
                                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/extension.json",
                                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                  "type": "object",
                                  "minProperties": 1,
                                  "properties": {
                                    "extension_type": {
                                      "description": "The type of extension.",
                                      "type": "string",
                                      "enum": [
                                        "new-sdo",
                                        "new-sco",
                                        "new-sro",
                                        "property-extension",
                                        "toplevel-property-extension"
                                      ]
                                    }
                                  },
                                  "allOf": [
                                    {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/properties.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "properties",
                                      "description": "Rules for custom properties",
                                      "patternProperties": {
                                        "^[a-z][a-z0-9_]{0,245}_bin$": {
                                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/binary.json",
                                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                          "title": "binary",
                                          "description": "The ​binary data type represents a sequence of bytes. In order to allow pattern matching on custom objects, for all properties that use the binary type, the property name MUST end with '_bin'. The JSON MTI serialization represents this as a base64-­encoded string as specified in RFC4648​. Other serializations SHOULD use a native binary type, if available.",
                                          "type": "string",
                                          "pattern": "^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$"
                                        },
                                        "^[a-z][a-z0-9_]{0,245}_hex$": {
                                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                          "title": "hex",
                                          "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                                          "type": "string",
                                          "pattern": "^([a-fA-F0-9]{2})+$"
                                        },
                                        "^([a-z][a-z0-9_]{2,249})|id$": {
                                          "anyOf": [
                                            {
                                              "type": "array",
                                              "minItems": 1
                                            },
                                            {
                                              "type": "string"
                                            },
                                            {
                                              "type": "integer"
                                            },
                                            {
                                              "type": "boolean"
                                            },
                                            {
                                              "type": "number"
                                            },
                                            {
                                              "type": "object"
                                            }
                                          ]
                                        }
                                      },
                                      "additionalProperties": false
                                    }
                                  ],
                                  "required": [
                                    "extension_type"
                                  ],
                                  "definitions": {
                                    "extension-type-enum": {
                                      "type": "string",
                                      "enum": [
                                        "new-sdo",
                                        "new-sco",
                                        "new-sro",
                                        "property-extension",
                                        "toplevel-property-extension"
                                      ]
                                    }
                                  }
                                }
                              ]
                            }
                          },
                          "additionalProperties": false
                        }
                      },
                      "allOf": [
                        {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/properties.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "properties",
                          "description": "Rules for custom properties",
                          "patternProperties": {
                            "^[a-z][a-z0-9_]{0,245}_bin$": {
                              "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/binary.json",
                              "$schema": "http://json-schema.org/draft/2020-12/schema#",
                              "title": "binary",
                              "description": "The ​binary data type represents a sequence of bytes. In order to allow pattern matching on custom objects, for all properties that use the binary type, the property name MUST end with '_bin'. The JSON MTI serialization represents this as a base64-­encoded string as specified in RFC4648​. Other serializations SHOULD use a native binary type, if available.",
                              "type": "string",
                              "pattern": "^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$"
                            },
                            "^[a-z][a-z0-9_]{0,245}_hex$": {
                              "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                              "$schema": "http://json-schema.org/draft/2020-12/schema#",
                              "title": "hex",
                              "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                              "type": "string",
                              "pattern": "^([a-fA-F0-9]{2})+$"
                            },
                            "^([a-z][a-z0-9_]{2,249})|id$": {
                              "anyOf": [
                                {
                                  "type": "array",
                                  "minItems": 1
                                },
                                {
                                  "type": "string"
                                },
                                {
                                  "type": "integer"
                                },
                                {
                                  "type": "boolean"
                                },
                                {
                                  "type": "number"
                                },
                                {
                                  "type": "object"
                                }
                              ]
                            }
                          },
                          "additionalProperties": false
                        }
                      ],
                      "not": {
                        "anyOf": [
                          {
                            "required": [
                              "severity"
                            ]
                          },
                          {
                            "required": [
                              "action"
                            ]
                          },
                          {
                            "required": [
                              "username"
                            ]
                          },
                          {
                            "required": [
                              "phone_numbers"
                            ]
                          }
                        ]
                      },
                      "required": [
                        "type",
                        "id"
                      ]
                    },
                    {
                      "properties": {
                        "type": {
                          "type": "string",
                          "description": "The value of this property MUST be `file`.",
                          "enum": [
                            "file"
                          ]
                        },
                        "id": {
                          "title": "id",
                          "pattern": "^file--"
                        },
                        "extensions": {
                          "description": "The File Object defines the following extensions. In addition to these, producers MAY create their own. Extensions: ntfs-ext, raster-image-ext, pdf-ext, archive-ext, windows-pebinary-ext",
                          "allOf": [
                            {
                              "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/dictionary.json",
                              "$schema": "http://json-schema.org/draft/2020-12/schema#",
                              "title": "dictionary",
                              "description": "A dictionary captures a set of key/value pairs",
                              "type": "object",
                              "minProperties": 1,
                              "patternProperties": {
                                "^[a-zA-Z0-9_-]{0,250}$": {
                                  "anyOf": [
                                    {
                                      "type": "array",
                                      "minItems": 1
                                    },
                                    {
                                      "type": "string"
                                    },
                                    {
                                      "type": "integer"
                                    },
                                    {
                                      "type": "boolean"
                                    },
                                    {
                                      "type": "number"
                                    },
                                    {
                                      "type": "object"
                                    }
                                  ]
                                }
                              },
                              "additionalProperties": false
                            }
                          ],
                          "patternProperties": {
                            "^ntfs-ext$": {
                              "type": "object",
                              "description": "The NTFS file extension specifies a default extension for capturing properties specific to the storage of the file on the NTFS file system.",
                              "allOf": [
                                {
                                  "properties": {
                                    "sid": {
                                      "type": "string",
                                      "description": "Specifies the security ID (SID) value assigned to the file."
                                    },
                                    "alternate_data_streams": {
                                      "type": "array",
                                      "description": "Specifies a list of NTFS alternate data streams that exist for the file.",
                                      "items": {
                                        "properties": {
                                          "name": {
                                            "type": "string",
                                            "description": "Specifies the name of the alternate data stream."
                                          },
                                          "hashes": {
                                            "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hashes-type.json",
                                            "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                            "title": "hashes",
                                            "description": "The Hashes type represents one or more cryptographic hashes, as a special set of key/value pairs",
                                            "type": "object",
                                            "allOf": [
                                              {
                                                "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/dictionary.json",
                                                "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                                "title": "dictionary",
                                                "description": "A dictionary captures a set of key/value pairs",
                                                "type": "object",
                                                "minProperties": 1,
                                                "patternProperties": {
                                                  "^[a-zA-Z0-9_-]{0,250}$": {
                                                    "anyOf": [
                                                      {
                                                        "type": "array",
                                                        "minItems": 1
                                                      },
                                                      {
                                                        "type": "string"
                                                      },
                                                      {
                                                        "type": "integer"
                                                      },
                                                      {
                                                        "type": "boolean"
                                                      },
                                                      {
                                                        "type": "number"
                                                      },
                                                      {
                                                        "type": "object"
                                                      }
                                                    ]
                                                  }
                                                },
                                                "additionalProperties": false
                                              }
                                            ],
                                            "patternProperties": {
                                              "^[a-zA-Z0-9_-]{3,250}$": {
                                                "type": "string",
                                                "description": "Custom hash key"
                                              },
                                              "^MD5$": {
                                                "type": "string",
                                                "description": "Specifies the MD5 message digest algorithm.",
                                                "pattern": "^[a-fA-F0-9]{32}$"
                                              },
                                              "^SHA-1$": {
                                                "type": "string",
                                                "description": "Specifies the SHA-1 (secure-hash algorithm 1) cryptographic hash function.",
                                                "pattern": "^[a-fA-F0-9]{40}$"
                                              },
                                              "^SHA-256$": {
                                                "type": "string",
                                                "description": "Specifies the SHA-256 cryptographic hash function (part of the SHA2 family).",
                                                "pattern": "^[a-fA-F0-9]{64}$"
                                              },
                                              "^SHA-512$": {
                                                "type": "string",
                                                "description": "Specifies the SHA-512 cryptographic hash function (part of the SHA2 family).",
                                                "pattern": "^[a-fA-F0-9]{128}$"
                                              },
                                              "^SHA3-256$": {
                                                "type": "string",
                                                "description": "Specifies the SHA3-256 cryptographic hash function.",
                                                "pattern": "^[a-fA-F0-9]{64}$"
                                              },
                                              "^SHA3-512$": {
                                                "type": "string",
                                                "description": "Specifies the SHA3-512 cryptographic hash function.",
                                                "pattern": "^[a-fA-F0-9]{128}$"
                                              },
                                              "^SSDEEP$": {
                                                "type": "string",
                                                "description": "Specifies the ssdeep fuzzy hashing algorithm.",
                                                "pattern": "^[a-zA-Z0-9/+:.]{1,128}$"
                                              },
                                              "^TLSH$": {
                                                "type": "string",
                                                "description": "Specifies the TLSH locality-sensitive hashing algorithm.",
                                                "pattern": "^[a-zA-Z0-9]{70}$"
                                              }
                                            },
                                            "additionalProperties": false
                                          },
                                          "size": {
                                            "type": "integer",
                                            "description": "Specifies the size of the alternate data stream, in bytes, as a non-negative integer.",
                                            "minimum": 0
                                          }
                                        },
                                        "required": [
                                          "name"
                                        ]
                                      }
                                    }
                                  }
                                },
                                {
                                  "anyOf": [
                                    {
                                      "required": [
                                        "sid"
                                      ]
                                    },
                                    {
                                      "required": [
                                        "alternate_data_streams"
                                      ]
                                    }
                                  ]
                                }
                              ]
                            },
                            "^raster-image-ext$": {
                              "type": "object",
                              "description": "The Raster Image file extension specifies a default extension for capturing properties specific to image files.",
                              "allOf": [
                                {
                                  "properties": {
                                    "image_height": {
                                      "type": "integer",
                                      "description": "Specifies the height of the image in the image file, in pixels."
                                    },
                                    "image_width": {
                                      "type": "integer",
                                      "description": "Specifies the width of the image in the image file, in pixels."
                                    },
                                    "bits_per_pixel": {
                                      "type": "integer",
                                      "description": "Specifies the sum of bits used for each color channel in the image in the image file, and thus the total number of pixels used for expressing the color depth of the image."
                                    },
                                    "exif_tags": {
                                      "allOf": [
                                        {
                                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/dictionary.json",
                                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                          "title": "dictionary",
                                          "description": "A dictionary captures a set of key/value pairs",
                                          "type": "object",
                                          "minProperties": 1,
                                          "patternProperties": {
                                            "^[a-zA-Z0-9_-]{0,250}$": {
                                              "anyOf": [
                                                {
                                                  "type": "array",
                                                  "minItems": 1
                                                },
                                                {
                                                  "type": "string"
                                                },
                                                {
                                                  "type": "integer"
                                                },
                                                {
                                                  "type": "boolean"
                                                },
                                                {
                                                  "type": "number"
                                                },
                                                {
                                                  "type": "object"
                                                }
                                              ]
                                            }
                                          },
                                          "additionalProperties": false
                                        }
                                      ],
                                      "description": "Specifies the set of EXIF tags found in the image file, as a dictionary. Each key/value pair in the dictionary represents the name/value of a single EXIF tag.",
                                      "patternProperties": {
                                        "^[A-Z][a-zA-Z0-9_-]+$": {
                                          "oneOf": [
                                            {
                                              "type": "string"
                                            },
                                            {
                                              "type": "integer"
                                            }
                                          ]
                                        }
                                      },
                                      "additionalProperties": false
                                    }
                                  }
                                },
                                {
                                  "anyOf": [
                                    {
                                      "required": [
                                        "image_height"
                                      ]
                                    },
                                    {
                                      "required": [
                                        "image_width"
                                      ]
                                    },
                                    {
                                      "required": [
                                        "bits_per_pixel"
                                      ]
                                    },
                                    {
                                      "required": [
                                        "image_compression_algorithm"
                                      ]
                                    },
                                    {
                                      "required": [
                                        "exif_tags"
                                      ]
                                    }
                                  ]
                                }
                              ]
                            },
                            "^pdf-ext$": {
                              "type": "object",
                              "description": "The PDF file extension specifies a default extension for capturing properties specific to PDF files.",
                              "allOf": [
                                {
                                  "properties": {
                                    "version": {
                                      "type": "string",
                                      "description": "Specifies the decimal version number of the string from the PDF header that specifies the version of the PDF specification to which the PDF file conforms. E.g., '1.4'."
                                    },
                                    "is_optimized": {
                                      "type": "boolean",
                                      "description": "Specifies whether the PDF file has been optimized."
                                    },
                                    "document_info_dict": {
                                      "allOf": [
                                        {
                                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/dictionary.json",
                                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                          "title": "dictionary",
                                          "description": "A dictionary captures a set of key/value pairs",
                                          "type": "object",
                                          "minProperties": 1,
                                          "patternProperties": {
                                            "^[a-zA-Z0-9_-]{0,250}$": {
                                              "anyOf": [
                                                {
                                                  "type": "array",
                                                  "minItems": 1
                                                },
                                                {
                                                  "type": "string"
                                                },
                                                {
                                                  "type": "integer"
                                                },
                                                {
                                                  "type": "boolean"
                                                },
                                                {
                                                  "type": "number"
                                                },
                                                {
                                                  "type": "object"
                                                }
                                              ]
                                            }
                                          },
                                          "additionalProperties": false
                                        }
                                      ],
                                      "patternProperties": {
                                        "^[a-zA-Z0-9_-]{0,250}$": {
                                          "type": "string"
                                        }
                                      },
                                      "description": "Specifies details of the PDF document information dictionary (DID), which includes properties like the document creation data and producer, as a dictionary."
                                    },
                                    "pdfid0": {
                                      "type": "string",
                                      "description": "Specifies the first file identifier found for the PDF file."
                                    },
                                    "pdfid1": {
                                      "type": "string",
                                      "description": "Specifies the second file identifier found for the PDF file."
                                    }
                                  }
                                },
                                {
                                  "anyOf": [
                                    {
                                      "required": [
                                        "version"
                                      ]
                                    },
                                    {
                                      "required": [
                                        "is_optimized"
                                      ]
                                    },
                                    {
                                      "required": [
                                        "document_info_dict"
                                      ]
                                    },
                                    {
                                      "required": [
                                        "pdfid0"
                                      ]
                                    },
                                    {
                                      "required": [
                                        "pdfid1"
                                      ]
                                    }
                                  ]
                                }
                              ]
                            },
                            "^archive-ext$": {
                              "type": "object",
                              "description": "The Archive File extension specifies a default extension for capturing properties specific to archive files.",
                              "properties": {
                                "contains_refs": {
                                  "type": "array",
                                  "description": "Specifies the files contained in the archive, as a reference to one or more other File Objects. The objects referenced in this list MUST be of type file-object.",
                                  "items": {
                                    "type": "string"
                                  },
                                  "minItems": 1
                                },
                                "comment": {
                                  "type": "string",
                                  "description": "Specifies a comment included as part of the archive file."
                                }
                              },
                              "required": [
                                "contains_refs"
                              ]
                            },
                            "^windows-pebinary-ext$": {
                              "type": "object",
                              "description": "The Windows PE Binary File extension specifies a default extension for capturing properties specific to Windows portable executable (PE) files.",
                              "properties": {
                                "pe_type": {
                                  "type": "string",
                                  "description": "Specifies the type of the PE binary. Open Vocabulary - windows-pebinary-type-ov"
                                },
                                "imphash": {
                                  "type": "string",
                                  "description": "Specifies the special import hash, or 'imphash', calculated for the PE Binary based on its imported libraries and functions."
                                },
                                "machine_hex": {
                                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                  "title": "hex",
                                  "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                                  "type": "string",
                                  "pattern": "^([a-fA-F0-9]{2})+$"
                                },
                                "number_of_sections": {
                                  "type": "integer",
                                  "minimum": 0,
                                  "description": "Specifies the number of sections in the PE binary, as a non-negative integer."
                                },
                                "time_date_stamp": {
                                  "type": "string",
                                  "description": "Specifies the time when the PE binary was created.  The timestamp value MUST BE precise to the second.",
                                  "allOf": [
                                    {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/timestamp.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "timestamp",
                                      "description": "Represents timestamps across the CTI specifications. The format is an RFC3339 timestamp, with a required timezone specification of 'Z'.",
                                      "type": "string",
                                      "pattern": "^[0-9]{4}-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])T([01][0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9]|60)(\\.[0-9]+)?Z$"
                                    },
                                    {
                                      "pattern": "T\\d{2}:\\d{2}:\\d{2}Z$"
                                    }
                                  ]
                                },
                                "pointer_to_symbol_table_hex": {
                                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                  "title": "hex",
                                  "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                                  "type": "string",
                                  "pattern": "^([a-fA-F0-9]{2})+$"
                                },
                                "number_of_symbols": {
                                  "type": "integer",
                                  "minimum": 0,
                                  "description": "Specifies the number of entries in the symbol table of the PE binary, as a non-negative integer."
                                },
                                "size_of_optional_header": {
                                  "type": "integer",
                                  "minimum": 0,
                                  "description": "Specifies the size of the optional header of the PE binary."
                                },
                                "characteristics_hex": {
                                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                  "title": "hex",
                                  "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                                  "type": "string",
                                  "pattern": "^([a-fA-F0-9]{2})+$"
                                },
                                "file_header_hashes": {
                                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hashes-type.json",
                                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                  "title": "hashes",
                                  "description": "The Hashes type represents one or more cryptographic hashes, as a special set of key/value pairs",
                                  "type": "object",
                                  "allOf": [
                                    {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/dictionary.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "dictionary",
                                      "description": "A dictionary captures a set of key/value pairs",
                                      "type": "object",
                                      "minProperties": 1,
                                      "patternProperties": {
                                        "^[a-zA-Z0-9_-]{0,250}$": {
                                          "anyOf": [
                                            {
                                              "type": "array",
                                              "minItems": 1
                                            },
                                            {
                                              "type": "string"
                                            },
                                            {
                                              "type": "integer"
                                            },
                                            {
                                              "type": "boolean"
                                            },
                                            {
                                              "type": "number"
                                            },
                                            {
                                              "type": "object"
                                            }
                                          ]
                                        }
                                      },
                                      "additionalProperties": false
                                    }
                                  ],
                                  "patternProperties": {
                                    "^[a-zA-Z0-9_-]{3,250}$": {
                                      "type": "string",
                                      "description": "Custom hash key"
                                    },
                                    "^MD5$": {
                                      "type": "string",
                                      "description": "Specifies the MD5 message digest algorithm.",
                                      "pattern": "^[a-fA-F0-9]{32}$"
                                    },
                                    "^SHA-1$": {
                                      "type": "string",
                                      "description": "Specifies the SHA-1 (secure-hash algorithm 1) cryptographic hash function.",
                                      "pattern": "^[a-fA-F0-9]{40}$"
                                    },
                                    "^SHA-256$": {
                                      "type": "string",
                                      "description": "Specifies the SHA-256 cryptographic hash function (part of the SHA2 family).",
                                      "pattern": "^[a-fA-F0-9]{64}$"
                                    },
                                    "^SHA-512$": {
                                      "type": "string",
                                      "description": "Specifies the SHA-512 cryptographic hash function (part of the SHA2 family).",
                                      "pattern": "^[a-fA-F0-9]{128}$"
                                    },
                                    "^SHA3-256$": {
                                      "type": "string",
                                      "description": "Specifies the SHA3-256 cryptographic hash function.",
                                      "pattern": "^[a-fA-F0-9]{64}$"
                                    },
                                    "^SHA3-512$": {
                                      "type": "string",
                                      "description": "Specifies the SHA3-512 cryptographic hash function.",
                                      "pattern": "^[a-fA-F0-9]{128}$"
                                    },
                                    "^SSDEEP$": {
                                      "type": "string",
                                      "description": "Specifies the ssdeep fuzzy hashing algorithm.",
                                      "pattern": "^[a-zA-Z0-9/+:.]{1,128}$"
                                    },
                                    "^TLSH$": {
                                      "type": "string",
                                      "description": "Specifies the TLSH locality-sensitive hashing algorithm.",
                                      "pattern": "^[a-zA-Z0-9]{70}$"
                                    }
                                  },
                                  "additionalProperties": false
                                },
                                "optional_header": {
                                  "description": "Specifies the PE optional header of the PE binary.",
                                  "type": "object",
                                  "minProperties": 1,
                                  "additionalProperties": false,
                                  "properties": {
                                    "magic_hex": {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "hex",
                                      "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                                      "type": "string",
                                      "pattern": "^([a-fA-F0-9]{2})+$"
                                    },
                                    "major_linker_version": {
                                      "type": "integer",
                                      "description": "Specifies the linker major version number."
                                    },
                                    "minor_linker_version": {
                                      "type": "integer",
                                      "description": "Specifies the linker minor version number."
                                    },
                                    "size_of_code": {
                                      "type": "integer",
                                      "minimum": 0,
                                      "description": "Specifies the size of the code (text) section. If there are multiple such sections, this refers to the sum of the sizes of each section."
                                    },
                                    "size_of_initialized_data": {
                                      "type": "integer",
                                      "minimum": 0,
                                      "description": "Specifies the size of the initialized data section. If there are multiple such sections, this refers to the sum of the sizes of each section."
                                    },
                                    "size_of_uninitialized_data": {
                                      "type": "integer",
                                      "minimum": 0,
                                      "description": "Specifies the size of the uninitialized data section. If there are multiple such sections, this refers to the sum of the sizes of each section."
                                    },
                                    "address_of_entry_point": {
                                      "type": "integer",
                                      "description": "Specifies the address of the entry point relative to the image base when the executable is loaded into memory."
                                    },
                                    "base_of_code": {
                                      "type": "integer",
                                      "description": "Specifies the address that is relative to the image base of the beginning-of-code section when it is loaded into memory."
                                    },
                                    "base_of_data": {
                                      "type": "integer",
                                      "description": "Specifies the address that is relative to the image base of the beginning-of-data section when it is loaded into memory."
                                    },
                                    "image_base": {
                                      "type": "integer",
                                      "description": "Specifies the preferred address of the first byte of the image when loaded into memory."
                                    },
                                    "section_alignment": {
                                      "type": "integer",
                                      "description": "Specifies the alignment (in bytes) of PE sections when they are loaded into memory."
                                    },
                                    "file_alignment": {
                                      "type": "integer",
                                      "description": "Specifies the factor (in bytes) that is used to align the raw data of sections in the image file."
                                    },
                                    "major_os_version": {
                                      "type": "integer",
                                      "description": "Specifies the major version number of the required operating system."
                                    },
                                    "minor_os_version": {
                                      "type": "integer",
                                      "description": "Specifies the minor version number of the required operating system."
                                    },
                                    "major_image_version": {
                                      "type": "integer",
                                      "description": "Specifies the major version number of the image."
                                    },
                                    "minor_image_version": {
                                      "type": "integer",
                                      "description": "Specifies the minor version number of the image."
                                    },
                                    "major_subsystem_version": {
                                      "type": "integer",
                                      "description": "Specifies the major version number of the subsystem."
                                    },
                                    "minor_subsystem_version": {
                                      "type": "integer",
                                      "description": "Specifies the minor version number of the subsystem."
                                    },
                                    "win32_version_value_hex": {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "hex",
                                      "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                                      "type": "string",
                                      "pattern": "^([a-fA-F0-9]{2})+$"
                                    },
                                    "size_of_image": {
                                      "type": "integer",
                                      "minimum": 0,
                                      "description": "Specifies the size, in bytes, of the image, including all headers, as the image is loaded in memory."
                                    },
                                    "size_of_headers": {
                                      "type": "integer",
                                      "minimum": 0,
                                      "description": "Specifies the combined size of the MS-DOS, PE header, and section headers, rounded up a multiple of the value specified in the file_alignment header."
                                    },
                                    "checksum_hex": {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "hex",
                                      "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                                      "type": "string",
                                      "pattern": "^([a-fA-F0-9]{2})+$"
                                    },
                                    "subsystem_hex": {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "hex",
                                      "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                                      "type": "string",
                                      "pattern": "^([a-fA-F0-9]{2})+$"
                                    },
                                    "dll_characteristics_hex": {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "hex",
                                      "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                                      "type": "string",
                                      "pattern": "^([a-fA-F0-9]{2})+$"
                                    },
                                    "size_of_stack_reserve": {
                                      "type": "integer",
                                      "minimum": 0,
                                      "description": "Specifies the size of the stack to reserve"
                                    },
                                    "size_of_stack_commit": {
                                      "type": "integer",
                                      "minimum": 0,
                                      "description": "Specifies the size of the stack to commit."
                                    },
                                    "size_of_heap_reserve": {
                                      "type": "integer",
                                      "minimum": 0,
                                      "description": "Specifies the size of the local heap space to reserve."
                                    },
                                    "size_of_heap_commit": {
                                      "type": "integer",
                                      "minimum": 0,
                                      "description": "Specifies the size of the local heap space to commit."
                                    },
                                    "loader_flags_hex": {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "hex",
                                      "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                                      "type": "string",
                                      "pattern": "^([a-fA-F0-9]{2})+$"
                                    },
                                    "number_of_rva_and_sizes": {
                                      "type": "integer",
                                      "description": "Specifies the number of data-directory entries in the remainder of the optional header."
                                    },
                                    "hashes": {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hashes-type.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "hashes",
                                      "description": "The Hashes type represents one or more cryptographic hashes, as a special set of key/value pairs",
                                      "type": "object",
                                      "allOf": [
                                        {
                                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/dictionary.json",
                                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                          "title": "dictionary",
                                          "description": "A dictionary captures a set of key/value pairs",
                                          "type": "object",
                                          "minProperties": 1,
                                          "patternProperties": {
                                            "^[a-zA-Z0-9_-]{0,250}$": {
                                              "anyOf": [
                                                {
                                                  "type": "array",
                                                  "minItems": 1
                                                },
                                                {
                                                  "type": "string"
                                                },
                                                {
                                                  "type": "integer"
                                                },
                                                {
                                                  "type": "boolean"
                                                },
                                                {
                                                  "type": "number"
                                                },
                                                {
                                                  "type": "object"
                                                }
                                              ]
                                            }
                                          },
                                          "additionalProperties": false
                                        }
                                      ],
                                      "patternProperties": {
                                        "^[a-zA-Z0-9_-]{3,250}$": {
                                          "type": "string",
                                          "description": "Custom hash key"
                                        },
                                        "^MD5$": {
                                          "type": "string",
                                          "description": "Specifies the MD5 message digest algorithm.",
                                          "pattern": "^[a-fA-F0-9]{32}$"
                                        },
                                        "^SHA-1$": {
                                          "type": "string",
                                          "description": "Specifies the SHA-1 (secure-hash algorithm 1) cryptographic hash function.",
                                          "pattern": "^[a-fA-F0-9]{40}$"
                                        },
                                        "^SHA-256$": {
                                          "type": "string",
                                          "description": "Specifies the SHA-256 cryptographic hash function (part of the SHA2 family).",
                                          "pattern": "^[a-fA-F0-9]{64}$"
                                        },
                                        "^SHA-512$": {
                                          "type": "string",
                                          "description": "Specifies the SHA-512 cryptographic hash function (part of the SHA2 family).",
                                          "pattern": "^[a-fA-F0-9]{128}$"
                                        },
                                        "^SHA3-256$": {
                                          "type": "string",
                                          "description": "Specifies the SHA3-256 cryptographic hash function.",
                                          "pattern": "^[a-fA-F0-9]{64}$"
                                        },
                                        "^SHA3-512$": {
                                          "type": "string",
                                          "description": "Specifies the SHA3-512 cryptographic hash function.",
                                          "pattern": "^[a-fA-F0-9]{128}$"
                                        },
                                        "^SSDEEP$": {
                                          "type": "string",
                                          "description": "Specifies the ssdeep fuzzy hashing algorithm.",
                                          "pattern": "^[a-zA-Z0-9/+:.]{1,128}$"
                                        },
                                        "^TLSH$": {
                                          "type": "string",
                                          "description": "Specifies the TLSH locality-sensitive hashing algorithm.",
                                          "pattern": "^[a-zA-Z0-9]{70}$"
                                        }
                                      },
                                      "additionalProperties": false
                                    }
                                  }
                                },
                                "sections": {
                                  "type": "array",
                                  "description": "Specifies metadata about the sections in the PE file.",
                                  "items": {
                                    "type": "object",
                                    "description": "The PE Section type specifies metadata about a PE file section.",
                                    "properties": {
                                      "name": {
                                        "type": "string",
                                        "description": "Specifies the name of the section."
                                      },
                                      "size": {
                                        "type": "integer",
                                        "minimum": 0,
                                        "description": "Specifies the size of the section, in bytes."
                                      },
                                      "entropy": {
                                        "type": "number",
                                        "description": "Specifies the calculated entropy for the section, as calculated using the Shannon algorithm."
                                      },
                                      "hashes": {
                                        "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hashes-type.json",
                                        "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                        "title": "hashes",
                                        "description": "The Hashes type represents one or more cryptographic hashes, as a special set of key/value pairs",
                                        "type": "object",
                                        "allOf": [
                                          {
                                            "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/dictionary.json",
                                            "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                            "title": "dictionary",
                                            "description": "A dictionary captures a set of key/value pairs",
                                            "type": "object",
                                            "minProperties": 1,
                                            "patternProperties": {
                                              "^[a-zA-Z0-9_-]{0,250}$": {
                                                "anyOf": [
                                                  {
                                                    "type": "array",
                                                    "minItems": 1
                                                  },
                                                  {
                                                    "type": "string"
                                                  },
                                                  {
                                                    "type": "integer"
                                                  },
                                                  {
                                                    "type": "boolean"
                                                  },
                                                  {
                                                    "type": "number"
                                                  },
                                                  {
                                                    "type": "object"
                                                  }
                                                ]
                                              }
                                            },
                                            "additionalProperties": false
                                          }
                                        ],
                                        "patternProperties": {
                                          "^[a-zA-Z0-9_-]{3,250}$": {
                                            "type": "string",
                                            "description": "Custom hash key"
                                          },
                                          "^MD5$": {
                                            "type": "string",
                                            "description": "Specifies the MD5 message digest algorithm.",
                                            "pattern": "^[a-fA-F0-9]{32}$"
                                          },
                                          "^SHA-1$": {
                                            "type": "string",
                                            "description": "Specifies the SHA-1 (secure-hash algorithm 1) cryptographic hash function.",
                                            "pattern": "^[a-fA-F0-9]{40}$"
                                          },
                                          "^SHA-256$": {
                                            "type": "string",
                                            "description": "Specifies the SHA-256 cryptographic hash function (part of the SHA2 family).",
                                            "pattern": "^[a-fA-F0-9]{64}$"
                                          },
                                          "^SHA-512$": {
                                            "type": "string",
                                            "description": "Specifies the SHA-512 cryptographic hash function (part of the SHA2 family).",
                                            "pattern": "^[a-fA-F0-9]{128}$"
                                          },
                                          "^SHA3-256$": {
                                            "type": "string",
                                            "description": "Specifies the SHA3-256 cryptographic hash function.",
                                            "pattern": "^[a-fA-F0-9]{64}$"
                                          },
                                          "^SHA3-512$": {
                                            "type": "string",
                                            "description": "Specifies the SHA3-512 cryptographic hash function.",
                                            "pattern": "^[a-fA-F0-9]{128}$"
                                          },
                                          "^SSDEEP$": {
                                            "type": "string",
                                            "description": "Specifies the ssdeep fuzzy hashing algorithm.",
                                            "pattern": "^[a-zA-Z0-9/+:.]{1,128}$"
                                          },
                                          "^TLSH$": {
                                            "type": "string",
                                            "description": "Specifies the TLSH locality-sensitive hashing algorithm.",
                                            "pattern": "^[a-zA-Z0-9]{70}$"
                                          }
                                        },
                                        "additionalProperties": false
                                      }
                                    },
                                    "required": [
                                      "name"
                                    ]
                                  },
                                  "minItems": 1
                                }
                              },
                              "anyOf": [
                                {
                                  "required": [
                                    "imphash"
                                  ]
                                },
                                {
                                  "required": [
                                    "machine_hex"
                                  ]
                                },
                                {
                                  "required": [
                                    "number_of_sections"
                                  ]
                                },
                                {
                                  "required": [
                                    "time_date_stamp"
                                  ]
                                },
                                {
                                  "required": [
                                    "pointer_to_symbol_table_hex"
                                  ]
                                },
                                {
                                  "required": [
                                    "number_of_symbols"
                                  ]
                                },
                                {
                                  "required": [
                                    "size_of_optional_header"
                                  ]
                                },
                                {
                                  "required": [
                                    "characteristics_hex"
                                  ]
                                },
                                {
                                  "required": [
                                    "file_header_hashes"
                                  ]
                                },
                                {
                                  "required": [
                                    "optional_header"
                                  ]
                                },
                                {
                                  "required": [
                                    "sections"
                                  ]
                                }
                              ],
                              "required": [
                                "pe_type"
                              ]
                            }
                          },
                          "additionalProperties": {
                            "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/dictionary.json",
                            "$schema": "http://json-schema.org/draft/2020-12/schema#",
                            "title": "dictionary",
                            "description": "A dictionary captures a set of key/value pairs",
                            "type": "object",
                            "minProperties": 1,
                            "patternProperties": {
                              "^[a-zA-Z0-9_-]{0,250}$": {
                                "anyOf": [
                                  {
                                    "type": "array",
                                    "minItems": 1
                                  },
                                  {
                                    "type": "string"
                                  },
                                  {
                                    "type": "integer"
                                  },
                                  {
                                    "type": "boolean"
                                  },
                                  {
                                    "type": "number"
                                  },
                                  {
                                    "type": "object"
                                  }
                                ]
                              }
                            },
                            "additionalProperties": false
                          }
                        },
                        "hashes": {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hashes-type.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "hashes",
                          "description": "The Hashes type represents one or more cryptographic hashes, as a special set of key/value pairs",
                          "type": "object",
                          "allOf": [
                            {
                              "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/dictionary.json",
                              "$schema": "http://json-schema.org/draft/2020-12/schema#",
                              "title": "dictionary",
                              "description": "A dictionary captures a set of key/value pairs",
                              "type": "object",
                              "minProperties": 1,
                              "patternProperties": {
                                "^[a-zA-Z0-9_-]{0,250}$": {
                                  "anyOf": [
                                    {
                                      "type": "array",
                                      "minItems": 1
                                    },
                                    {
                                      "type": "string"
                                    },
                                    {
                                      "type": "integer"
                                    },
                                    {
                                      "type": "boolean"
                                    },
                                    {
                                      "type": "number"
                                    },
                                    {
                                      "type": "object"
                                    }
                                  ]
                                }
                              },
                              "additionalProperties": false
                            }
                          ],
                          "patternProperties": {
                            "^[a-zA-Z0-9_-]{3,250}$": {
                              "type": "string",
                              "description": "Custom hash key"
                            },
                            "^MD5$": {
                              "type": "string",
                              "description": "Specifies the MD5 message digest algorithm.",
                              "pattern": "^[a-fA-F0-9]{32}$"
                            },
                            "^SHA-1$": {
                              "type": "string",
                              "description": "Specifies the SHA-1 (secure-hash algorithm 1) cryptographic hash function.",
                              "pattern": "^[a-fA-F0-9]{40}$"
                            },
                            "^SHA-256$": {
                              "type": "string",
                              "description": "Specifies the SHA-256 cryptographic hash function (part of the SHA2 family).",
                              "pattern": "^[a-fA-F0-9]{64}$"
                            },
                            "^SHA-512$": {
                              "type": "string",
                              "description": "Specifies the SHA-512 cryptographic hash function (part of the SHA2 family).",
                              "pattern": "^[a-fA-F0-9]{128}$"
                            },
                            "^SHA3-256$": {
                              "type": "string",
                              "description": "Specifies the SHA3-256 cryptographic hash function.",
                              "pattern": "^[a-fA-F0-9]{64}$"
                            },
                            "^SHA3-512$": {
                              "type": "string",
                              "description": "Specifies the SHA3-512 cryptographic hash function.",
                              "pattern": "^[a-fA-F0-9]{128}$"
                            },
                            "^SSDEEP$": {
                              "type": "string",
                              "description": "Specifies the ssdeep fuzzy hashing algorithm.",
                              "pattern": "^[a-zA-Z0-9/+:.]{1,128}$"
                            },
                            "^TLSH$": {
                              "type": "string",
                              "description": "Specifies the TLSH locality-sensitive hashing algorithm.",
                              "pattern": "^[a-zA-Z0-9]{70}$"
                            }
                          },
                          "additionalProperties": false
                        },
                        "size": {
                          "type": "integer",
                          "minimum": 0,
                          "description": "Specifies the size of the file, in bytes, as a non-negative integer."
                        },
                        "name": {
                          "type": "string",
                          "description": "Specifies the name of the file."
                        },
                        "name_enc": {
                          "type": "string",
                          "pattern": "^[a-zA-Z0-9/\\.+_:-]{2,250}$",
                          "description": "Specifies the observed encoding for the name of the file."
                        },
                        "magic_number_hex": {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "hex",
                          "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                          "type": "string",
                          "pattern": "^([a-fA-F0-9]{2})+$"
                        },
                        "mime_type": {
                          "type": "string",
                          "description": "Specifies the MIME type name specified for the file, e.g., 'application/msword'."
                        },
                        "ctime": {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/timestamp.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "timestamp",
                          "description": "Represents timestamps across the CTI specifications. The format is an RFC3339 timestamp, with a required timezone specification of 'Z'.",
                          "type": "string",
                          "pattern": "^[0-9]{4}-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])T([01][0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9]|60)(\\.[0-9]+)?Z$"
                        },
                        "mtime": {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/timestamp.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "timestamp",
                          "description": "Represents timestamps across the CTI specifications. The format is an RFC3339 timestamp, with a required timezone specification of 'Z'.",
                          "type": "string",
                          "pattern": "^[0-9]{4}-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])T([01][0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9]|60)(\\.[0-9]+)?Z$"
                        },
                        "atime": {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/timestamp.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "timestamp",
                          "description": "Represents timestamps across the CTI specifications. The format is an RFC3339 timestamp, with a required timezone specification of 'Z'.",
                          "type": "string",
                          "pattern": "^[0-9]{4}-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])T([01][0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9]|60)(\\.[0-9]+)?Z$"
                        },
                        "parent_directory_ref": {
                          "description": "Specifies the parent directory of the file, as a reference to a Directory Object.",
                          "type": "string"
                        },
                        "contains_refs": {
                          "type": "array",
                          "description": "Specifies a list of references to other Observable Objects contained within the file.",
                          "items": {
                            "type": "string"
                          },
                          "minItems": 1
                        },
                        "content_ref": {
                          "description": "Specifies the content of the file, represented as an Artifact Object.",
                          "type": "string"
                        }
                      }
                    }
                  ],
                  "anyOf": [
                    {
                      "required": [
                        "hashes"
                      ]
                    },
                    {
                      "required": [
                        "name"
                      ]
                    }
                  ],
                  "definitions": {
                    "file-extensions-dictionary": {
                      "allOf": [
                        {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/dictionary.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "dictionary",
                          "description": "A dictionary captures a set of key/value pairs",
                          "type": "object",
                          "minProperties": 1,
                          "patternProperties": {
                            "^[a-zA-Z0-9_-]{0,250}$": {
                              "anyOf": [
                                {
                                  "type": "array",
                                  "minItems": 1
                                },
                                {
                                  "type": "string"
                                },
                                {
                                  "type": "integer"
                                },
                                {
                                  "type": "boolean"
                                },
                                {
                                  "type": "number"
                                },
                                {
                                  "type": "object"
                                }
                              ]
                            }
                          },
                          "additionalProperties": false
                        }
                      ],
                      "patternProperties": {
                        "^ntfs-ext$": {
                          "type": "object",
                          "description": "The NTFS file extension specifies a default extension for capturing properties specific to the storage of the file on the NTFS file system.",
                          "allOf": [
                            {
                              "properties": {
                                "sid": {
                                  "type": "string",
                                  "description": "Specifies the security ID (SID) value assigned to the file."
                                },
                                "alternate_data_streams": {
                                  "type": "array",
                                  "description": "Specifies a list of NTFS alternate data streams that exist for the file.",
                                  "items": {
                                    "properties": {
                                      "name": {
                                        "type": "string",
                                        "description": "Specifies the name of the alternate data stream."
                                      },
                                      "hashes": {
                                        "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hashes-type.json",
                                        "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                        "title": "hashes",
                                        "description": "The Hashes type represents one or more cryptographic hashes, as a special set of key/value pairs",
                                        "type": "object",
                                        "allOf": [
                                          {
                                            "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/dictionary.json",
                                            "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                            "title": "dictionary",
                                            "description": "A dictionary captures a set of key/value pairs",
                                            "type": "object",
                                            "minProperties": 1,
                                            "patternProperties": {
                                              "^[a-zA-Z0-9_-]{0,250}$": {
                                                "anyOf": [
                                                  {
                                                    "type": "array",
                                                    "minItems": 1
                                                  },
                                                  {
                                                    "type": "string"
                                                  },
                                                  {
                                                    "type": "integer"
                                                  },
                                                  {
                                                    "type": "boolean"
                                                  },
                                                  {
                                                    "type": "number"
                                                  },
                                                  {
                                                    "type": "object"
                                                  }
                                                ]
                                              }
                                            },
                                            "additionalProperties": false
                                          }
                                        ],
                                        "patternProperties": {
                                          "^[a-zA-Z0-9_-]{3,250}$": {
                                            "type": "string",
                                            "description": "Custom hash key"
                                          },
                                          "^MD5$": {
                                            "type": "string",
                                            "description": "Specifies the MD5 message digest algorithm.",
                                            "pattern": "^[a-fA-F0-9]{32}$"
                                          },
                                          "^SHA-1$": {
                                            "type": "string",
                                            "description": "Specifies the SHA-1 (secure-hash algorithm 1) cryptographic hash function.",
                                            "pattern": "^[a-fA-F0-9]{40}$"
                                          },
                                          "^SHA-256$": {
                                            "type": "string",
                                            "description": "Specifies the SHA-256 cryptographic hash function (part of the SHA2 family).",
                                            "pattern": "^[a-fA-F0-9]{64}$"
                                          },
                                          "^SHA-512$": {
                                            "type": "string",
                                            "description": "Specifies the SHA-512 cryptographic hash function (part of the SHA2 family).",
                                            "pattern": "^[a-fA-F0-9]{128}$"
                                          },
                                          "^SHA3-256$": {
                                            "type": "string",
                                            "description": "Specifies the SHA3-256 cryptographic hash function.",
                                            "pattern": "^[a-fA-F0-9]{64}$"
                                          },
                                          "^SHA3-512$": {
                                            "type": "string",
                                            "description": "Specifies the SHA3-512 cryptographic hash function.",
                                            "pattern": "^[a-fA-F0-9]{128}$"
                                          },
                                          "^SSDEEP$": {
                                            "type": "string",
                                            "description": "Specifies the ssdeep fuzzy hashing algorithm.",
                                            "pattern": "^[a-zA-Z0-9/+:.]{1,128}$"
                                          },
                                          "^TLSH$": {
                                            "type": "string",
                                            "description": "Specifies the TLSH locality-sensitive hashing algorithm.",
                                            "pattern": "^[a-zA-Z0-9]{70}$"
                                          }
                                        },
                                        "additionalProperties": false
                                      },
                                      "size": {
                                        "type": "integer",
                                        "description": "Specifies the size of the alternate data stream, in bytes, as a non-negative integer.",
                                        "minimum": 0
                                      }
                                    },
                                    "required": [
                                      "name"
                                    ]
                                  }
                                }
                              }
                            },
                            {
                              "anyOf": [
                                {
                                  "required": [
                                    "sid"
                                  ]
                                },
                                {
                                  "required": [
                                    "alternate_data_streams"
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        "^raster-image-ext$": {
                          "type": "object",
                          "description": "The Raster Image file extension specifies a default extension for capturing properties specific to image files.",
                          "allOf": [
                            {
                              "properties": {
                                "image_height": {
                                  "type": "integer",
                                  "description": "Specifies the height of the image in the image file, in pixels."
                                },
                                "image_width": {
                                  "type": "integer",
                                  "description": "Specifies the width of the image in the image file, in pixels."
                                },
                                "bits_per_pixel": {
                                  "type": "integer",
                                  "description": "Specifies the sum of bits used for each color channel in the image in the image file, and thus the total number of pixels used for expressing the color depth of the image."
                                },
                                "exif_tags": {
                                  "allOf": [
                                    {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/dictionary.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "dictionary",
                                      "description": "A dictionary captures a set of key/value pairs",
                                      "type": "object",
                                      "minProperties": 1,
                                      "patternProperties": {
                                        "^[a-zA-Z0-9_-]{0,250}$": {
                                          "anyOf": [
                                            {
                                              "type": "array",
                                              "minItems": 1
                                            },
                                            {
                                              "type": "string"
                                            },
                                            {
                                              "type": "integer"
                                            },
                                            {
                                              "type": "boolean"
                                            },
                                            {
                                              "type": "number"
                                            },
                                            {
                                              "type": "object"
                                            }
                                          ]
                                        }
                                      },
                                      "additionalProperties": false
                                    }
                                  ],
                                  "description": "Specifies the set of EXIF tags found in the image file, as a dictionary. Each key/value pair in the dictionary represents the name/value of a single EXIF tag.",
                                  "patternProperties": {
                                    "^[A-Z][a-zA-Z0-9_-]+$": {
                                      "oneOf": [
                                        {
                                          "type": "string"
                                        },
                                        {
                                          "type": "integer"
                                        }
                                      ]
                                    }
                                  },
                                  "additionalProperties": false
                                }
                              }
                            },
                            {
                              "anyOf": [
                                {
                                  "required": [
                                    "image_height"
                                  ]
                                },
                                {
                                  "required": [
                                    "image_width"
                                  ]
                                },
                                {
                                  "required": [
                                    "bits_per_pixel"
                                  ]
                                },
                                {
                                  "required": [
                                    "image_compression_algorithm"
                                  ]
                                },
                                {
                                  "required": [
                                    "exif_tags"
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        "^pdf-ext$": {
                          "type": "object",
                          "description": "The PDF file extension specifies a default extension for capturing properties specific to PDF files.",
                          "allOf": [
                            {
                              "properties": {
                                "version": {
                                  "type": "string",
                                  "description": "Specifies the decimal version number of the string from the PDF header that specifies the version of the PDF specification to which the PDF file conforms. E.g., '1.4'."
                                },
                                "is_optimized": {
                                  "type": "boolean",
                                  "description": "Specifies whether the PDF file has been optimized."
                                },
                                "document_info_dict": {
                                  "allOf": [
                                    {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/dictionary.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "dictionary",
                                      "description": "A dictionary captures a set of key/value pairs",
                                      "type": "object",
                                      "minProperties": 1,
                                      "patternProperties": {
                                        "^[a-zA-Z0-9_-]{0,250}$": {
                                          "anyOf": [
                                            {
                                              "type": "array",
                                              "minItems": 1
                                            },
                                            {
                                              "type": "string"
                                            },
                                            {
                                              "type": "integer"
                                            },
                                            {
                                              "type": "boolean"
                                            },
                                            {
                                              "type": "number"
                                            },
                                            {
                                              "type": "object"
                                            }
                                          ]
                                        }
                                      },
                                      "additionalProperties": false
                                    }
                                  ],
                                  "patternProperties": {
                                    "^[a-zA-Z0-9_-]{0,250}$": {
                                      "type": "string"
                                    }
                                  },
                                  "description": "Specifies details of the PDF document information dictionary (DID), which includes properties like the document creation data and producer, as a dictionary."
                                },
                                "pdfid0": {
                                  "type": "string",
                                  "description": "Specifies the first file identifier found for the PDF file."
                                },
                                "pdfid1": {
                                  "type": "string",
                                  "description": "Specifies the second file identifier found for the PDF file."
                                }
                              }
                            },
                            {
                              "anyOf": [
                                {
                                  "required": [
                                    "version"
                                  ]
                                },
                                {
                                  "required": [
                                    "is_optimized"
                                  ]
                                },
                                {
                                  "required": [
                                    "document_info_dict"
                                  ]
                                },
                                {
                                  "required": [
                                    "pdfid0"
                                  ]
                                },
                                {
                                  "required": [
                                    "pdfid1"
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        "^archive-ext$": {
                          "type": "object",
                          "description": "The Archive File extension specifies a default extension for capturing properties specific to archive files.",
                          "properties": {
                            "contains_refs": {
                              "type": "array",
                              "description": "Specifies the files contained in the archive, as a reference to one or more other File Objects. The objects referenced in this list MUST be of type file-object.",
                              "items": {
                                "type": "string"
                              },
                              "minItems": 1
                            },
                            "comment": {
                              "type": "string",
                              "description": "Specifies a comment included as part of the archive file."
                            }
                          },
                          "required": [
                            "contains_refs"
                          ]
                        },
                        "^windows-pebinary-ext$": {
                          "type": "object",
                          "description": "The Windows PE Binary File extension specifies a default extension for capturing properties specific to Windows portable executable (PE) files.",
                          "properties": {
                            "pe_type": {
                              "type": "string",
                              "description": "Specifies the type of the PE binary. Open Vocabulary - windows-pebinary-type-ov"
                            },
                            "imphash": {
                              "type": "string",
                              "description": "Specifies the special import hash, or 'imphash', calculated for the PE Binary based on its imported libraries and functions."
                            },
                            "machine_hex": {
                              "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                              "$schema": "http://json-schema.org/draft/2020-12/schema#",
                              "title": "hex",
                              "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                              "type": "string",
                              "pattern": "^([a-fA-F0-9]{2})+$"
                            },
                            "number_of_sections": {
                              "type": "integer",
                              "minimum": 0,
                              "description": "Specifies the number of sections in the PE binary, as a non-negative integer."
                            },
                            "time_date_stamp": {
                              "type": "string",
                              "description": "Specifies the time when the PE binary was created.  The timestamp value MUST BE precise to the second.",
                              "allOf": [
                                {
                                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/timestamp.json",
                                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                  "title": "timestamp",
                                  "description": "Represents timestamps across the CTI specifications. The format is an RFC3339 timestamp, with a required timezone specification of 'Z'.",
                                  "type": "string",
                                  "pattern": "^[0-9]{4}-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])T([01][0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9]|60)(\\.[0-9]+)?Z$"
                                },
                                {
                                  "pattern": "T\\d{2}:\\d{2}:\\d{2}Z$"
                                }
                              ]
                            },
                            "pointer_to_symbol_table_hex": {
                              "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                              "$schema": "http://json-schema.org/draft/2020-12/schema#",
                              "title": "hex",
                              "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                              "type": "string",
                              "pattern": "^([a-fA-F0-9]{2})+$"
                            },
                            "number_of_symbols": {
                              "type": "integer",
                              "minimum": 0,
                              "description": "Specifies the number of entries in the symbol table of the PE binary, as a non-negative integer."
                            },
                            "size_of_optional_header": {
                              "type": "integer",
                              "minimum": 0,
                              "description": "Specifies the size of the optional header of the PE binary."
                            },
                            "characteristics_hex": {
                              "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                              "$schema": "http://json-schema.org/draft/2020-12/schema#",
                              "title": "hex",
                              "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                              "type": "string",
                              "pattern": "^([a-fA-F0-9]{2})+$"
                            },
                            "file_header_hashes": {
                              "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hashes-type.json",
                              "$schema": "http://json-schema.org/draft/2020-12/schema#",
                              "title": "hashes",
                              "description": "The Hashes type represents one or more cryptographic hashes, as a special set of key/value pairs",
                              "type": "object",
                              "allOf": [
                                {
                                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/dictionary.json",
                                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                  "title": "dictionary",
                                  "description": "A dictionary captures a set of key/value pairs",
                                  "type": "object",
                                  "minProperties": 1,
                                  "patternProperties": {
                                    "^[a-zA-Z0-9_-]{0,250}$": {
                                      "anyOf": [
                                        {
                                          "type": "array",
                                          "minItems": 1
                                        },
                                        {
                                          "type": "string"
                                        },
                                        {
                                          "type": "integer"
                                        },
                                        {
                                          "type": "boolean"
                                        },
                                        {
                                          "type": "number"
                                        },
                                        {
                                          "type": "object"
                                        }
                                      ]
                                    }
                                  },
                                  "additionalProperties": false
                                }
                              ],
                              "patternProperties": {
                                "^[a-zA-Z0-9_-]{3,250}$": {
                                  "type": "string",
                                  "description": "Custom hash key"
                                },
                                "^MD5$": {
                                  "type": "string",
                                  "description": "Specifies the MD5 message digest algorithm.",
                                  "pattern": "^[a-fA-F0-9]{32}$"
                                },
                                "^SHA-1$": {
                                  "type": "string",
                                  "description": "Specifies the SHA-1 (secure-hash algorithm 1) cryptographic hash function.",
                                  "pattern": "^[a-fA-F0-9]{40}$"
                                },
                                "^SHA-256$": {
                                  "type": "string",
                                  "description": "Specifies the SHA-256 cryptographic hash function (part of the SHA2 family).",
                                  "pattern": "^[a-fA-F0-9]{64}$"
                                },
                                "^SHA-512$": {
                                  "type": "string",
                                  "description": "Specifies the SHA-512 cryptographic hash function (part of the SHA2 family).",
                                  "pattern": "^[a-fA-F0-9]{128}$"
                                },
                                "^SHA3-256$": {
                                  "type": "string",
                                  "description": "Specifies the SHA3-256 cryptographic hash function.",
                                  "pattern": "^[a-fA-F0-9]{64}$"
                                },
                                "^SHA3-512$": {
                                  "type": "string",
                                  "description": "Specifies the SHA3-512 cryptographic hash function.",
                                  "pattern": "^[a-fA-F0-9]{128}$"
                                },
                                "^SSDEEP$": {
                                  "type": "string",
                                  "description": "Specifies the ssdeep fuzzy hashing algorithm.",
                                  "pattern": "^[a-zA-Z0-9/+:.]{1,128}$"
                                },
                                "^TLSH$": {
                                  "type": "string",
                                  "description": "Specifies the TLSH locality-sensitive hashing algorithm.",
                                  "pattern": "^[a-zA-Z0-9]{70}$"
                                }
                              },
                              "additionalProperties": false
                            },
                            "optional_header": {
                              "description": "Specifies the PE optional header of the PE binary.",
                              "type": "object",
                              "minProperties": 1,
                              "additionalProperties": false,
                              "properties": {
                                "magic_hex": {
                                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                  "title": "hex",
                                  "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                                  "type": "string",
                                  "pattern": "^([a-fA-F0-9]{2})+$"
                                },
                                "major_linker_version": {
                                  "type": "integer",
                                  "description": "Specifies the linker major version number."
                                },
                                "minor_linker_version": {
                                  "type": "integer",
                                  "description": "Specifies the linker minor version number."
                                },
                                "size_of_code": {
                                  "type": "integer",
                                  "minimum": 0,
                                  "description": "Specifies the size of the code (text) section. If there are multiple such sections, this refers to the sum of the sizes of each section."
                                },
                                "size_of_initialized_data": {
                                  "type": "integer",
                                  "minimum": 0,
                                  "description": "Specifies the size of the initialized data section. If there are multiple such sections, this refers to the sum of the sizes of each section."
                                },
                                "size_of_uninitialized_data": {
                                  "type": "integer",
                                  "minimum": 0,
                                  "description": "Specifies the size of the uninitialized data section. If there are multiple such sections, this refers to the sum of the sizes of each section."
                                },
                                "address_of_entry_point": {
                                  "type": "integer",
                                  "description": "Specifies the address of the entry point relative to the image base when the executable is loaded into memory."
                                },
                                "base_of_code": {
                                  "type": "integer",
                                  "description": "Specifies the address that is relative to the image base of the beginning-of-code section when it is loaded into memory."
                                },
                                "base_of_data": {
                                  "type": "integer",
                                  "description": "Specifies the address that is relative to the image base of the beginning-of-data section when it is loaded into memory."
                                },
                                "image_base": {
                                  "type": "integer",
                                  "description": "Specifies the preferred address of the first byte of the image when loaded into memory."
                                },
                                "section_alignment": {
                                  "type": "integer",
                                  "description": "Specifies the alignment (in bytes) of PE sections when they are loaded into memory."
                                },
                                "file_alignment": {
                                  "type": "integer",
                                  "description": "Specifies the factor (in bytes) that is used to align the raw data of sections in the image file."
                                },
                                "major_os_version": {
                                  "type": "integer",
                                  "description": "Specifies the major version number of the required operating system."
                                },
                                "minor_os_version": {
                                  "type": "integer",
                                  "description": "Specifies the minor version number of the required operating system."
                                },
                                "major_image_version": {
                                  "type": "integer",
                                  "description": "Specifies the major version number of the image."
                                },
                                "minor_image_version": {
                                  "type": "integer",
                                  "description": "Specifies the minor version number of the image."
                                },
                                "major_subsystem_version": {
                                  "type": "integer",
                                  "description": "Specifies the major version number of the subsystem."
                                },
                                "minor_subsystem_version": {
                                  "type": "integer",
                                  "description": "Specifies the minor version number of the subsystem."
                                },
                                "win32_version_value_hex": {
                                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                  "title": "hex",
                                  "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                                  "type": "string",
                                  "pattern": "^([a-fA-F0-9]{2})+$"
                                },
                                "size_of_image": {
                                  "type": "integer",
                                  "minimum": 0,
                                  "description": "Specifies the size, in bytes, of the image, including all headers, as the image is loaded in memory."
                                },
                                "size_of_headers": {
                                  "type": "integer",
                                  "minimum": 0,
                                  "description": "Specifies the combined size of the MS-DOS, PE header, and section headers, rounded up a multiple of the value specified in the file_alignment header."
                                },
                                "checksum_hex": {
                                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                  "title": "hex",
                                  "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                                  "type": "string",
                                  "pattern": "^([a-fA-F0-9]{2})+$"
                                },
                                "subsystem_hex": {
                                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                  "title": "hex",
                                  "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                                  "type": "string",
                                  "pattern": "^([a-fA-F0-9]{2})+$"
                                },
                                "dll_characteristics_hex": {
                                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                  "title": "hex",
                                  "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                                  "type": "string",
                                  "pattern": "^([a-fA-F0-9]{2})+$"
                                },
                                "size_of_stack_reserve": {
                                  "type": "integer",
                                  "minimum": 0,
                                  "description": "Specifies the size of the stack to reserve"
                                },
                                "size_of_stack_commit": {
                                  "type": "integer",
                                  "minimum": 0,
                                  "description": "Specifies the size of the stack to commit."
                                },
                                "size_of_heap_reserve": {
                                  "type": "integer",
                                  "minimum": 0,
                                  "description": "Specifies the size of the local heap space to reserve."
                                },
                                "size_of_heap_commit": {
                                  "type": "integer",
                                  "minimum": 0,
                                  "description": "Specifies the size of the local heap space to commit."
                                },
                                "loader_flags_hex": {
                                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                  "title": "hex",
                                  "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                                  "type": "string",
                                  "pattern": "^([a-fA-F0-9]{2})+$"
                                },
                                "number_of_rva_and_sizes": {
                                  "type": "integer",
                                  "description": "Specifies the number of data-directory entries in the remainder of the optional header."
                                },
                                "hashes": {
                                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hashes-type.json",
                                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                  "title": "hashes",
                                  "description": "The Hashes type represents one or more cryptographic hashes, as a special set of key/value pairs",
                                  "type": "object",
                                  "allOf": [
                                    {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/dictionary.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "dictionary",
                                      "description": "A dictionary captures a set of key/value pairs",
                                      "type": "object",
                                      "minProperties": 1,
                                      "patternProperties": {
                                        "^[a-zA-Z0-9_-]{0,250}$": {
                                          "anyOf": [
                                            {
                                              "type": "array",
                                              "minItems": 1
                                            },
                                            {
                                              "type": "string"
                                            },
                                            {
                                              "type": "integer"
                                            },
                                            {
                                              "type": "boolean"
                                            },
                                            {
                                              "type": "number"
                                            },
                                            {
                                              "type": "object"
                                            }
                                          ]
                                        }
                                      },
                                      "additionalProperties": false
                                    }
                                  ],
                                  "patternProperties": {
                                    "^[a-zA-Z0-9_-]{3,250}$": {
                                      "type": "string",
                                      "description": "Custom hash key"
                                    },
                                    "^MD5$": {
                                      "type": "string",
                                      "description": "Specifies the MD5 message digest algorithm.",
                                      "pattern": "^[a-fA-F0-9]{32}$"
                                    },
                                    "^SHA-1$": {
                                      "type": "string",
                                      "description": "Specifies the SHA-1 (secure-hash algorithm 1) cryptographic hash function.",
                                      "pattern": "^[a-fA-F0-9]{40}$"
                                    },
                                    "^SHA-256$": {
                                      "type": "string",
                                      "description": "Specifies the SHA-256 cryptographic hash function (part of the SHA2 family).",
                                      "pattern": "^[a-fA-F0-9]{64}$"
                                    },
                                    "^SHA-512$": {
                                      "type": "string",
                                      "description": "Specifies the SHA-512 cryptographic hash function (part of the SHA2 family).",
                                      "pattern": "^[a-fA-F0-9]{128}$"
                                    },
                                    "^SHA3-256$": {
                                      "type": "string",
                                      "description": "Specifies the SHA3-256 cryptographic hash function.",
                                      "pattern": "^[a-fA-F0-9]{64}$"
                                    },
                                    "^SHA3-512$": {
                                      "type": "string",
                                      "description": "Specifies the SHA3-512 cryptographic hash function.",
                                      "pattern": "^[a-fA-F0-9]{128}$"
                                    },
                                    "^SSDEEP$": {
                                      "type": "string",
                                      "description": "Specifies the ssdeep fuzzy hashing algorithm.",
                                      "pattern": "^[a-zA-Z0-9/+:.]{1,128}$"
                                    },
                                    "^TLSH$": {
                                      "type": "string",
                                      "description": "Specifies the TLSH locality-sensitive hashing algorithm.",
                                      "pattern": "^[a-zA-Z0-9]{70}$"
                                    }
                                  },
                                  "additionalProperties": false
                                }
                              }
                            },
                            "sections": {
                              "type": "array",
                              "description": "Specifies metadata about the sections in the PE file.",
                              "items": {
                                "type": "object",
                                "description": "The PE Section type specifies metadata about a PE file section.",
                                "properties": {
                                  "name": {
                                    "type": "string",
                                    "description": "Specifies the name of the section."
                                  },
                                  "size": {
                                    "type": "integer",
                                    "minimum": 0,
                                    "description": "Specifies the size of the section, in bytes."
                                  },
                                  "entropy": {
                                    "type": "number",
                                    "description": "Specifies the calculated entropy for the section, as calculated using the Shannon algorithm."
                                  },
                                  "hashes": {
                                    "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hashes-type.json",
                                    "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                    "title": "hashes",
                                    "description": "The Hashes type represents one or more cryptographic hashes, as a special set of key/value pairs",
                                    "type": "object",
                                    "allOf": [
                                      {
                                        "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/dictionary.json",
                                        "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                        "title": "dictionary",
                                        "description": "A dictionary captures a set of key/value pairs",
                                        "type": "object",
                                        "minProperties": 1,
                                        "patternProperties": {
                                          "^[a-zA-Z0-9_-]{0,250}$": {
                                            "anyOf": [
                                              {
                                                "type": "array",
                                                "minItems": 1
                                              },
                                              {
                                                "type": "string"
                                              },
                                              {
                                                "type": "integer"
                                              },
                                              {
                                                "type": "boolean"
                                              },
                                              {
                                                "type": "number"
                                              },
                                              {
                                                "type": "object"
                                              }
                                            ]
                                          }
                                        },
                                        "additionalProperties": false
                                      }
                                    ],
                                    "patternProperties": {
                                      "^[a-zA-Z0-9_-]{3,250}$": {
                                        "type": "string",
                                        "description": "Custom hash key"
                                      },
                                      "^MD5$": {
                                        "type": "string",
                                        "description": "Specifies the MD5 message digest algorithm.",
                                        "pattern": "^[a-fA-F0-9]{32}$"
                                      },
                                      "^SHA-1$": {
                                        "type": "string",
                                        "description": "Specifies the SHA-1 (secure-hash algorithm 1) cryptographic hash function.",
                                        "pattern": "^[a-fA-F0-9]{40}$"
                                      },
                                      "^SHA-256$": {
                                        "type": "string",
                                        "description": "Specifies the SHA-256 cryptographic hash function (part of the SHA2 family).",
                                        "pattern": "^[a-fA-F0-9]{64}$"
                                      },
                                      "^SHA-512$": {
                                        "type": "string",
                                        "description": "Specifies the SHA-512 cryptographic hash function (part of the SHA2 family).",
                                        "pattern": "^[a-fA-F0-9]{128}$"
                                      },
                                      "^SHA3-256$": {
                                        "type": "string",
                                        "description": "Specifies the SHA3-256 cryptographic hash function.",
                                        "pattern": "^[a-fA-F0-9]{64}$"
                                      },
                                      "^SHA3-512$": {
                                        "type": "string",
                                        "description": "Specifies the SHA3-512 cryptographic hash function.",
                                        "pattern": "^[a-fA-F0-9]{128}$"
                                      },
                                      "^SSDEEP$": {
                                        "type": "string",
                                        "description": "Specifies the ssdeep fuzzy hashing algorithm.",
                                        "pattern": "^[a-zA-Z0-9/+:.]{1,128}$"
                                      },
                                      "^TLSH$": {
                                        "type": "string",
                                        "description": "Specifies the TLSH locality-sensitive hashing algorithm.",
                                        "pattern": "^[a-zA-Z0-9]{70}$"
                                      }
                                    },
                                    "additionalProperties": false
                                  }
                                },
                                "required": [
                                  "name"
                                ]
                              },
                              "minItems": 1
                            }
                          },
                          "anyOf": [
                            {
                              "required": [
                                "imphash"
                              ]
                            },
                            {
                              "required": [
                                "machine_hex"
                              ]
                            },
                            {
                              "required": [
                                "number_of_sections"
                              ]
                            },
                            {
                              "required": [
                                "time_date_stamp"
                              ]
                            },
                            {
                              "required": [
                                "pointer_to_symbol_table_hex"
                              ]
                            },
                            {
                              "required": [
                                "number_of_symbols"
                              ]
                            },
                            {
                              "required": [
                                "size_of_optional_header"
                              ]
                            },
                            {
                              "required": [
                                "characteristics_hex"
                              ]
                            },
                            {
                              "required": [
                                "file_header_hashes"
                              ]
                            },
                            {
                              "required": [
                                "optional_header"
                              ]
                            },
                            {
                              "required": [
                                "sections"
                              ]
                            }
                          ],
                          "required": [
                            "pe_type"
                          ]
                        }
                      },
                      "additionalProperties": {
                        "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/dictionary.json",
                        "$schema": "http://json-schema.org/draft/2020-12/schema#",
                        "title": "dictionary",
                        "description": "A dictionary captures a set of key/value pairs",
                        "type": "object",
                        "minProperties": 1,
                        "patternProperties": {
                          "^[a-zA-Z0-9_-]{0,250}$": {
                            "anyOf": [
                              {
                                "type": "array",
                                "minItems": 1
                              },
                              {
                                "type": "string"
                              },
                              {
                                "type": "integer"
                              },
                              {
                                "type": "boolean"
                              },
                              {
                                "type": "number"
                              },
                              {
                                "type": "object"
                              }
                            ]
                          }
                        },
                        "additionalProperties": false
                      }
                    },
                    "windows-pe-optional-header-type": {
                      "type": "object",
                      "minProperties": 1,
                      "additionalProperties": false,
                      "description": "The Windows PE Optional Header type represents the properties of the PE optional header.",
                      "properties": {
                        "magic_hex": {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "hex",
                          "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                          "type": "string",
                          "pattern": "^([a-fA-F0-9]{2})+$"
                        },
                        "major_linker_version": {
                          "type": "integer",
                          "description": "Specifies the linker major version number."
                        },
                        "minor_linker_version": {
                          "type": "integer",
                          "description": "Specifies the linker minor version number."
                        },
                        "size_of_code": {
                          "type": "integer",
                          "minimum": 0,
                          "description": "Specifies the size of the code (text) section. If there are multiple such sections, this refers to the sum of the sizes of each section."
                        },
                        "size_of_initialized_data": {
                          "type": "integer",
                          "minimum": 0,
                          "description": "Specifies the size of the initialized data section. If there are multiple such sections, this refers to the sum of the sizes of each section."
                        },
                        "size_of_uninitialized_data": {
                          "type": "integer",
                          "minimum": 0,
                          "description": "Specifies the size of the uninitialized data section. If there are multiple such sections, this refers to the sum of the sizes of each section."
                        },
                        "address_of_entry_point": {
                          "type": "integer",
                          "description": "Specifies the address of the entry point relative to the image base when the executable is loaded into memory."
                        },
                        "base_of_code": {
                          "type": "integer",
                          "description": "Specifies the address that is relative to the image base of the beginning-of-code section when it is loaded into memory."
                        },
                        "base_of_data": {
                          "type": "integer",
                          "description": "Specifies the address that is relative to the image base of the beginning-of-data section when it is loaded into memory."
                        },
                        "image_base": {
                          "type": "integer",
                          "description": "Specifies the preferred address of the first byte of the image when loaded into memory."
                        },
                        "section_alignment": {
                          "type": "integer",
                          "description": "Specifies the alignment (in bytes) of PE sections when they are loaded into memory."
                        },
                        "file_alignment": {
                          "type": "integer",
                          "description": "Specifies the factor (in bytes) that is used to align the raw data of sections in the image file."
                        },
                        "major_os_version": {
                          "type": "integer",
                          "description": "Specifies the major version number of the required operating system."
                        },
                        "minor_os_version": {
                          "type": "integer",
                          "description": "Specifies the minor version number of the required operating system."
                        },
                        "major_image_version": {
                          "type": "integer",
                          "description": "Specifies the major version number of the image."
                        },
                        "minor_image_version": {
                          "type": "integer",
                          "description": "Specifies the minor version number of the image."
                        },
                        "major_subsystem_version": {
                          "type": "integer",
                          "description": "Specifies the major version number of the subsystem."
                        },
                        "minor_subsystem_version": {
                          "type": "integer",
                          "description": "Specifies the minor version number of the subsystem."
                        },
                        "win32_version_value_hex": {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "hex",
                          "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                          "type": "string",
                          "pattern": "^([a-fA-F0-9]{2})+$"
                        },
                        "size_of_image": {
                          "type": "integer",
                          "minimum": 0,
                          "description": "Specifies the size, in bytes, of the image, including all headers, as the image is loaded in memory."
                        },
                        "size_of_headers": {
                          "type": "integer",
                          "minimum": 0,
                          "description": "Specifies the combined size of the MS-DOS, PE header, and section headers, rounded up a multiple of the value specified in the file_alignment header."
                        },
                        "checksum_hex": {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "hex",
                          "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                          "type": "string",
                          "pattern": "^([a-fA-F0-9]{2})+$"
                        },
                        "subsystem_hex": {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "hex",
                          "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                          "type": "string",
                          "pattern": "^([a-fA-F0-9]{2})+$"
                        },
                        "dll_characteristics_hex": {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "hex",
                          "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                          "type": "string",
                          "pattern": "^([a-fA-F0-9]{2})+$"
                        },
                        "size_of_stack_reserve": {
                          "type": "integer",
                          "minimum": 0,
                          "description": "Specifies the size of the stack to reserve"
                        },
                        "size_of_stack_commit": {
                          "type": "integer",
                          "minimum": 0,
                          "description": "Specifies the size of the stack to commit."
                        },
                        "size_of_heap_reserve": {
                          "type": "integer",
                          "minimum": 0,
                          "description": "Specifies the size of the local heap space to reserve."
                        },
                        "size_of_heap_commit": {
                          "type": "integer",
                          "minimum": 0,
                          "description": "Specifies the size of the local heap space to commit."
                        },
                        "loader_flags_hex": {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "hex",
                          "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                          "type": "string",
                          "pattern": "^([a-fA-F0-9]{2})+$"
                        },
                        "number_of_rva_and_sizes": {
                          "type": "integer",
                          "description": "Specifies the number of data-directory entries in the remainder of the optional header."
                        },
                        "hashes": {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hashes-type.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "hashes",
                          "description": "The Hashes type represents one or more cryptographic hashes, as a special set of key/value pairs",
                          "type": "object",
                          "allOf": [
                            {
                              "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/dictionary.json",
                              "$schema": "http://json-schema.org/draft/2020-12/schema#",
                              "title": "dictionary",
                              "description": "A dictionary captures a set of key/value pairs",
                              "type": "object",
                              "minProperties": 1,
                              "patternProperties": {
                                "^[a-zA-Z0-9_-]{0,250}$": {
                                  "anyOf": [
                                    {
                                      "type": "array",
                                      "minItems": 1
                                    },
                                    {
                                      "type": "string"
                                    },
                                    {
                                      "type": "integer"
                                    },
                                    {
                                      "type": "boolean"
                                    },
                                    {
                                      "type": "number"
                                    },
                                    {
                                      "type": "object"
                                    }
                                  ]
                                }
                              },
                              "additionalProperties": false
                            }
                          ],
                          "patternProperties": {
                            "^[a-zA-Z0-9_-]{3,250}$": {
                              "type": "string",
                              "description": "Custom hash key"
                            },
                            "^MD5$": {
                              "type": "string",
                              "description": "Specifies the MD5 message digest algorithm.",
                              "pattern": "^[a-fA-F0-9]{32}$"
                            },
                            "^SHA-1$": {
                              "type": "string",
                              "description": "Specifies the SHA-1 (secure-hash algorithm 1) cryptographic hash function.",
                              "pattern": "^[a-fA-F0-9]{40}$"
                            },
                            "^SHA-256$": {
                              "type": "string",
                              "description": "Specifies the SHA-256 cryptographic hash function (part of the SHA2 family).",
                              "pattern": "^[a-fA-F0-9]{64}$"
                            },
                            "^SHA-512$": {
                              "type": "string",
                              "description": "Specifies the SHA-512 cryptographic hash function (part of the SHA2 family).",
                              "pattern": "^[a-fA-F0-9]{128}$"
                            },
                            "^SHA3-256$": {
                              "type": "string",
                              "description": "Specifies the SHA3-256 cryptographic hash function.",
                              "pattern": "^[a-fA-F0-9]{64}$"
                            },
                            "^SHA3-512$": {
                              "type": "string",
                              "description": "Specifies the SHA3-512 cryptographic hash function.",
                              "pattern": "^[a-fA-F0-9]{128}$"
                            },
                            "^SSDEEP$": {
                              "type": "string",
                              "description": "Specifies the ssdeep fuzzy hashing algorithm.",
                              "pattern": "^[a-zA-Z0-9/+:.]{1,128}$"
                            },
                            "^TLSH$": {
                              "type": "string",
                              "description": "Specifies the TLSH locality-sensitive hashing algorithm.",
                              "pattern": "^[a-zA-Z0-9]{70}$"
                            }
                          },
                          "additionalProperties": false
                        }
                      }
                    },
                    "windows-pe-section": {
                      "type": "object",
                      "description": "The PE Section type specifies metadata about a PE file section.",
                      "properties": {
                        "name": {
                          "type": "string",
                          "description": "Specifies the name of the section."
                        },
                        "size": {
                          "type": "integer",
                          "minimum": 0,
                          "description": "Specifies the size of the section, in bytes."
                        },
                        "entropy": {
                          "type": "number",
                          "description": "Specifies the calculated entropy for the section, as calculated using the Shannon algorithm."
                        },
                        "hashes": {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hashes-type.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "hashes",
                          "description": "The Hashes type represents one or more cryptographic hashes, as a special set of key/value pairs",
                          "type": "object",
                          "allOf": [
                            {
                              "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/dictionary.json",
                              "$schema": "http://json-schema.org/draft/2020-12/schema#",
                              "title": "dictionary",
                              "description": "A dictionary captures a set of key/value pairs",
                              "type": "object",
                              "minProperties": 1,
                              "patternProperties": {
                                "^[a-zA-Z0-9_-]{0,250}$": {
                                  "anyOf": [
                                    {
                                      "type": "array",
                                      "minItems": 1
                                    },
                                    {
                                      "type": "string"
                                    },
                                    {
                                      "type": "integer"
                                    },
                                    {
                                      "type": "boolean"
                                    },
                                    {
                                      "type": "number"
                                    },
                                    {
                                      "type": "object"
                                    }
                                  ]
                                }
                              },
                              "additionalProperties": false
                            }
                          ],
                          "patternProperties": {
                            "^[a-zA-Z0-9_-]{3,250}$": {
                              "type": "string",
                              "description": "Custom hash key"
                            },
                            "^MD5$": {
                              "type": "string",
                              "description": "Specifies the MD5 message digest algorithm.",
                              "pattern": "^[a-fA-F0-9]{32}$"
                            },
                            "^SHA-1$": {
                              "type": "string",
                              "description": "Specifies the SHA-1 (secure-hash algorithm 1) cryptographic hash function.",
                              "pattern": "^[a-fA-F0-9]{40}$"
                            },
                            "^SHA-256$": {
                              "type": "string",
                              "description": "Specifies the SHA-256 cryptographic hash function (part of the SHA2 family).",
                              "pattern": "^[a-fA-F0-9]{64}$"
                            },
                            "^SHA-512$": {
                              "type": "string",
                              "description": "Specifies the SHA-512 cryptographic hash function (part of the SHA2 family).",
                              "pattern": "^[a-fA-F0-9]{128}$"
                            },
                            "^SHA3-256$": {
                              "type": "string",
                              "description": "Specifies the SHA3-256 cryptographic hash function.",
                              "pattern": "^[a-fA-F0-9]{64}$"
                            },
                            "^SHA3-512$": {
                              "type": "string",
                              "description": "Specifies the SHA3-512 cryptographic hash function.",
                              "pattern": "^[a-fA-F0-9]{128}$"
                            },
                            "^SSDEEP$": {
                              "type": "string",
                              "description": "Specifies the ssdeep fuzzy hashing algorithm.",
                              "pattern": "^[a-zA-Z0-9/+:.]{1,128}$"
                            },
                            "^TLSH$": {
                              "type": "string",
                              "description": "Specifies the TLSH locality-sensitive hashing algorithm.",
                              "pattern": "^[a-zA-Z0-9]{70}$"
                            }
                          },
                          "additionalProperties": false
                        }
                      },
                      "required": [
                        "name"
                      ]
                    },
                    "windows-pebinary-type-ov": {
                      "type": "string",
                      "enum": [
                        "exe",
                        "dll",
                        "sys"
                      ]
                    }
                  }
                },
                {
                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/observables/ipv4-addr.json",
                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                  "title": "ipv4-addr",
                  "description": "The IPv4 Address Object represents one or more IPv4 addresses expressed using CIDR notation.",
                  "type": "object",
                  "allOf": [
                    {
                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/cyber-observable-core.json",
                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                      "title": "cyber-observable-core",
                      "description": "Common properties and behavior across all Cyber Observable Objects.",
                      "type": "object",
                      "properties": {
                        "type": {
                          "type": "string",
                          "pattern": "^([a-z][a-z0-9]*)+(-[a-z0-9]+)*\\-?$",
                          "minLength": 3,
                          "maxLength": 250,
                          "description": "Indicates that this object is an Observable Object. The value of this property MUST be a valid Observable Object type name, but to allow for custom objects this has been removed from the schema.",
                          "not": {
                            "enum": [
                              "action"
                            ]
                          }
                        },
                        "spec_version": {
                          "type": "string",
                          "enum": [
                            "2.0",
                            "2.1"
                          ],
                          "description": "The version of the STIX specification used to represent the content in this cyber-observable."
                        },
                        "object_marking_refs": {
                          "type": "array",
                          "description": "The list of marking-definition objects to be applied to this object.",
                          "items": {
                            "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/identifier.json",
                            "$schema": "http://json-schema.org/draft/2020-12/schema#",
                            "title": "identifier",
                            "description": "Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.",
                            "type": "string",
                            "pattern": "^[a-z][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
                          },
                          "minItems": 1
                        },
                        "granular_markings": {
                          "type": "array",
                          "description": "The set of granular markings that apply to this object.",
                          "items": {
                            "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/granular-marking.json",
                            "$schema": "http://json-schema.org/draft/2020-12/schema#",
                            "title": "granular-marking",
                            "description": "The granular-marking type defines how the list of marking-definition objects referenced by the marking_refs property to apply to a set of content identified by the list of selectors in the selectors property.",
                            "type": "object",
                            "properties": {
                              "selectors": {
                                "type": "array",
                                "description": "A list of selectors for content contained within the STIX object in which this property appears.",
                                "items": {
                                  "type": "string",
                                  "pattern": "^([a-z0-9_-]{3,249}(\\.(\\[\\d+\\]|[a-z0-9_-]{1,250}))*|id)$"
                                },
                                "minItems": 1
                              },
                              "lang": {
                                "type": "string",
                                "description": "Identifies the language of the text identified by this marking."
                              },
                              "marking_ref": {
                                "allOf": [
                                  {
                                    "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/identifier.json",
                                    "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                    "title": "identifier",
                                    "description": "Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.",
                                    "type": "string",
                                    "pattern": "^[a-z][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
                                  },
                                  {
                                    "pattern": "^marking-definition--",
                                    "description": "The marking_ref property specifies the ID of the marking-definition object that describes the marking."
                                  }
                                ]
                              }
                            },
                            "required": [
                              "selectors",
                              "marking_ref"
                            ]
                          },
                          "minItems": 1
                        },
                        "defanged": {
                          "type": "boolean",
                          "description": "Defines whether or not the data contained within the object has been defanged."
                        },
                        "id": {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/identifier.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "identifier",
                          "description": "Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.",
                          "type": "string",
                          "pattern": "^[a-z][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
                        },
                        "extensions": {
                          "description": "Specifies any extensions of the object, as a dictionary.",
                          "type": "object",
                          "minProperties": 1,
                          "patternProperties": {
                            "^([a-z][a-z0-9]*)+(-[a-z0-9]+)*\\-ext$": {
                              "type": "object",
                              "minProperties": 1,
                              "allOf": [
                                {
                                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/properties.json",
                                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                  "title": "properties",
                                  "description": "Rules for custom properties",
                                  "patternProperties": {
                                    "^[a-z][a-z0-9_]{0,245}_bin$": {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/binary.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "binary",
                                      "description": "The ​binary data type represents a sequence of bytes. In order to allow pattern matching on custom objects, for all properties that use the binary type, the property name MUST end with '_bin'. The JSON MTI serialization represents this as a base64-­encoded string as specified in RFC4648​. Other serializations SHOULD use a native binary type, if available.",
                                      "type": "string",
                                      "pattern": "^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$"
                                    },
                                    "^[a-z][a-z0-9_]{0,245}_hex$": {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "hex",
                                      "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                                      "type": "string",
                                      "pattern": "^([a-fA-F0-9]{2})+$"
                                    },
                                    "^([a-z][a-z0-9_]{2,249})|id$": {
                                      "anyOf": [
                                        {
                                          "type": "array",
                                          "minItems": 1
                                        },
                                        {
                                          "type": "string"
                                        },
                                        {
                                          "type": "integer"
                                        },
                                        {
                                          "type": "boolean"
                                        },
                                        {
                                          "type": "number"
                                        },
                                        {
                                          "type": "object"
                                        }
                                      ]
                                    }
                                  },
                                  "additionalProperties": false
                                }
                              ]
                            },
                            "^extension-definition--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$": {
                              "allOf": [
                                {
                                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/extension.json",
                                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                  "type": "object",
                                  "minProperties": 1,
                                  "properties": {
                                    "extension_type": {
                                      "description": "The type of extension.",
                                      "type": "string",
                                      "enum": [
                                        "new-sdo",
                                        "new-sco",
                                        "new-sro",
                                        "property-extension",
                                        "toplevel-property-extension"
                                      ]
                                    }
                                  },
                                  "allOf": [
                                    {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/properties.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "properties",
                                      "description": "Rules for custom properties",
                                      "patternProperties": {
                                        "^[a-z][a-z0-9_]{0,245}_bin$": {
                                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/binary.json",
                                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                          "title": "binary",
                                          "description": "The ​binary data type represents a sequence of bytes. In order to allow pattern matching on custom objects, for all properties that use the binary type, the property name MUST end with '_bin'. The JSON MTI serialization represents this as a base64-­encoded string as specified in RFC4648​. Other serializations SHOULD use a native binary type, if available.",
                                          "type": "string",
                                          "pattern": "^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$"
                                        },
                                        "^[a-z][a-z0-9_]{0,245}_hex$": {
                                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                          "title": "hex",
                                          "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                                          "type": "string",
                                          "pattern": "^([a-fA-F0-9]{2})+$"
                                        },
                                        "^([a-z][a-z0-9_]{2,249})|id$": {
                                          "anyOf": [
                                            {
                                              "type": "array",
                                              "minItems": 1
                                            },
                                            {
                                              "type": "string"
                                            },
                                            {
                                              "type": "integer"
                                            },
                                            {
                                              "type": "boolean"
                                            },
                                            {
                                              "type": "number"
                                            },
                                            {
                                              "type": "object"
                                            }
                                          ]
                                        }
                                      },
                                      "additionalProperties": false
                                    }
                                  ],
                                  "required": [
                                    "extension_type"
                                  ],
                                  "definitions": {
                                    "extension-type-enum": {
                                      "type": "string",
                                      "enum": [
                                        "new-sdo",
                                        "new-sco",
                                        "new-sro",
                                        "property-extension",
                                        "toplevel-property-extension"
                                      ]
                                    }
                                  }
                                }
                              ]
                            }
                          },
                          "additionalProperties": false
                        }
                      },
                      "allOf": [
                        {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/properties.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "properties",
                          "description": "Rules for custom properties",
                          "patternProperties": {
                            "^[a-z][a-z0-9_]{0,245}_bin$": {
                              "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/binary.json",
                              "$schema": "http://json-schema.org/draft/2020-12/schema#",
                              "title": "binary",
                              "description": "The ​binary data type represents a sequence of bytes. In order to allow pattern matching on custom objects, for all properties that use the binary type, the property name MUST end with '_bin'. The JSON MTI serialization represents this as a base64-­encoded string as specified in RFC4648​. Other serializations SHOULD use a native binary type, if available.",
                              "type": "string",
                              "pattern": "^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$"
                            },
                            "^[a-z][a-z0-9_]{0,245}_hex$": {
                              "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                              "$schema": "http://json-schema.org/draft/2020-12/schema#",
                              "title": "hex",
                              "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                              "type": "string",
                              "pattern": "^([a-fA-F0-9]{2})+$"
                            },
                            "^([a-z][a-z0-9_]{2,249})|id$": {
                              "anyOf": [
                                {
                                  "type": "array",
                                  "minItems": 1
                                },
                                {
                                  "type": "string"
                                },
                                {
                                  "type": "integer"
                                },
                                {
                                  "type": "boolean"
                                },
                                {
                                  "type": "number"
                                },
                                {
                                  "type": "object"
                                }
                              ]
                            }
                          },
                          "additionalProperties": false
                        }
                      ],
                      "not": {
                        "anyOf": [
                          {
                            "required": [
                              "severity"
                            ]
                          },
                          {
                            "required": [
                              "action"
                            ]
                          },
                          {
                            "required": [
                              "username"
                            ]
                          },
                          {
                            "required": [
                              "phone_numbers"
                            ]
                          }
                        ]
                      },
                      "required": [
                        "type",
                        "id"
                      ]
                    },
                    {
                      "properties": {
                        "type": {
                          "type": "string",
                          "description": "The value of this property MUST be `ipv4-addr`.",
                          "enum": [
                            "ipv4-addr"
                          ]
                        },
                        "id": {
                          "title": "id",
                          "pattern": "^ipv4-addr--"
                        },
                        "value": {
                          "type": "string",
                          "description": "Specifies one or more IPv4 addresses expressed using CIDR notation.",
                          "pattern": "^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])(\\/(3[0-2]|[1-2][0-9]|[0-9]))?$"
                        },
                        "resolves_to_refs": {
                          "type": "array",
                          "description": "Specifies a list of references to one or more Layer 2 Media Access Control (MAC) addresses that the IPv4 address resolves to.",
                          "items": {
                            "type": "string"
                          },
                          "minItems": 1
                        },
                        "belongs_to_refs": {
                          "type": "array",
                          "description": "Specifies a reference to one or more autonomous systems (AS) that the IPv4 address belongs to.",
                          "items": {
                            "type": "string"
                          },
                          "minItems": 1
                        }
                      },
                      "required": [
                        "value"
                      ]
                    }
                  ]
                },
                {
                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/observables/ipv6-addr.json",
                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                  "title": "ipv6-addr",
                  "description": "The IPv6 Address Object represents one or more IPv6 addresses expressed using CIDR notation.",
                  "type": "object",
                  "allOf": [
                    {
                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/cyber-observable-core.json",
                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                      "title": "cyber-observable-core",
                      "description": "Common properties and behavior across all Cyber Observable Objects.",
                      "type": "object",
                      "properties": {
                        "type": {
                          "type": "string",
                          "pattern": "^([a-z][a-z0-9]*)+(-[a-z0-9]+)*\\-?$",
                          "minLength": 3,
                          "maxLength": 250,
                          "description": "Indicates that this object is an Observable Object. The value of this property MUST be a valid Observable Object type name, but to allow for custom objects this has been removed from the schema.",
                          "not": {
                            "enum": [
                              "action"
                            ]
                          }
                        },
                        "spec_version": {
                          "type": "string",
                          "enum": [
                            "2.0",
                            "2.1"
                          ],
                          "description": "The version of the STIX specification used to represent the content in this cyber-observable."
                        },
                        "object_marking_refs": {
                          "type": "array",
                          "description": "The list of marking-definition objects to be applied to this object.",
                          "items": {
                            "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/identifier.json",
                            "$schema": "http://json-schema.org/draft/2020-12/schema#",
                            "title": "identifier",
                            "description": "Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.",
                            "type": "string",
                            "pattern": "^[a-z][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
                          },
                          "minItems": 1
                        },
                        "granular_markings": {
                          "type": "array",
                          "description": "The set of granular markings that apply to this object.",
                          "items": {
                            "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/granular-marking.json",
                            "$schema": "http://json-schema.org/draft/2020-12/schema#",
                            "title": "granular-marking",
                            "description": "The granular-marking type defines how the list of marking-definition objects referenced by the marking_refs property to apply to a set of content identified by the list of selectors in the selectors property.",
                            "type": "object",
                            "properties": {
                              "selectors": {
                                "type": "array",
                                "description": "A list of selectors for content contained within the STIX object in which this property appears.",
                                "items": {
                                  "type": "string",
                                  "pattern": "^([a-z0-9_-]{3,249}(\\.(\\[\\d+\\]|[a-z0-9_-]{1,250}))*|id)$"
                                },
                                "minItems": 1
                              },
                              "lang": {
                                "type": "string",
                                "description": "Identifies the language of the text identified by this marking."
                              },
                              "marking_ref": {
                                "allOf": [
                                  {
                                    "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/identifier.json",
                                    "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                    "title": "identifier",
                                    "description": "Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.",
                                    "type": "string",
                                    "pattern": "^[a-z][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
                                  },
                                  {
                                    "pattern": "^marking-definition--",
                                    "description": "The marking_ref property specifies the ID of the marking-definition object that describes the marking."
                                  }
                                ]
                              }
                            },
                            "required": [
                              "selectors",
                              "marking_ref"
                            ]
                          },
                          "minItems": 1
                        },
                        "defanged": {
                          "type": "boolean",
                          "description": "Defines whether or not the data contained within the object has been defanged."
                        },
                        "id": {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/identifier.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "identifier",
                          "description": "Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.",
                          "type": "string",
                          "pattern": "^[a-z][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
                        },
                        "extensions": {
                          "description": "Specifies any extensions of the object, as a dictionary.",
                          "type": "object",
                          "minProperties": 1,
                          "patternProperties": {
                            "^([a-z][a-z0-9]*)+(-[a-z0-9]+)*\\-ext$": {
                              "type": "object",
                              "minProperties": 1,
                              "allOf": [
                                {
                                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/properties.json",
                                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                  "title": "properties",
                                  "description": "Rules for custom properties",
                                  "patternProperties": {
                                    "^[a-z][a-z0-9_]{0,245}_bin$": {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/binary.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "binary",
                                      "description": "The ​binary data type represents a sequence of bytes. In order to allow pattern matching on custom objects, for all properties that use the binary type, the property name MUST end with '_bin'. The JSON MTI serialization represents this as a base64-­encoded string as specified in RFC4648​. Other serializations SHOULD use a native binary type, if available.",
                                      "type": "string",
                                      "pattern": "^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$"
                                    },
                                    "^[a-z][a-z0-9_]{0,245}_hex$": {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "hex",
                                      "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                                      "type": "string",
                                      "pattern": "^([a-fA-F0-9]{2})+$"
                                    },
                                    "^([a-z][a-z0-9_]{2,249})|id$": {
                                      "anyOf": [
                                        {
                                          "type": "array",
                                          "minItems": 1
                                        },
                                        {
                                          "type": "string"
                                        },
                                        {
                                          "type": "integer"
                                        },
                                        {
                                          "type": "boolean"
                                        },
                                        {
                                          "type": "number"
                                        },
                                        {
                                          "type": "object"
                                        }
                                      ]
                                    }
                                  },
                                  "additionalProperties": false
                                }
                              ]
                            },
                            "^extension-definition--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$": {
                              "allOf": [
                                {
                                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/extension.json",
                                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                  "type": "object",
                                  "minProperties": 1,
                                  "properties": {
                                    "extension_type": {
                                      "description": "The type of extension.",
                                      "type": "string",
                                      "enum": [
                                        "new-sdo",
                                        "new-sco",
                                        "new-sro",
                                        "property-extension",
                                        "toplevel-property-extension"
                                      ]
                                    }
                                  },
                                  "allOf": [
                                    {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/properties.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "properties",
                                      "description": "Rules for custom properties",
                                      "patternProperties": {
                                        "^[a-z][a-z0-9_]{0,245}_bin$": {
                                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/binary.json",
                                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                          "title": "binary",
                                          "description": "The ​binary data type represents a sequence of bytes. In order to allow pattern matching on custom objects, for all properties that use the binary type, the property name MUST end with '_bin'. The JSON MTI serialization represents this as a base64-­encoded string as specified in RFC4648​. Other serializations SHOULD use a native binary type, if available.",
                                          "type": "string",
                                          "pattern": "^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$"
                                        },
                                        "^[a-z][a-z0-9_]{0,245}_hex$": {
                                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                          "title": "hex",
                                          "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                                          "type": "string",
                                          "pattern": "^([a-fA-F0-9]{2})+$"
                                        },
                                        "^([a-z][a-z0-9_]{2,249})|id$": {
                                          "anyOf": [
                                            {
                                              "type": "array",
                                              "minItems": 1
                                            },
                                            {
                                              "type": "string"
                                            },
                                            {
                                              "type": "integer"
                                            },
                                            {
                                              "type": "boolean"
                                            },
                                            {
                                              "type": "number"
                                            },
                                            {
                                              "type": "object"
                                            }
                                          ]
                                        }
                                      },
                                      "additionalProperties": false
                                    }
                                  ],
                                  "required": [
                                    "extension_type"
                                  ],
                                  "definitions": {
                                    "extension-type-enum": {
                                      "type": "string",
                                      "enum": [
                                        "new-sdo",
                                        "new-sco",
                                        "new-sro",
                                        "property-extension",
                                        "toplevel-property-extension"
                                      ]
                                    }
                                  }
                                }
                              ]
                            }
                          },
                          "additionalProperties": false
                        }
                      },
                      "allOf": [
                        {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/properties.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "properties",
                          "description": "Rules for custom properties",
                          "patternProperties": {
                            "^[a-z][a-z0-9_]{0,245}_bin$": {
                              "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/binary.json",
                              "$schema": "http://json-schema.org/draft/2020-12/schema#",
                              "title": "binary",
                              "description": "The ​binary data type represents a sequence of bytes. In order to allow pattern matching on custom objects, for all properties that use the binary type, the property name MUST end with '_bin'. The JSON MTI serialization represents this as a base64-­encoded string as specified in RFC4648​. Other serializations SHOULD use a native binary type, if available.",
                              "type": "string",
                              "pattern": "^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$"
                            },
                            "^[a-z][a-z0-9_]{0,245}_hex$": {
                              "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                              "$schema": "http://json-schema.org/draft/2020-12/schema#",
                              "title": "hex",
                              "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                              "type": "string",
                              "pattern": "^([a-fA-F0-9]{2})+$"
                            },
                            "^([a-z][a-z0-9_]{2,249})|id$": {
                              "anyOf": [
                                {
                                  "type": "array",
                                  "minItems": 1
                                },
                                {
                                  "type": "string"
                                },
                                {
                                  "type": "integer"
                                },
                                {
                                  "type": "boolean"
                                },
                                {
                                  "type": "number"
                                },
                                {
                                  "type": "object"
                                }
                              ]
                            }
                          },
                          "additionalProperties": false
                        }
                      ],
                      "not": {
                        "anyOf": [
                          {
                            "required": [
                              "severity"
                            ]
                          },
                          {
                            "required": [
                              "action"
                            ]
                          },
                          {
                            "required": [
                              "username"
                            ]
                          },
                          {
                            "required": [
                              "phone_numbers"
                            ]
                          }
                        ]
                      },
                      "required": [
                        "type",
                        "id"
                      ]
                    },
                    {
                      "properties": {
                        "type": {
                          "type": "string",
                          "description": "The value of this property MUST be `ipv6-addr`.",
                          "enum": [
                            "ipv6-addr"
                          ]
                        },
                        "id": {
                          "title": "id",
                          "pattern": "^ipv6-addr--"
                        },
                        "value": {
                          "type": "string",
                          "description": "Specifies one or more IPv6 addresses expressed using CIDR notation.",
                          "pattern": "^s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]d|1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]d|1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]d|1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]d|1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]d|1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]d|1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]d|1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3}))|:)))(%.+)?s*(\\/(12[0-8]|1[0-1][0-9]|[1-9][0-9]|[0-9]))?$"
                        },
                        "resolves_to_refs": {
                          "type": "array",
                          "description": "Specifies a list of references to one or more Layer 2 Media Access Control (MAC) addresses that the IPv6 address resolves to.",
                          "items": {
                            "type": "string"
                          },
                          "minItems": 1
                        },
                        "belongs_to_refs": {
                          "type": "array",
                          "description": "Specifies a reference to one or more autonomous systems (AS) that the IPv6 address belongs to.",
                          "items": {
                            "type": "string"
                          },
                          "minItems": 1
                        }
                      },
                      "required": [
                        "value"
                      ]
                    }
                  ]
                },
                {
                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/observables/mac-addr.json",
                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                  "title": "mac-addr",
                  "description": "The MAC Address Object represents a single Media Access Control (MAC) address.",
                  "type": "object",
                  "allOf": [
                    {
                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/cyber-observable-core.json",
                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                      "title": "cyber-observable-core",
                      "description": "Common properties and behavior across all Cyber Observable Objects.",
                      "type": "object",
                      "properties": {
                        "type": {
                          "type": "string",
                          "pattern": "^([a-z][a-z0-9]*)+(-[a-z0-9]+)*\\-?$",
                          "minLength": 3,
                          "maxLength": 250,
                          "description": "Indicates that this object is an Observable Object. The value of this property MUST be a valid Observable Object type name, but to allow for custom objects this has been removed from the schema.",
                          "not": {
                            "enum": [
                              "action"
                            ]
                          }
                        },
                        "spec_version": {
                          "type": "string",
                          "enum": [
                            "2.0",
                            "2.1"
                          ],
                          "description": "The version of the STIX specification used to represent the content in this cyber-observable."
                        },
                        "object_marking_refs": {
                          "type": "array",
                          "description": "The list of marking-definition objects to be applied to this object.",
                          "items": {
                            "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/identifier.json",
                            "$schema": "http://json-schema.org/draft/2020-12/schema#",
                            "title": "identifier",
                            "description": "Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.",
                            "type": "string",
                            "pattern": "^[a-z][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
                          },
                          "minItems": 1
                        },
                        "granular_markings": {
                          "type": "array",
                          "description": "The set of granular markings that apply to this object.",
                          "items": {
                            "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/granular-marking.json",
                            "$schema": "http://json-schema.org/draft/2020-12/schema#",
                            "title": "granular-marking",
                            "description": "The granular-marking type defines how the list of marking-definition objects referenced by the marking_refs property to apply to a set of content identified by the list of selectors in the selectors property.",
                            "type": "object",
                            "properties": {
                              "selectors": {
                                "type": "array",
                                "description": "A list of selectors for content contained within the STIX object in which this property appears.",
                                "items": {
                                  "type": "string",
                                  "pattern": "^([a-z0-9_-]{3,249}(\\.(\\[\\d+\\]|[a-z0-9_-]{1,250}))*|id)$"
                                },
                                "minItems": 1
                              },
                              "lang": {
                                "type": "string",
                                "description": "Identifies the language of the text identified by this marking."
                              },
                              "marking_ref": {
                                "allOf": [
                                  {
                                    "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/identifier.json",
                                    "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                    "title": "identifier",
                                    "description": "Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.",
                                    "type": "string",
                                    "pattern": "^[a-z][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
                                  },
                                  {
                                    "pattern": "^marking-definition--",
                                    "description": "The marking_ref property specifies the ID of the marking-definition object that describes the marking."
                                  }
                                ]
                              }
                            },
                            "required": [
                              "selectors",
                              "marking_ref"
                            ]
                          },
                          "minItems": 1
                        },
                        "defanged": {
                          "type": "boolean",
                          "description": "Defines whether or not the data contained within the object has been defanged."
                        },
                        "id": {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/identifier.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "identifier",
                          "description": "Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.",
                          "type": "string",
                          "pattern": "^[a-z][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
                        },
                        "extensions": {
                          "description": "Specifies any extensions of the object, as a dictionary.",
                          "type": "object",
                          "minProperties": 1,
                          "patternProperties": {
                            "^([a-z][a-z0-9]*)+(-[a-z0-9]+)*\\-ext$": {
                              "type": "object",
                              "minProperties": 1,
                              "allOf": [
                                {
                                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/properties.json",
                                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                  "title": "properties",
                                  "description": "Rules for custom properties",
                                  "patternProperties": {
                                    "^[a-z][a-z0-9_]{0,245}_bin$": {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/binary.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "binary",
                                      "description": "The ​binary data type represents a sequence of bytes. In order to allow pattern matching on custom objects, for all properties that use the binary type, the property name MUST end with '_bin'. The JSON MTI serialization represents this as a base64-­encoded string as specified in RFC4648​. Other serializations SHOULD use a native binary type, if available.",
                                      "type": "string",
                                      "pattern": "^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$"
                                    },
                                    "^[a-z][a-z0-9_]{0,245}_hex$": {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "hex",
                                      "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                                      "type": "string",
                                      "pattern": "^([a-fA-F0-9]{2})+$"
                                    },
                                    "^([a-z][a-z0-9_]{2,249})|id$": {
                                      "anyOf": [
                                        {
                                          "type": "array",
                                          "minItems": 1
                                        },
                                        {
                                          "type": "string"
                                        },
                                        {
                                          "type": "integer"
                                        },
                                        {
                                          "type": "boolean"
                                        },
                                        {
                                          "type": "number"
                                        },
                                        {
                                          "type": "object"
                                        }
                                      ]
                                    }
                                  },
                                  "additionalProperties": false
                                }
                              ]
                            },
                            "^extension-definition--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$": {
                              "allOf": [
                                {
                                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/extension.json",
                                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                  "type": "object",
                                  "minProperties": 1,
                                  "properties": {
                                    "extension_type": {
                                      "description": "The type of extension.",
                                      "type": "string",
                                      "enum": [
                                        "new-sdo",
                                        "new-sco",
                                        "new-sro",
                                        "property-extension",
                                        "toplevel-property-extension"
                                      ]
                                    }
                                  },
                                  "allOf": [
                                    {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/properties.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "properties",
                                      "description": "Rules for custom properties",
                                      "patternProperties": {
                                        "^[a-z][a-z0-9_]{0,245}_bin$": {
                                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/binary.json",
                                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                          "title": "binary",
                                          "description": "The ​binary data type represents a sequence of bytes. In order to allow pattern matching on custom objects, for all properties that use the binary type, the property name MUST end with '_bin'. The JSON MTI serialization represents this as a base64-­encoded string as specified in RFC4648​. Other serializations SHOULD use a native binary type, if available.",
                                          "type": "string",
                                          "pattern": "^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$"
                                        },
                                        "^[a-z][a-z0-9_]{0,245}_hex$": {
                                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                          "title": "hex",
                                          "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                                          "type": "string",
                                          "pattern": "^([a-fA-F0-9]{2})+$"
                                        },
                                        "^([a-z][a-z0-9_]{2,249})|id$": {
                                          "anyOf": [
                                            {
                                              "type": "array",
                                              "minItems": 1
                                            },
                                            {
                                              "type": "string"
                                            },
                                            {
                                              "type": "integer"
                                            },
                                            {
                                              "type": "boolean"
                                            },
                                            {
                                              "type": "number"
                                            },
                                            {
                                              "type": "object"
                                            }
                                          ]
                                        }
                                      },
                                      "additionalProperties": false
                                    }
                                  ],
                                  "required": [
                                    "extension_type"
                                  ],
                                  "definitions": {
                                    "extension-type-enum": {
                                      "type": "string",
                                      "enum": [
                                        "new-sdo",
                                        "new-sco",
                                        "new-sro",
                                        "property-extension",
                                        "toplevel-property-extension"
                                      ]
                                    }
                                  }
                                }
                              ]
                            }
                          },
                          "additionalProperties": false
                        }
                      },
                      "allOf": [
                        {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/properties.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "properties",
                          "description": "Rules for custom properties",
                          "patternProperties": {
                            "^[a-z][a-z0-9_]{0,245}_bin$": {
                              "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/binary.json",
                              "$schema": "http://json-schema.org/draft/2020-12/schema#",
                              "title": "binary",
                              "description": "The ​binary data type represents a sequence of bytes. In order to allow pattern matching on custom objects, for all properties that use the binary type, the property name MUST end with '_bin'. The JSON MTI serialization represents this as a base64-­encoded string as specified in RFC4648​. Other serializations SHOULD use a native binary type, if available.",
                              "type": "string",
                              "pattern": "^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$"
                            },
                            "^[a-z][a-z0-9_]{0,245}_hex$": {
                              "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                              "$schema": "http://json-schema.org/draft/2020-12/schema#",
                              "title": "hex",
                              "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                              "type": "string",
                              "pattern": "^([a-fA-F0-9]{2})+$"
                            },
                            "^([a-z][a-z0-9_]{2,249})|id$": {
                              "anyOf": [
                                {
                                  "type": "array",
                                  "minItems": 1
                                },
                                {
                                  "type": "string"
                                },
                                {
                                  "type": "integer"
                                },
                                {
                                  "type": "boolean"
                                },
                                {
                                  "type": "number"
                                },
                                {
                                  "type": "object"
                                }
                              ]
                            }
                          },
                          "additionalProperties": false
                        }
                      ],
                      "not": {
                        "anyOf": [
                          {
                            "required": [
                              "severity"
                            ]
                          },
                          {
                            "required": [
                              "action"
                            ]
                          },
                          {
                            "required": [
                              "username"
                            ]
                          },
                          {
                            "required": [
                              "phone_numbers"
                            ]
                          }
                        ]
                      },
                      "required": [
                        "type",
                        "id"
                      ]
                    },
                    {
                      "properties": {
                        "type": {
                          "type": "string",
                          "description": "The value of this property MUST be `mac-addr`.",
                          "enum": [
                            "mac-addr"
                          ]
                        },
                        "id": {
                          "title": "id",
                          "pattern": "^mac-addr--"
                        },
                        "value": {
                          "type": "string",
                          "pattern": "^([0-9a-f]{2}[:]){5}([0-9a-f]{2})$",
                          "description": "Specifies one or more mac addresses expressed using CIDR notation."
                        }
                      },
                      "required": [
                        "value"
                      ]
                    }
                  ]
                },
                {
                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/observables/mutex.json",
                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                  "title": "mutex",
                  "description": "The Mutex Object represents the properties of a mutual exclusion (mutex) object.",
                  "type": "object",
                  "allOf": [
                    {
                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/cyber-observable-core.json",
                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                      "title": "cyber-observable-core",
                      "description": "Common properties and behavior across all Cyber Observable Objects.",
                      "type": "object",
                      "properties": {
                        "type": {
                          "type": "string",
                          "pattern": "^([a-z][a-z0-9]*)+(-[a-z0-9]+)*\\-?$",
                          "minLength": 3,
                          "maxLength": 250,
                          "description": "Indicates that this object is an Observable Object. The value of this property MUST be a valid Observable Object type name, but to allow for custom objects this has been removed from the schema.",
                          "not": {
                            "enum": [
                              "action"
                            ]
                          }
                        },
                        "spec_version": {
                          "type": "string",
                          "enum": [
                            "2.0",
                            "2.1"
                          ],
                          "description": "The version of the STIX specification used to represent the content in this cyber-observable."
                        },
                        "object_marking_refs": {
                          "type": "array",
                          "description": "The list of marking-definition objects to be applied to this object.",
                          "items": {
                            "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/identifier.json",
                            "$schema": "http://json-schema.org/draft/2020-12/schema#",
                            "title": "identifier",
                            "description": "Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.",
                            "type": "string",
                            "pattern": "^[a-z][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
                          },
                          "minItems": 1
                        },
                        "granular_markings": {
                          "type": "array",
                          "description": "The set of granular markings that apply to this object.",
                          "items": {
                            "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/granular-marking.json",
                            "$schema": "http://json-schema.org/draft/2020-12/schema#",
                            "title": "granular-marking",
                            "description": "The granular-marking type defines how the list of marking-definition objects referenced by the marking_refs property to apply to a set of content identified by the list of selectors in the selectors property.",
                            "type": "object",
                            "properties": {
                              "selectors": {
                                "type": "array",
                                "description": "A list of selectors for content contained within the STIX object in which this property appears.",
                                "items": {
                                  "type": "string",
                                  "pattern": "^([a-z0-9_-]{3,249}(\\.(\\[\\d+\\]|[a-z0-9_-]{1,250}))*|id)$"
                                },
                                "minItems": 1
                              },
                              "lang": {
                                "type": "string",
                                "description": "Identifies the language of the text identified by this marking."
                              },
                              "marking_ref": {
                                "allOf": [
                                  {
                                    "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/identifier.json",
                                    "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                    "title": "identifier",
                                    "description": "Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.",
                                    "type": "string",
                                    "pattern": "^[a-z][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
                                  },
                                  {
                                    "pattern": "^marking-definition--",
                                    "description": "The marking_ref property specifies the ID of the marking-definition object that describes the marking."
                                  }
                                ]
                              }
                            },
                            "required": [
                              "selectors",
                              "marking_ref"
                            ]
                          },
                          "minItems": 1
                        },
                        "defanged": {
                          "type": "boolean",
                          "description": "Defines whether or not the data contained within the object has been defanged."
                        },
                        "id": {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/identifier.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "identifier",
                          "description": "Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.",
                          "type": "string",
                          "pattern": "^[a-z][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
                        },
                        "extensions": {
                          "description": "Specifies any extensions of the object, as a dictionary.",
                          "type": "object",
                          "minProperties": 1,
                          "patternProperties": {
                            "^([a-z][a-z0-9]*)+(-[a-z0-9]+)*\\-ext$": {
                              "type": "object",
                              "minProperties": 1,
                              "allOf": [
                                {
                                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/properties.json",
                                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                  "title": "properties",
                                  "description": "Rules for custom properties",
                                  "patternProperties": {
                                    "^[a-z][a-z0-9_]{0,245}_bin$": {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/binary.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "binary",
                                      "description": "The ​binary data type represents a sequence of bytes. In order to allow pattern matching on custom objects, for all properties that use the binary type, the property name MUST end with '_bin'. The JSON MTI serialization represents this as a base64-­encoded string as specified in RFC4648​. Other serializations SHOULD use a native binary type, if available.",
                                      "type": "string",
                                      "pattern": "^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$"
                                    },
                                    "^[a-z][a-z0-9_]{0,245}_hex$": {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "hex",
                                      "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                                      "type": "string",
                                      "pattern": "^([a-fA-F0-9]{2})+$"
                                    },
                                    "^([a-z][a-z0-9_]{2,249})|id$": {
                                      "anyOf": [
                                        {
                                          "type": "array",
                                          "minItems": 1
                                        },
                                        {
                                          "type": "string"
                                        },
                                        {
                                          "type": "integer"
                                        },
                                        {
                                          "type": "boolean"
                                        },
                                        {
                                          "type": "number"
                                        },
                                        {
                                          "type": "object"
                                        }
                                      ]
                                    }
                                  },
                                  "additionalProperties": false
                                }
                              ]
                            },
                            "^extension-definition--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$": {
                              "allOf": [
                                {
                                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/extension.json",
                                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                  "type": "object",
                                  "minProperties": 1,
                                  "properties": {
                                    "extension_type": {
                                      "description": "The type of extension.",
                                      "type": "string",
                                      "enum": [
                                        "new-sdo",
                                        "new-sco",
                                        "new-sro",
                                        "property-extension",
                                        "toplevel-property-extension"
                                      ]
                                    }
                                  },
                                  "allOf": [
                                    {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/properties.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "properties",
                                      "description": "Rules for custom properties",
                                      "patternProperties": {
                                        "^[a-z][a-z0-9_]{0,245}_bin$": {
                                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/binary.json",
                                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                          "title": "binary",
                                          "description": "The ​binary data type represents a sequence of bytes. In order to allow pattern matching on custom objects, for all properties that use the binary type, the property name MUST end with '_bin'. The JSON MTI serialization represents this as a base64-­encoded string as specified in RFC4648​. Other serializations SHOULD use a native binary type, if available.",
                                          "type": "string",
                                          "pattern": "^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$"
                                        },
                                        "^[a-z][a-z0-9_]{0,245}_hex$": {
                                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                          "title": "hex",
                                          "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                                          "type": "string",
                                          "pattern": "^([a-fA-F0-9]{2})+$"
                                        },
                                        "^([a-z][a-z0-9_]{2,249})|id$": {
                                          "anyOf": [
                                            {
                                              "type": "array",
                                              "minItems": 1
                                            },
                                            {
                                              "type": "string"
                                            },
                                            {
                                              "type": "integer"
                                            },
                                            {
                                              "type": "boolean"
                                            },
                                            {
                                              "type": "number"
                                            },
                                            {
                                              "type": "object"
                                            }
                                          ]
                                        }
                                      },
                                      "additionalProperties": false
                                    }
                                  ],
                                  "required": [
                                    "extension_type"
                                  ],
                                  "definitions": {
                                    "extension-type-enum": {
                                      "type": "string",
                                      "enum": [
                                        "new-sdo",
                                        "new-sco",
                                        "new-sro",
                                        "property-extension",
                                        "toplevel-property-extension"
                                      ]
                                    }
                                  }
                                }
                              ]
                            }
                          },
                          "additionalProperties": false
                        }
                      },
                      "allOf": [
                        {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/properties.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "properties",
                          "description": "Rules for custom properties",
                          "patternProperties": {
                            "^[a-z][a-z0-9_]{0,245}_bin$": {
                              "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/binary.json",
                              "$schema": "http://json-schema.org/draft/2020-12/schema#",
                              "title": "binary",
                              "description": "The ​binary data type represents a sequence of bytes. In order to allow pattern matching on custom objects, for all properties that use the binary type, the property name MUST end with '_bin'. The JSON MTI serialization represents this as a base64-­encoded string as specified in RFC4648​. Other serializations SHOULD use a native binary type, if available.",
                              "type": "string",
                              "pattern": "^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$"
                            },
                            "^[a-z][a-z0-9_]{0,245}_hex$": {
                              "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                              "$schema": "http://json-schema.org/draft/2020-12/schema#",
                              "title": "hex",
                              "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                              "type": "string",
                              "pattern": "^([a-fA-F0-9]{2})+$"
                            },
                            "^([a-z][a-z0-9_]{2,249})|id$": {
                              "anyOf": [
                                {
                                  "type": "array",
                                  "minItems": 1
                                },
                                {
                                  "type": "string"
                                },
                                {
                                  "type": "integer"
                                },
                                {
                                  "type": "boolean"
                                },
                                {
                                  "type": "number"
                                },
                                {
                                  "type": "object"
                                }
                              ]
                            }
                          },
                          "additionalProperties": false
                        }
                      ],
                      "not": {
                        "anyOf": [
                          {
                            "required": [
                              "severity"
                            ]
                          },
                          {
                            "required": [
                              "action"
                            ]
                          },
                          {
                            "required": [
                              "username"
                            ]
                          },
                          {
                            "required": [
                              "phone_numbers"
                            ]
                          }
                        ]
                      },
                      "required": [
                        "type",
                        "id"
                      ]
                    },
                    {
                      "properties": {
                        "type": {
                          "type": "string",
                          "description": "The value of this property MUST be `mutex`.",
                          "enum": [
                            "mutex"
                          ]
                        },
                        "id": {
                          "title": "id",
                          "pattern": "^mutex--"
                        },
                        "name": {
                          "type": "string",
                          "description": "Specifies the name of the mutex object."
                        }
                      }
                    }
                  ],
                  "required": [
                    "name"
                  ]
                },
                {
                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/observables/network-traffic.json",
                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                  "title": "network-traffic",
                  "description": "The Network Traffic Object represents arbitrary network traffic that originates from a source and is addressed to a destination.",
                  "type": "object",
                  "allOf": [
                    {
                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/cyber-observable-core.json",
                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                      "title": "cyber-observable-core",
                      "description": "Common properties and behavior across all Cyber Observable Objects.",
                      "type": "object",
                      "properties": {
                        "type": {
                          "type": "string",
                          "pattern": "^([a-z][a-z0-9]*)+(-[a-z0-9]+)*\\-?$",
                          "minLength": 3,
                          "maxLength": 250,
                          "description": "Indicates that this object is an Observable Object. The value of this property MUST be a valid Observable Object type name, but to allow for custom objects this has been removed from the schema.",
                          "not": {
                            "enum": [
                              "action"
                            ]
                          }
                        },
                        "spec_version": {
                          "type": "string",
                          "enum": [
                            "2.0",
                            "2.1"
                          ],
                          "description": "The version of the STIX specification used to represent the content in this cyber-observable."
                        },
                        "object_marking_refs": {
                          "type": "array",
                          "description": "The list of marking-definition objects to be applied to this object.",
                          "items": {
                            "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/identifier.json",
                            "$schema": "http://json-schema.org/draft/2020-12/schema#",
                            "title": "identifier",
                            "description": "Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.",
                            "type": "string",
                            "pattern": "^[a-z][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
                          },
                          "minItems": 1
                        },
                        "granular_markings": {
                          "type": "array",
                          "description": "The set of granular markings that apply to this object.",
                          "items": {
                            "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/granular-marking.json",
                            "$schema": "http://json-schema.org/draft/2020-12/schema#",
                            "title": "granular-marking",
                            "description": "The granular-marking type defines how the list of marking-definition objects referenced by the marking_refs property to apply to a set of content identified by the list of selectors in the selectors property.",
                            "type": "object",
                            "properties": {
                              "selectors": {
                                "type": "array",
                                "description": "A list of selectors for content contained within the STIX object in which this property appears.",
                                "items": {
                                  "type": "string",
                                  "pattern": "^([a-z0-9_-]{3,249}(\\.(\\[\\d+\\]|[a-z0-9_-]{1,250}))*|id)$"
                                },
                                "minItems": 1
                              },
                              "lang": {
                                "type": "string",
                                "description": "Identifies the language of the text identified by this marking."
                              },
                              "marking_ref": {
                                "allOf": [
                                  {
                                    "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/identifier.json",
                                    "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                    "title": "identifier",
                                    "description": "Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.",
                                    "type": "string",
                                    "pattern": "^[a-z][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
                                  },
                                  {
                                    "pattern": "^marking-definition--",
                                    "description": "The marking_ref property specifies the ID of the marking-definition object that describes the marking."
                                  }
                                ]
                              }
                            },
                            "required": [
                              "selectors",
                              "marking_ref"
                            ]
                          },
                          "minItems": 1
                        },
                        "defanged": {
                          "type": "boolean",
                          "description": "Defines whether or not the data contained within the object has been defanged."
                        },
                        "id": {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/identifier.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "identifier",
                          "description": "Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.",
                          "type": "string",
                          "pattern": "^[a-z][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
                        },
                        "extensions": {
                          "description": "Specifies any extensions of the object, as a dictionary.",
                          "type": "object",
                          "minProperties": 1,
                          "patternProperties": {
                            "^([a-z][a-z0-9]*)+(-[a-z0-9]+)*\\-ext$": {
                              "type": "object",
                              "minProperties": 1,
                              "allOf": [
                                {
                                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/properties.json",
                                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                  "title": "properties",
                                  "description": "Rules for custom properties",
                                  "patternProperties": {
                                    "^[a-z][a-z0-9_]{0,245}_bin$": {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/binary.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "binary",
                                      "description": "The ​binary data type represents a sequence of bytes. In order to allow pattern matching on custom objects, for all properties that use the binary type, the property name MUST end with '_bin'. The JSON MTI serialization represents this as a base64-­encoded string as specified in RFC4648​. Other serializations SHOULD use a native binary type, if available.",
                                      "type": "string",
                                      "pattern": "^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$"
                                    },
                                    "^[a-z][a-z0-9_]{0,245}_hex$": {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "hex",
                                      "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                                      "type": "string",
                                      "pattern": "^([a-fA-F0-9]{2})+$"
                                    },
                                    "^([a-z][a-z0-9_]{2,249})|id$": {
                                      "anyOf": [
                                        {
                                          "type": "array",
                                          "minItems": 1
                                        },
                                        {
                                          "type": "string"
                                        },
                                        {
                                          "type": "integer"
                                        },
                                        {
                                          "type": "boolean"
                                        },
                                        {
                                          "type": "number"
                                        },
                                        {
                                          "type": "object"
                                        }
                                      ]
                                    }
                                  },
                                  "additionalProperties": false
                                }
                              ]
                            },
                            "^extension-definition--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$": {
                              "allOf": [
                                {
                                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/extension.json",
                                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                  "type": "object",
                                  "minProperties": 1,
                                  "properties": {
                                    "extension_type": {
                                      "description": "The type of extension.",
                                      "type": "string",
                                      "enum": [
                                        "new-sdo",
                                        "new-sco",
                                        "new-sro",
                                        "property-extension",
                                        "toplevel-property-extension"
                                      ]
                                    }
                                  },
                                  "allOf": [
                                    {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/properties.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "properties",
                                      "description": "Rules for custom properties",
                                      "patternProperties": {
                                        "^[a-z][a-z0-9_]{0,245}_bin$": {
                                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/binary.json",
                                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                          "title": "binary",
                                          "description": "The ​binary data type represents a sequence of bytes. In order to allow pattern matching on custom objects, for all properties that use the binary type, the property name MUST end with '_bin'. The JSON MTI serialization represents this as a base64-­encoded string as specified in RFC4648​. Other serializations SHOULD use a native binary type, if available.",
                                          "type": "string",
                                          "pattern": "^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$"
                                        },
                                        "^[a-z][a-z0-9_]{0,245}_hex$": {
                                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                          "title": "hex",
                                          "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                                          "type": "string",
                                          "pattern": "^([a-fA-F0-9]{2})+$"
                                        },
                                        "^([a-z][a-z0-9_]{2,249})|id$": {
                                          "anyOf": [
                                            {
                                              "type": "array",
                                              "minItems": 1
                                            },
                                            {
                                              "type": "string"
                                            },
                                            {
                                              "type": "integer"
                                            },
                                            {
                                              "type": "boolean"
                                            },
                                            {
                                              "type": "number"
                                            },
                                            {
                                              "type": "object"
                                            }
                                          ]
                                        }
                                      },
                                      "additionalProperties": false
                                    }
                                  ],
                                  "required": [
                                    "extension_type"
                                  ],
                                  "definitions": {
                                    "extension-type-enum": {
                                      "type": "string",
                                      "enum": [
                                        "new-sdo",
                                        "new-sco",
                                        "new-sro",
                                        "property-extension",
                                        "toplevel-property-extension"
                                      ]
                                    }
                                  }
                                }
                              ]
                            }
                          },
                          "additionalProperties": false
                        }
                      },
                      "allOf": [
                        {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/properties.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "properties",
                          "description": "Rules for custom properties",
                          "patternProperties": {
                            "^[a-z][a-z0-9_]{0,245}_bin$": {
                              "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/binary.json",
                              "$schema": "http://json-schema.org/draft/2020-12/schema#",
                              "title": "binary",
                              "description": "The ​binary data type represents a sequence of bytes. In order to allow pattern matching on custom objects, for all properties that use the binary type, the property name MUST end with '_bin'. The JSON MTI serialization represents this as a base64-­encoded string as specified in RFC4648​. Other serializations SHOULD use a native binary type, if available.",
                              "type": "string",
                              "pattern": "^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$"
                            },
                            "^[a-z][a-z0-9_]{0,245}_hex$": {
                              "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                              "$schema": "http://json-schema.org/draft/2020-12/schema#",
                              "title": "hex",
                              "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                              "type": "string",
                              "pattern": "^([a-fA-F0-9]{2})+$"
                            },
                            "^([a-z][a-z0-9_]{2,249})|id$": {
                              "anyOf": [
                                {
                                  "type": "array",
                                  "minItems": 1
                                },
                                {
                                  "type": "string"
                                },
                                {
                                  "type": "integer"
                                },
                                {
                                  "type": "boolean"
                                },
                                {
                                  "type": "number"
                                },
                                {
                                  "type": "object"
                                }
                              ]
                            }
                          },
                          "additionalProperties": false
                        }
                      ],
                      "not": {
                        "anyOf": [
                          {
                            "required": [
                              "severity"
                            ]
                          },
                          {
                            "required": [
                              "action"
                            ]
                          },
                          {
                            "required": [
                              "username"
                            ]
                          },
                          {
                            "required": [
                              "phone_numbers"
                            ]
                          }
                        ]
                      },
                      "required": [
                        "type",
                        "id"
                      ]
                    },
                    {
                      "properties": {
                        "type": {
                          "type": "string",
                          "description": "The value of this property MUST be `network-traffic`.",
                          "enum": [
                            "network-traffic"
                          ]
                        },
                        "id": {
                          "title": "id",
                          "pattern": "^network-traffic--"
                        },
                        "extensions": {
                          "description": "The Network Traffic Object defines the following extensions. In addition to these, producers MAY create their own. Extensions: http-ext, tcp-ext, icmp-ext, socket-ext",
                          "allOf": [
                            {
                              "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/dictionary.json",
                              "$schema": "http://json-schema.org/draft/2020-12/schema#",
                              "title": "dictionary",
                              "description": "A dictionary captures a set of key/value pairs",
                              "type": "object",
                              "minProperties": 1,
                              "patternProperties": {
                                "^[a-zA-Z0-9_-]{0,250}$": {
                                  "anyOf": [
                                    {
                                      "type": "array",
                                      "minItems": 1
                                    },
                                    {
                                      "type": "string"
                                    },
                                    {
                                      "type": "integer"
                                    },
                                    {
                                      "type": "boolean"
                                    },
                                    {
                                      "type": "number"
                                    },
                                    {
                                      "type": "object"
                                    }
                                  ]
                                }
                              },
                              "additionalProperties": false
                            }
                          ],
                          "patternProperties": {
                            "^http-request-ext$": {
                              "type": "object",
                              "description": "The HTTP request extension specifies a default extension for capturing network traffic properties specific to HTTP requests.",
                              "properties": {
                                "request_method": {
                                  "type": "string",
                                  "description": "Specifies the HTTP method portion of the HTTP request line, as a lowercase string."
                                },
                                "request_value": {
                                  "type": "string",
                                  "description": "Specifies the value (typically a resource path) portion of the HTTP request line."
                                },
                                "request_version": {
                                  "type": "string",
                                  "description": "Specifies the HTTP version portion of the HTTP request line, as a lowercase string."
                                },
                                "request_header": {
                                  "allOf": [
                                    {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/dictionary.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "dictionary",
                                      "description": "A dictionary captures a set of key/value pairs",
                                      "type": "object",
                                      "minProperties": 1,
                                      "patternProperties": {
                                        "^[a-zA-Z0-9_-]{0,250}$": {
                                          "anyOf": [
                                            {
                                              "type": "array",
                                              "minItems": 1
                                            },
                                            {
                                              "type": "string"
                                            },
                                            {
                                              "type": "integer"
                                            },
                                            {
                                              "type": "boolean"
                                            },
                                            {
                                              "type": "number"
                                            },
                                            {
                                              "type": "object"
                                            }
                                          ]
                                        }
                                      },
                                      "additionalProperties": false
                                    }
                                  ],
                                  "description": "Specifies all of the HTTP header fields that may be found in the HTTP client request, as a dictionary.",
                                  "patternProperties": {
                                    "^.+$": {
                                      "type": "array",
                                      "items": {
                                        "type": "string"
                                      }
                                    }
                                  },
                                  "additionalProperties": false
                                },
                                "message_body_length": {
                                  "type": "integer",
                                  "description": "Specifies the length of the HTTP message body, if included, in bytes."
                                },
                                "message_body_data_ref": {
                                  "description": "Specifies the data contained in the HTTP message body, if included.",
                                  "type": "string"
                                }
                              },
                              "required": [
                                "request_method",
                                "request_value"
                              ]
                            },
                            "^icmp-ext$": {
                              "type": "object",
                              "description": "The ICMP extension specifies a default extension for capturing network traffic properties specific to ICMP.",
                              "properties": {
                                "icmp_type_hex": {
                                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                  "title": "hex",
                                  "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                                  "type": "string",
                                  "pattern": "^([a-fA-F0-9]{2})+$"
                                },
                                "icmp_code_hex": {
                                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                  "title": "hex",
                                  "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                                  "type": "string",
                                  "pattern": "^([a-fA-F0-9]{2})+$"
                                }
                              },
                              "required": [
                                "icmp_type_hex",
                                "icmp_code_hex"
                              ]
                            },
                            "^socket-ext$": {
                              "type": "object",
                              "description": "The Network Socket extension specifies a default extension for capturing network traffic properties associated with network sockets.",
                              "properties": {
                                "address_family": {
                                  "type": "string",
                                  "description": "Specifies the address family (AF_*) that the socket is configured for.",
                                  "enum": [
                                    "AF_UNSPEC",
                                    "AF_INET",
                                    "AF_IPX",
                                    "AF_APPLETALK",
                                    "AF_NETBIOS",
                                    "AF_INET6",
                                    "AF_IRDA",
                                    "AF_BTH"
                                  ]
                                },
                                "is_blocking": {
                                  "type": "boolean",
                                  "description": "Specifies whether the socket is in blocking mode."
                                },
                                "is_listening": {
                                  "type": "boolean",
                                  "description": "Specifies whether the socket is in listening mode."
                                },
                                "options": {
                                  "allOf": [
                                    {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/dictionary.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "dictionary",
                                      "description": "A dictionary captures a set of key/value pairs",
                                      "type": "object",
                                      "minProperties": 1,
                                      "patternProperties": {
                                        "^[a-zA-Z0-9_-]{0,250}$": {
                                          "anyOf": [
                                            {
                                              "type": "array",
                                              "minItems": 1
                                            },
                                            {
                                              "type": "string"
                                            },
                                            {
                                              "type": "integer"
                                            },
                                            {
                                              "type": "boolean"
                                            },
                                            {
                                              "type": "number"
                                            },
                                            {
                                              "type": "object"
                                            }
                                          ]
                                        }
                                      },
                                      "additionalProperties": false
                                    }
                                  ],
                                  "description": "Specifies any options (SO_*) that may be used by the socket, as a dictionary.",
                                  "patternProperties": {
                                    "^(SO|ICMP|ICMP6|IP|IPV6|MCAST|TCP|IRLMP)(_[A-Z]+)+$": {
                                      "type": "integer"
                                    }
                                  },
                                  "additionalProperties": false
                                },
                                "socket_type": {
                                  "type": "string",
                                  "description": "Specifies the type of the socket.",
                                  "enum": [
                                    "SOCK_STREAM",
                                    "SOCK_DGRAM",
                                    "SOCK_RAW",
                                    "SOCK_RDM",
                                    "SOCK_SEQPACKET"
                                  ]
                                },
                                "socket_descriptor": {
                                  "type": "integer",
                                  "minimum": 0,
                                  "description": "Specifies the socket file descriptor value associated with the socket, as a non-negative integer."
                                },
                                "socket_handle": {
                                  "type": "integer",
                                  "description": "Specifies the handle or inode value associated with the socket."
                                }
                              },
                              "required": [
                                "address_family"
                              ]
                            },
                            "^tcp-ext$": {
                              "type": "object",
                              "description": "The TCP extension specifies a default extension for capturing network traffic properties specific to TCP.",
                              "allOf": [
                                {
                                  "properties": {
                                    "src_flags_hex": {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "hex",
                                      "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                                      "type": "string",
                                      "pattern": "^([a-fA-F0-9]{2})+$"
                                    },
                                    "dst_flags_hex": {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "hex",
                                      "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                                      "type": "string",
                                      "pattern": "^([a-fA-F0-9]{2})+$"
                                    }
                                  }
                                },
                                {
                                  "anyOf": [
                                    {
                                      "required": [
                                        "src_flags_hex"
                                      ]
                                    },
                                    {
                                      "required": [
                                        "dst_flags_hex"
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          },
                          "additionalProperties": {
                            "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/dictionary.json",
                            "$schema": "http://json-schema.org/draft/2020-12/schema#",
                            "title": "dictionary",
                            "description": "A dictionary captures a set of key/value pairs",
                            "type": "object",
                            "minProperties": 1,
                            "patternProperties": {
                              "^[a-zA-Z0-9_-]{0,250}$": {
                                "anyOf": [
                                  {
                                    "type": "array",
                                    "minItems": 1
                                  },
                                  {
                                    "type": "string"
                                  },
                                  {
                                    "type": "integer"
                                  },
                                  {
                                    "type": "boolean"
                                  },
                                  {
                                    "type": "number"
                                  },
                                  {
                                    "type": "object"
                                  }
                                ]
                              }
                            },
                            "additionalProperties": false
                          }
                        },
                        "start": {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/timestamp.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "timestamp",
                          "description": "Represents timestamps across the CTI specifications. The format is an RFC3339 timestamp, with a required timezone specification of 'Z'.",
                          "type": "string",
                          "pattern": "^[0-9]{4}-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])T([01][0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9]|60)(\\.[0-9]+)?Z$"
                        },
                        "end": {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/timestamp.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "timestamp",
                          "description": "Represents timestamps across the CTI specifications. The format is an RFC3339 timestamp, with a required timezone specification of 'Z'.",
                          "type": "string",
                          "pattern": "^[0-9]{4}-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])T([01][0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9]|60)(\\.[0-9]+)?Z$"
                        },
                        "src_ref": {
                          "description": "Specifies the source of the network traffic, as a reference to an Observable Object.",
                          "type": "string"
                        },
                        "dst_ref": {
                          "description": "Specifies the destination of the network traffic, as a reference to an Observable Object.",
                          "type": "string"
                        },
                        "src_port": {
                          "type": "integer",
                          "description": "Specifies the source port used in the network traffic, as an integer. The port value MUST be in the range of 0 - 65535.",
                          "minimum": 0,
                          "maximum": 65535
                        },
                        "dst_port": {
                          "type": "integer",
                          "description": "Specifies the destination port used in the network traffic, as an integer. The port value MUST be in the range of 0 - 65535.",
                          "minimum": 0,
                          "maximum": 65535
                        },
                        "protocols": {
                          "type": "array",
                          "description": "Specifies the protocols observed in the network traffic, along with their corresponding state.",
                          "items": {
                            "type": "string"
                          },
                          "minItems": 1
                        },
                        "src_byte_count": {
                          "type": "integer",
                          "description": "Specifies the number of bytes sent from the source to the destination."
                        },
                        "dst_byte_count": {
                          "type": "integer",
                          "description": "Specifies the number of bytes sent from the destination to the source."
                        },
                        "src_packets": {
                          "type": "integer",
                          "description": "Specifies the number of packets sent from the source to the destination."
                        },
                        "dst_packets": {
                          "type": "integer",
                          "description": "Specifies the number of packets sent destination to the source."
                        },
                        "ipfix": {
                          "description": "Specifies any IP Flow Information Export (IPFIX) data for the traffic.",
                          "allOf": [
                            {
                              "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/dictionary.json",
                              "$schema": "http://json-schema.org/draft/2020-12/schema#",
                              "title": "dictionary",
                              "description": "A dictionary captures a set of key/value pairs",
                              "type": "object",
                              "minProperties": 1,
                              "patternProperties": {
                                "^[a-zA-Z0-9_-]{0,250}$": {
                                  "anyOf": [
                                    {
                                      "type": "array",
                                      "minItems": 1
                                    },
                                    {
                                      "type": "string"
                                    },
                                    {
                                      "type": "integer"
                                    },
                                    {
                                      "type": "boolean"
                                    },
                                    {
                                      "type": "number"
                                    },
                                    {
                                      "type": "object"
                                    }
                                  ]
                                }
                              },
                              "additionalProperties": false
                            }
                          ],
                          "patternProperties": {
                            "^[a-zA-Z0-9_-]{0,250}$": {
                              "anyOf": [
                                {
                                  "type": "string"
                                },
                                {
                                  "type": "integer"
                                }
                              ]
                            }
                          }
                        },
                        "src_payload_ref": {
                          "description": "Specifies the bytes sent from the source to the destination.",
                          "type": "string"
                        },
                        "dst_payload_ref": {
                          "description": "Specifies the bytes sent from the source to the destination.",
                          "type": "string"
                        },
                        "encapsulates_refs": {
                          "type": "array",
                          "description": "Links to other network-traffic objects encapsulated by a network-traffic.",
                          "items": {
                            "type": "string"
                          },
                          "minItems": 1
                        },
                        "encapsulated_by_ref": {
                          "description": "Links to another network-traffic object which encapsulates this object.",
                          "type": "string"
                        }
                      }
                    }
                  ],
                  "required": [
                    "protocols"
                  ],
                  "anyOf": [
                    {
                      "required": [
                        "src_ref"
                      ]
                    },
                    {
                      "required": [
                        "dst_ref"
                      ]
                    }
                  ],
                  "oneOf": [
                    {
                      "properties": {
                        "is_active": {
                          "type": "boolean",
                          "enum": [
                            false
                          ],
                          "description": "Indicates whether the network traffic is still ongoing."
                        }
                      },
                      "required": [
                        "is_active"
                      ]
                    },
                    {
                      "properties": {
                        "is_active": {
                          "type": "boolean",
                          "enum": [
                            true
                          ],
                          "description": "Indicates whether the network traffic is still ongoing."
                        }
                      },
                      "required": [
                        "is_active"
                      ],
                      "not": {
                        "required": [
                          "end"
                        ]
                      }
                    },
                    {
                      "not": {
                        "required": [
                          "is_active"
                        ]
                      }
                    }
                  ],
                  "definitions": {
                    "network-traffic-extensions-dictionary": {
                      "allOf": [
                        {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/dictionary.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "dictionary",
                          "description": "A dictionary captures a set of key/value pairs",
                          "type": "object",
                          "minProperties": 1,
                          "patternProperties": {
                            "^[a-zA-Z0-9_-]{0,250}$": {
                              "anyOf": [
                                {
                                  "type": "array",
                                  "minItems": 1
                                },
                                {
                                  "type": "string"
                                },
                                {
                                  "type": "integer"
                                },
                                {
                                  "type": "boolean"
                                },
                                {
                                  "type": "number"
                                },
                                {
                                  "type": "object"
                                }
                              ]
                            }
                          },
                          "additionalProperties": false
                        }
                      ],
                      "patternProperties": {
                        "^http-request-ext$": {
                          "type": "object",
                          "description": "The HTTP request extension specifies a default extension for capturing network traffic properties specific to HTTP requests.",
                          "properties": {
                            "request_method": {
                              "type": "string",
                              "description": "Specifies the HTTP method portion of the HTTP request line, as a lowercase string."
                            },
                            "request_value": {
                              "type": "string",
                              "description": "Specifies the value (typically a resource path) portion of the HTTP request line."
                            },
                            "request_version": {
                              "type": "string",
                              "description": "Specifies the HTTP version portion of the HTTP request line, as a lowercase string."
                            },
                            "request_header": {
                              "allOf": [
                                {
                                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/dictionary.json",
                                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                  "title": "dictionary",
                                  "description": "A dictionary captures a set of key/value pairs",
                                  "type": "object",
                                  "minProperties": 1,
                                  "patternProperties": {
                                    "^[a-zA-Z0-9_-]{0,250}$": {
                                      "anyOf": [
                                        {
                                          "type": "array",
                                          "minItems": 1
                                        },
                                        {
                                          "type": "string"
                                        },
                                        {
                                          "type": "integer"
                                        },
                                        {
                                          "type": "boolean"
                                        },
                                        {
                                          "type": "number"
                                        },
                                        {
                                          "type": "object"
                                        }
                                      ]
                                    }
                                  },
                                  "additionalProperties": false
                                }
                              ],
                              "description": "Specifies all of the HTTP header fields that may be found in the HTTP client request, as a dictionary.",
                              "patternProperties": {
                                "^.+$": {
                                  "type": "array",
                                  "items": {
                                    "type": "string"
                                  }
                                }
                              },
                              "additionalProperties": false
                            },
                            "message_body_length": {
                              "type": "integer",
                              "description": "Specifies the length of the HTTP message body, if included, in bytes."
                            },
                            "message_body_data_ref": {
                              "description": "Specifies the data contained in the HTTP message body, if included.",
                              "type": "string"
                            }
                          },
                          "required": [
                            "request_method",
                            "request_value"
                          ]
                        },
                        "^icmp-ext$": {
                          "type": "object",
                          "description": "The ICMP extension specifies a default extension for capturing network traffic properties specific to ICMP.",
                          "properties": {
                            "icmp_type_hex": {
                              "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                              "$schema": "http://json-schema.org/draft/2020-12/schema#",
                              "title": "hex",
                              "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                              "type": "string",
                              "pattern": "^([a-fA-F0-9]{2})+$"
                            },
                            "icmp_code_hex": {
                              "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                              "$schema": "http://json-schema.org/draft/2020-12/schema#",
                              "title": "hex",
                              "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                              "type": "string",
                              "pattern": "^([a-fA-F0-9]{2})+$"
                            }
                          },
                          "required": [
                            "icmp_type_hex",
                            "icmp_code_hex"
                          ]
                        },
                        "^socket-ext$": {
                          "type": "object",
                          "description": "The Network Socket extension specifies a default extension for capturing network traffic properties associated with network sockets.",
                          "properties": {
                            "address_family": {
                              "type": "string",
                              "description": "Specifies the address family (AF_*) that the socket is configured for.",
                              "enum": [
                                "AF_UNSPEC",
                                "AF_INET",
                                "AF_IPX",
                                "AF_APPLETALK",
                                "AF_NETBIOS",
                                "AF_INET6",
                                "AF_IRDA",
                                "AF_BTH"
                              ]
                            },
                            "is_blocking": {
                              "type": "boolean",
                              "description": "Specifies whether the socket is in blocking mode."
                            },
                            "is_listening": {
                              "type": "boolean",
                              "description": "Specifies whether the socket is in listening mode."
                            },
                            "options": {
                              "allOf": [
                                {
                                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/dictionary.json",
                                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                  "title": "dictionary",
                                  "description": "A dictionary captures a set of key/value pairs",
                                  "type": "object",
                                  "minProperties": 1,
                                  "patternProperties": {
                                    "^[a-zA-Z0-9_-]{0,250}$": {
                                      "anyOf": [
                                        {
                                          "type": "array",
                                          "minItems": 1
                                        },
                                        {
                                          "type": "string"
                                        },
                                        {
                                          "type": "integer"
                                        },
                                        {
                                          "type": "boolean"
                                        },
                                        {
                                          "type": "number"
                                        },
                                        {
                                          "type": "object"
                                        }
                                      ]
                                    }
                                  },
                                  "additionalProperties": false
                                }
                              ],
                              "description": "Specifies any options (SO_*) that may be used by the socket, as a dictionary.",
                              "patternProperties": {
                                "^(SO|ICMP|ICMP6|IP|IPV6|MCAST|TCP|IRLMP)(_[A-Z]+)+$": {
                                  "type": "integer"
                                }
                              },
                              "additionalProperties": false
                            },
                            "socket_type": {
                              "type": "string",
                              "description": "Specifies the type of the socket.",
                              "enum": [
                                "SOCK_STREAM",
                                "SOCK_DGRAM",
                                "SOCK_RAW",
                                "SOCK_RDM",
                                "SOCK_SEQPACKET"
                              ]
                            },
                            "socket_descriptor": {
                              "type": "integer",
                              "minimum": 0,
                              "description": "Specifies the socket file descriptor value associated with the socket, as a non-negative integer."
                            },
                            "socket_handle": {
                              "type": "integer",
                              "description": "Specifies the handle or inode value associated with the socket."
                            }
                          },
                          "required": [
                            "address_family"
                          ]
                        },
                        "^tcp-ext$": {
                          "type": "object",
                          "description": "The TCP extension specifies a default extension for capturing network traffic properties specific to TCP.",
                          "allOf": [
                            {
                              "properties": {
                                "src_flags_hex": {
                                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                  "title": "hex",
                                  "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                                  "type": "string",
                                  "pattern": "^([a-fA-F0-9]{2})+$"
                                },
                                "dst_flags_hex": {
                                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                  "title": "hex",
                                  "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                                  "type": "string",
                                  "pattern": "^([a-fA-F0-9]{2})+$"
                                }
                              }
                            },
                            {
                              "anyOf": [
                                {
                                  "required": [
                                    "src_flags_hex"
                                  ]
                                },
                                {
                                  "required": [
                                    "dst_flags_hex"
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      },
                      "additionalProperties": {
                        "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/dictionary.json",
                        "$schema": "http://json-schema.org/draft/2020-12/schema#",
                        "title": "dictionary",
                        "description": "A dictionary captures a set of key/value pairs",
                        "type": "object",
                        "minProperties": 1,
                        "patternProperties": {
                          "^[a-zA-Z0-9_-]{0,250}$": {
                            "anyOf": [
                              {
                                "type": "array",
                                "minItems": 1
                              },
                              {
                                "type": "string"
                              },
                              {
                                "type": "integer"
                              },
                              {
                                "type": "boolean"
                              },
                              {
                                "type": "number"
                              },
                              {
                                "type": "object"
                              }
                            ]
                          }
                        },
                        "additionalProperties": false
                      }
                    }
                  }
                },
                {
                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/observables/process.json",
                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                  "title": "process",
                  "description": "The Process Object represents common properties of an instance of a computer program as executed on an operating system.",
                  "type": "object",
                  "allOf": [
                    {
                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/cyber-observable-core.json",
                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                      "title": "cyber-observable-core",
                      "description": "Common properties and behavior across all Cyber Observable Objects.",
                      "type": "object",
                      "properties": {
                        "type": {
                          "type": "string",
                          "pattern": "^([a-z][a-z0-9]*)+(-[a-z0-9]+)*\\-?$",
                          "minLength": 3,
                          "maxLength": 250,
                          "description": "Indicates that this object is an Observable Object. The value of this property MUST be a valid Observable Object type name, but to allow for custom objects this has been removed from the schema.",
                          "not": {
                            "enum": [
                              "action"
                            ]
                          }
                        },
                        "spec_version": {
                          "type": "string",
                          "enum": [
                            "2.0",
                            "2.1"
                          ],
                          "description": "The version of the STIX specification used to represent the content in this cyber-observable."
                        },
                        "object_marking_refs": {
                          "type": "array",
                          "description": "The list of marking-definition objects to be applied to this object.",
                          "items": {
                            "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/identifier.json",
                            "$schema": "http://json-schema.org/draft/2020-12/schema#",
                            "title": "identifier",
                            "description": "Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.",
                            "type": "string",
                            "pattern": "^[a-z][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
                          },
                          "minItems": 1
                        },
                        "granular_markings": {
                          "type": "array",
                          "description": "The set of granular markings that apply to this object.",
                          "items": {
                            "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/granular-marking.json",
                            "$schema": "http://json-schema.org/draft/2020-12/schema#",
                            "title": "granular-marking",
                            "description": "The granular-marking type defines how the list of marking-definition objects referenced by the marking_refs property to apply to a set of content identified by the list of selectors in the selectors property.",
                            "type": "object",
                            "properties": {
                              "selectors": {
                                "type": "array",
                                "description": "A list of selectors for content contained within the STIX object in which this property appears.",
                                "items": {
                                  "type": "string",
                                  "pattern": "^([a-z0-9_-]{3,249}(\\.(\\[\\d+\\]|[a-z0-9_-]{1,250}))*|id)$"
                                },
                                "minItems": 1
                              },
                              "lang": {
                                "type": "string",
                                "description": "Identifies the language of the text identified by this marking."
                              },
                              "marking_ref": {
                                "allOf": [
                                  {
                                    "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/identifier.json",
                                    "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                    "title": "identifier",
                                    "description": "Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.",
                                    "type": "string",
                                    "pattern": "^[a-z][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
                                  },
                                  {
                                    "pattern": "^marking-definition--",
                                    "description": "The marking_ref property specifies the ID of the marking-definition object that describes the marking."
                                  }
                                ]
                              }
                            },
                            "required": [
                              "selectors",
                              "marking_ref"
                            ]
                          },
                          "minItems": 1
                        },
                        "defanged": {
                          "type": "boolean",
                          "description": "Defines whether or not the data contained within the object has been defanged."
                        },
                        "id": {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/identifier.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "identifier",
                          "description": "Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.",
                          "type": "string",
                          "pattern": "^[a-z][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
                        },
                        "extensions": {
                          "description": "Specifies any extensions of the object, as a dictionary.",
                          "type": "object",
                          "minProperties": 1,
                          "patternProperties": {
                            "^([a-z][a-z0-9]*)+(-[a-z0-9]+)*\\-ext$": {
                              "type": "object",
                              "minProperties": 1,
                              "allOf": [
                                {
                                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/properties.json",
                                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                  "title": "properties",
                                  "description": "Rules for custom properties",
                                  "patternProperties": {
                                    "^[a-z][a-z0-9_]{0,245}_bin$": {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/binary.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "binary",
                                      "description": "The ​binary data type represents a sequence of bytes. In order to allow pattern matching on custom objects, for all properties that use the binary type, the property name MUST end with '_bin'. The JSON MTI serialization represents this as a base64-­encoded string as specified in RFC4648​. Other serializations SHOULD use a native binary type, if available.",
                                      "type": "string",
                                      "pattern": "^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$"
                                    },
                                    "^[a-z][a-z0-9_]{0,245}_hex$": {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "hex",
                                      "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                                      "type": "string",
                                      "pattern": "^([a-fA-F0-9]{2})+$"
                                    },
                                    "^([a-z][a-z0-9_]{2,249})|id$": {
                                      "anyOf": [
                                        {
                                          "type": "array",
                                          "minItems": 1
                                        },
                                        {
                                          "type": "string"
                                        },
                                        {
                                          "type": "integer"
                                        },
                                        {
                                          "type": "boolean"
                                        },
                                        {
                                          "type": "number"
                                        },
                                        {
                                          "type": "object"
                                        }
                                      ]
                                    }
                                  },
                                  "additionalProperties": false
                                }
                              ]
                            },
                            "^extension-definition--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$": {
                              "allOf": [
                                {
                                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/extension.json",
                                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                  "type": "object",
                                  "minProperties": 1,
                                  "properties": {
                                    "extension_type": {
                                      "description": "The type of extension.",
                                      "type": "string",
                                      "enum": [
                                        "new-sdo",
                                        "new-sco",
                                        "new-sro",
                                        "property-extension",
                                        "toplevel-property-extension"
                                      ]
                                    }
                                  },
                                  "allOf": [
                                    {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/properties.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "properties",
                                      "description": "Rules for custom properties",
                                      "patternProperties": {
                                        "^[a-z][a-z0-9_]{0,245}_bin$": {
                                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/binary.json",
                                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                          "title": "binary",
                                          "description": "The ​binary data type represents a sequence of bytes. In order to allow pattern matching on custom objects, for all properties that use the binary type, the property name MUST end with '_bin'. The JSON MTI serialization represents this as a base64-­encoded string as specified in RFC4648​. Other serializations SHOULD use a native binary type, if available.",
                                          "type": "string",
                                          "pattern": "^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$"
                                        },
                                        "^[a-z][a-z0-9_]{0,245}_hex$": {
                                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                          "title": "hex",
                                          "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                                          "type": "string",
                                          "pattern": "^([a-fA-F0-9]{2})+$"
                                        },
                                        "^([a-z][a-z0-9_]{2,249})|id$": {
                                          "anyOf": [
                                            {
                                              "type": "array",
                                              "minItems": 1
                                            },
                                            {
                                              "type": "string"
                                            },
                                            {
                                              "type": "integer"
                                            },
                                            {
                                              "type": "boolean"
                                            },
                                            {
                                              "type": "number"
                                            },
                                            {
                                              "type": "object"
                                            }
                                          ]
                                        }
                                      },
                                      "additionalProperties": false
                                    }
                                  ],
                                  "required": [
                                    "extension_type"
                                  ],
                                  "definitions": {
                                    "extension-type-enum": {
                                      "type": "string",
                                      "enum": [
                                        "new-sdo",
                                        "new-sco",
                                        "new-sro",
                                        "property-extension",
                                        "toplevel-property-extension"
                                      ]
                                    }
                                  }
                                }
                              ]
                            }
                          },
                          "additionalProperties": false
                        }
                      },
                      "allOf": [
                        {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/properties.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "properties",
                          "description": "Rules for custom properties",
                          "patternProperties": {
                            "^[a-z][a-z0-9_]{0,245}_bin$": {
                              "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/binary.json",
                              "$schema": "http://json-schema.org/draft/2020-12/schema#",
                              "title": "binary",
                              "description": "The ​binary data type represents a sequence of bytes. In order to allow pattern matching on custom objects, for all properties that use the binary type, the property name MUST end with '_bin'. The JSON MTI serialization represents this as a base64-­encoded string as specified in RFC4648​. Other serializations SHOULD use a native binary type, if available.",
                              "type": "string",
                              "pattern": "^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$"
                            },
                            "^[a-z][a-z0-9_]{0,245}_hex$": {
                              "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                              "$schema": "http://json-schema.org/draft/2020-12/schema#",
                              "title": "hex",
                              "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                              "type": "string",
                              "pattern": "^([a-fA-F0-9]{2})+$"
                            },
                            "^([a-z][a-z0-9_]{2,249})|id$": {
                              "anyOf": [
                                {
                                  "type": "array",
                                  "minItems": 1
                                },
                                {
                                  "type": "string"
                                },
                                {
                                  "type": "integer"
                                },
                                {
                                  "type": "boolean"
                                },
                                {
                                  "type": "number"
                                },
                                {
                                  "type": "object"
                                }
                              ]
                            }
                          },
                          "additionalProperties": false
                        }
                      ],
                      "not": {
                        "anyOf": [
                          {
                            "required": [
                              "severity"
                            ]
                          },
                          {
                            "required": [
                              "action"
                            ]
                          },
                          {
                            "required": [
                              "username"
                            ]
                          },
                          {
                            "required": [
                              "phone_numbers"
                            ]
                          }
                        ]
                      },
                      "required": [
                        "type",
                        "id"
                      ]
                    },
                    {
                      "properties": {
                        "type": {
                          "type": "string",
                          "description": "The value of this property MUST be `process`.",
                          "enum": [
                            "process"
                          ]
                        },
                        "id": {
                          "title": "id",
                          "pattern": "^process--"
                        },
                        "extensions": {
                          "description": "The Process Object defines the following extensions. In addition to these, producers MAY create their own. Extensions: windows-process-ext, windows-service-ext.",
                          "allOf": [
                            {
                              "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/dictionary.json",
                              "$schema": "http://json-schema.org/draft/2020-12/schema#",
                              "title": "dictionary",
                              "description": "A dictionary captures a set of key/value pairs",
                              "type": "object",
                              "minProperties": 1,
                              "patternProperties": {
                                "^[a-zA-Z0-9_-]{0,250}$": {
                                  "anyOf": [
                                    {
                                      "type": "array",
                                      "minItems": 1
                                    },
                                    {
                                      "type": "string"
                                    },
                                    {
                                      "type": "integer"
                                    },
                                    {
                                      "type": "boolean"
                                    },
                                    {
                                      "type": "number"
                                    },
                                    {
                                      "type": "object"
                                    }
                                  ]
                                }
                              },
                              "additionalProperties": false
                            }
                          ],
                          "patternProperties": {
                            "^windows-process-ext$": {
                              "type": "object",
                              "description": "The Windows Process extension specifies a default extension for capturing properties specific to Windows processes.",
                              "allOf": [
                                {
                                  "properties": {
                                    "aslr_enabled": {
                                      "type": "boolean",
                                      "description": "Specifies whether Address Space Layout Randomization (ASLR) is enabled for the process."
                                    },
                                    "dep_enabled": {
                                      "type": "boolean",
                                      "description": "Specifies whether Data Execution Prevention (DEP) is enabled for the process."
                                    },
                                    "priority": {
                                      "type": "string",
                                      "description": "Specifies the current priority class of the process in Windows."
                                    },
                                    "owner_sid": {
                                      "type": "string",
                                      "description": "Specifies the Security ID (SID) value of the owner of the process."
                                    },
                                    "window_title": {
                                      "type": "string",
                                      "description": "Specifies the title of the main window of the process."
                                    },
                                    "startup_info": {
                                      "description": "Specifies the STARTUP_INFO struct used by the process, as a dictionary.",
                                      "allOf": [
                                        {
                                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/dictionary.json",
                                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                          "title": "dictionary",
                                          "description": "A dictionary captures a set of key/value pairs",
                                          "type": "object",
                                          "minProperties": 1,
                                          "patternProperties": {
                                            "^[a-zA-Z0-9_-]{0,250}$": {
                                              "anyOf": [
                                                {
                                                  "type": "array",
                                                  "minItems": 1
                                                },
                                                {
                                                  "type": "string"
                                                },
                                                {
                                                  "type": "integer"
                                                },
                                                {
                                                  "type": "boolean"
                                                },
                                                {
                                                  "type": "number"
                                                },
                                                {
                                                  "type": "object"
                                                }
                                              ]
                                            }
                                          },
                                          "additionalProperties": false
                                        }
                                      ],
                                      "patternProperties": {
                                        "^lpDesktop|lpTitle|dwFillAttribute|dwFlags|wShowWindow|hStdInput|hStdOutput|hStdError$": {
                                          "type": "string"
                                        },
                                        "^lpReserved|lpReserved2$": {
                                          "type": "null"
                                        },
                                        "^cb|dwX|dwY|dwXSize|dwYSize|dwXCountChars|dwYCountChars$": {
                                          "type": "integer"
                                        },
                                        "^cbReserved2$": {
                                          "type": "integer",
                                          "minimum": 0,
                                          "maximum": 0
                                        }
                                      },
                                      "additionalProperties": false
                                    },
                                    "integrity_level": {
                                      "description": "Specifies the Windows integrity level, or trustworthiness, of the process.",
                                      "type": "string",
                                      "enum": [
                                        "low",
                                        "medium",
                                        "high",
                                        "system"
                                      ]
                                    }
                                  }
                                },
                                {
                                  "anyOf": [
                                    {
                                      "required": [
                                        "aslr_enabled"
                                      ]
                                    },
                                    {
                                      "required": [
                                        "dep_enabled"
                                      ]
                                    },
                                    {
                                      "required": [
                                        "priority"
                                      ]
                                    },
                                    {
                                      "required": [
                                        "owner_sid"
                                      ]
                                    },
                                    {
                                      "required": [
                                        "window_title"
                                      ]
                                    },
                                    {
                                      "required": [
                                        "startup_info"
                                      ]
                                    }
                                  ]
                                }
                              ]
                            },
                            "^windows-service-ext$": {
                              "type": "object",
                              "description": "The Windows Service extension specifies a default extension for capturing properties specific to Windows services.",
                              "properties": {
                                "service_name": {
                                  "type": "string",
                                  "description": "Specifies the name of the service."
                                },
                                "descriptions": {
                                  "type": "array",
                                  "description": "Specifies the descriptions defined for the service.",
                                  "items": {
                                    "type": "string"
                                  },
                                  "minItems": 1
                                },
                                "display_name": {
                                  "type": "string",
                                  "description": "Specifies the displayed name of the service in Windows GUI controls."
                                },
                                "group_name": {
                                  "type": "string",
                                  "description": "Specifies the name of the load ordering group of which the service is a member."
                                },
                                "start_type": {
                                  "type": "string",
                                  "description": "Specifies the start options defined for the service. windows-service-start-enum",
                                  "enum": [
                                    "SERVICE_AUTO_START",
                                    "SERVICE_BOOT_START",
                                    "SERVICE_DEMAND_START",
                                    "SERVICE_DISABLED",
                                    "SERVICE_SYSTEM_ALERT"
                                  ]
                                },
                                "service_dll_refs": {
                                  "type": "array",
                                  "description": "Specifies the DLLs loaded by the service, as a reference to one or more File Objects.",
                                  "items": {
                                    "type": "string"
                                  },
                                  "minItems": 1
                                },
                                "service_type": {
                                  "type": "string",
                                  "description": "Specifies the type of the service. windows-service-enum",
                                  "enum": [
                                    "SERVICE_KERNEL_DRIVER",
                                    "SERVICE_FILE_SYSTEM_DRIVER",
                                    "SERVICE_WIN32_OWN_PROCESS",
                                    "SERVICE_WIN32_SHARE_PROCESS"
                                  ]
                                },
                                "service_status": {
                                  "type": "string",
                                  "description": "Specifies the current status of the service. windows-service-status-enum",
                                  "enum": [
                                    "SERVICE_CONTINUE_PENDING",
                                    "SERVICE_PAUSE_PENDING",
                                    "SERVICE_PAUSED",
                                    "SERVICE_RUNNING",
                                    "SERVICE_START_PENDING",
                                    "SERVICE_STOP_PENDING",
                                    "SERVICE_STOPPED"
                                  ]
                                }
                              },
                              "anyOf": [
                                {
                                  "required": [
                                    "service_name"
                                  ]
                                },
                                {
                                  "required": [
                                    "descriptions"
                                  ]
                                },
                                {
                                  "required": [
                                    "display_name"
                                  ]
                                },
                                {
                                  "required": [
                                    "group_name"
                                  ]
                                },
                                {
                                  "required": [
                                    "start_type"
                                  ]
                                },
                                {
                                  "required": [
                                    "service_dll_refs"
                                  ]
                                },
                                {
                                  "required": [
                                    "service_type"
                                  ]
                                },
                                {
                                  "required": [
                                    "service_status"
                                  ]
                                }
                              ]
                            }
                          },
                          "additionalProperties": {
                            "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/dictionary.json",
                            "$schema": "http://json-schema.org/draft/2020-12/schema#",
                            "title": "dictionary",
                            "description": "A dictionary captures a set of key/value pairs",
                            "type": "object",
                            "minProperties": 1,
                            "patternProperties": {
                              "^[a-zA-Z0-9_-]{0,250}$": {
                                "anyOf": [
                                  {
                                    "type": "array",
                                    "minItems": 1
                                  },
                                  {
                                    "type": "string"
                                  },
                                  {
                                    "type": "integer"
                                  },
                                  {
                                    "type": "boolean"
                                  },
                                  {
                                    "type": "number"
                                  },
                                  {
                                    "type": "object"
                                  }
                                ]
                              }
                            },
                            "additionalProperties": false
                          }
                        },
                        "is_hidden": {
                          "type": "boolean",
                          "description": "Specifies whether the process is hidden."
                        },
                        "pid": {
                          "type": "integer",
                          "description": "Specifies the Process ID, or PID, of the process."
                        },
                        "created_time": {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/timestamp.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "timestamp",
                          "description": "Represents timestamps across the CTI specifications. The format is an RFC3339 timestamp, with a required timezone specification of 'Z'.",
                          "type": "string",
                          "pattern": "^[0-9]{4}-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])T([01][0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9]|60)(\\.[0-9]+)?Z$"
                        },
                        "cwd": {
                          "type": "string",
                          "description": "Specifies the current working directory of the process."
                        },
                        "command_line": {
                          "type": "string",
                          "description": "Specifies the full command line used in executing the process, including the process name (which may be specified individually via the binary_ref.name property) and any arguments."
                        },
                        "environment_variables": {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/dictionary.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "dictionary",
                          "description": "A dictionary captures a set of key/value pairs",
                          "type": "object",
                          "minProperties": 1,
                          "patternProperties": {
                            "^[a-zA-Z0-9_-]{0,250}$": {
                              "anyOf": [
                                {
                                  "type": "array",
                                  "minItems": 1
                                },
                                {
                                  "type": "string"
                                },
                                {
                                  "type": "integer"
                                },
                                {
                                  "type": "boolean"
                                },
                                {
                                  "type": "number"
                                },
                                {
                                  "type": "object"
                                }
                              ]
                            }
                          },
                          "additionalProperties": false
                        },
                        "opened_connection_refs": {
                          "type": "array",
                          "description": "Specifies the list of network connections opened by the process, as a reference to one or more Network Traffic Objects.",
                          "items": {
                            "type": "string"
                          },
                          "minItems": 1
                        },
                        "creator_user_ref": {
                          "description": "Specifies the user that created the process, as a reference to a User Account Object.",
                          "type": "string"
                        },
                        "image_ref": {
                          "description": "Specifies the executable binary that was executed as the process image, as a reference to a File Object.",
                          "type": "string"
                        },
                        "parent_ref": {
                          "description": "Specifies the other process that spawned (i.e. is the parent of) this one, as represented by a Process Object.",
                          "type": "string"
                        },
                        "child_refs": {
                          "type": "array",
                          "description": "Specifies the other processes that were spawned by (i.e. children of) this process, as a reference to one or more other Process Objects.",
                          "items": {
                            "type": "string"
                          },
                          "minItems": 1
                        }
                      }
                    }
                  ],
                  "anyOf": [
                    {
                      "required": [
                        "extensions"
                      ]
                    },
                    {
                      "required": [
                        "is_hidden"
                      ]
                    },
                    {
                      "required": [
                        "pid"
                      ]
                    },
                    {
                      "required": [
                        "name"
                      ]
                    },
                    {
                      "required": [
                        "created"
                      ]
                    },
                    {
                      "required": [
                        "cwd"
                      ]
                    },
                    {
                      "required": [
                        "arguments"
                      ]
                    },
                    {
                      "required": [
                        "command_line"
                      ]
                    },
                    {
                      "required": [
                        "environment_variables"
                      ]
                    },
                    {
                      "required": [
                        "opened_connection_refs"
                      ]
                    },
                    {
                      "required": [
                        "creator_user_ref"
                      ]
                    },
                    {
                      "required": [
                        "image_ref"
                      ]
                    },
                    {
                      "required": [
                        "parent_ref"
                      ]
                    },
                    {
                      "required": [
                        "child_refs"
                      ]
                    }
                  ],
                  "definitions": {
                    "process-extensions-dictionary": {
                      "allOf": [
                        {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/dictionary.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "dictionary",
                          "description": "A dictionary captures a set of key/value pairs",
                          "type": "object",
                          "minProperties": 1,
                          "patternProperties": {
                            "^[a-zA-Z0-9_-]{0,250}$": {
                              "anyOf": [
                                {
                                  "type": "array",
                                  "minItems": 1
                                },
                                {
                                  "type": "string"
                                },
                                {
                                  "type": "integer"
                                },
                                {
                                  "type": "boolean"
                                },
                                {
                                  "type": "number"
                                },
                                {
                                  "type": "object"
                                }
                              ]
                            }
                          },
                          "additionalProperties": false
                        }
                      ],
                      "patternProperties": {
                        "^windows-process-ext$": {
                          "type": "object",
                          "description": "The Windows Process extension specifies a default extension for capturing properties specific to Windows processes.",
                          "allOf": [
                            {
                              "properties": {
                                "aslr_enabled": {
                                  "type": "boolean",
                                  "description": "Specifies whether Address Space Layout Randomization (ASLR) is enabled for the process."
                                },
                                "dep_enabled": {
                                  "type": "boolean",
                                  "description": "Specifies whether Data Execution Prevention (DEP) is enabled for the process."
                                },
                                "priority": {
                                  "type": "string",
                                  "description": "Specifies the current priority class of the process in Windows."
                                },
                                "owner_sid": {
                                  "type": "string",
                                  "description": "Specifies the Security ID (SID) value of the owner of the process."
                                },
                                "window_title": {
                                  "type": "string",
                                  "description": "Specifies the title of the main window of the process."
                                },
                                "startup_info": {
                                  "description": "Specifies the STARTUP_INFO struct used by the process, as a dictionary.",
                                  "allOf": [
                                    {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/dictionary.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "dictionary",
                                      "description": "A dictionary captures a set of key/value pairs",
                                      "type": "object",
                                      "minProperties": 1,
                                      "patternProperties": {
                                        "^[a-zA-Z0-9_-]{0,250}$": {
                                          "anyOf": [
                                            {
                                              "type": "array",
                                              "minItems": 1
                                            },
                                            {
                                              "type": "string"
                                            },
                                            {
                                              "type": "integer"
                                            },
                                            {
                                              "type": "boolean"
                                            },
                                            {
                                              "type": "number"
                                            },
                                            {
                                              "type": "object"
                                            }
                                          ]
                                        }
                                      },
                                      "additionalProperties": false
                                    }
                                  ],
                                  "patternProperties": {
                                    "^lpDesktop|lpTitle|dwFillAttribute|dwFlags|wShowWindow|hStdInput|hStdOutput|hStdError$": {
                                      "type": "string"
                                    },
                                    "^lpReserved|lpReserved2$": {
                                      "type": "null"
                                    },
                                    "^cb|dwX|dwY|dwXSize|dwYSize|dwXCountChars|dwYCountChars$": {
                                      "type": "integer"
                                    },
                                    "^cbReserved2$": {
                                      "type": "integer",
                                      "minimum": 0,
                                      "maximum": 0
                                    }
                                  },
                                  "additionalProperties": false
                                },
                                "integrity_level": {
                                  "description": "Specifies the Windows integrity level, or trustworthiness, of the process.",
                                  "type": "string",
                                  "enum": [
                                    "low",
                                    "medium",
                                    "high",
                                    "system"
                                  ]
                                }
                              }
                            },
                            {
                              "anyOf": [
                                {
                                  "required": [
                                    "aslr_enabled"
                                  ]
                                },
                                {
                                  "required": [
                                    "dep_enabled"
                                  ]
                                },
                                {
                                  "required": [
                                    "priority"
                                  ]
                                },
                                {
                                  "required": [
                                    "owner_sid"
                                  ]
                                },
                                {
                                  "required": [
                                    "window_title"
                                  ]
                                },
                                {
                                  "required": [
                                    "startup_info"
                                  ]
                                }
                              ]
                            }
                          ]
                        },
                        "^windows-service-ext$": {
                          "type": "object",
                          "description": "The Windows Service extension specifies a default extension for capturing properties specific to Windows services.",
                          "properties": {
                            "service_name": {
                              "type": "string",
                              "description": "Specifies the name of the service."
                            },
                            "descriptions": {
                              "type": "array",
                              "description": "Specifies the descriptions defined for the service.",
                              "items": {
                                "type": "string"
                              },
                              "minItems": 1
                            },
                            "display_name": {
                              "type": "string",
                              "description": "Specifies the displayed name of the service in Windows GUI controls."
                            },
                            "group_name": {
                              "type": "string",
                              "description": "Specifies the name of the load ordering group of which the service is a member."
                            },
                            "start_type": {
                              "type": "string",
                              "description": "Specifies the start options defined for the service. windows-service-start-enum",
                              "enum": [
                                "SERVICE_AUTO_START",
                                "SERVICE_BOOT_START",
                                "SERVICE_DEMAND_START",
                                "SERVICE_DISABLED",
                                "SERVICE_SYSTEM_ALERT"
                              ]
                            },
                            "service_dll_refs": {
                              "type": "array",
                              "description": "Specifies the DLLs loaded by the service, as a reference to one or more File Objects.",
                              "items": {
                                "type": "string"
                              },
                              "minItems": 1
                            },
                            "service_type": {
                              "type": "string",
                              "description": "Specifies the type of the service. windows-service-enum",
                              "enum": [
                                "SERVICE_KERNEL_DRIVER",
                                "SERVICE_FILE_SYSTEM_DRIVER",
                                "SERVICE_WIN32_OWN_PROCESS",
                                "SERVICE_WIN32_SHARE_PROCESS"
                              ]
                            },
                            "service_status": {
                              "type": "string",
                              "description": "Specifies the current status of the service. windows-service-status-enum",
                              "enum": [
                                "SERVICE_CONTINUE_PENDING",
                                "SERVICE_PAUSE_PENDING",
                                "SERVICE_PAUSED",
                                "SERVICE_RUNNING",
                                "SERVICE_START_PENDING",
                                "SERVICE_STOP_PENDING",
                                "SERVICE_STOPPED"
                              ]
                            }
                          },
                          "anyOf": [
                            {
                              "required": [
                                "service_name"
                              ]
                            },
                            {
                              "required": [
                                "descriptions"
                              ]
                            },
                            {
                              "required": [
                                "display_name"
                              ]
                            },
                            {
                              "required": [
                                "group_name"
                              ]
                            },
                            {
                              "required": [
                                "start_type"
                              ]
                            },
                            {
                              "required": [
                                "service_dll_refs"
                              ]
                            },
                            {
                              "required": [
                                "service_type"
                              ]
                            },
                            {
                              "required": [
                                "service_status"
                              ]
                            }
                          ]
                        }
                      },
                      "additionalProperties": {
                        "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/dictionary.json",
                        "$schema": "http://json-schema.org/draft/2020-12/schema#",
                        "title": "dictionary",
                        "description": "A dictionary captures a set of key/value pairs",
                        "type": "object",
                        "minProperties": 1,
                        "patternProperties": {
                          "^[a-zA-Z0-9_-]{0,250}$": {
                            "anyOf": [
                              {
                                "type": "array",
                                "minItems": 1
                              },
                              {
                                "type": "string"
                              },
                              {
                                "type": "integer"
                              },
                              {
                                "type": "boolean"
                              },
                              {
                                "type": "number"
                              },
                              {
                                "type": "object"
                              }
                            ]
                          }
                        },
                        "additionalProperties": false
                      }
                    },
                    "startup-info-dictionary": {
                      "allOf": [
                        {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/dictionary.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "dictionary",
                          "description": "A dictionary captures a set of key/value pairs",
                          "type": "object",
                          "minProperties": 1,
                          "patternProperties": {
                            "^[a-zA-Z0-9_-]{0,250}$": {
                              "anyOf": [
                                {
                                  "type": "array",
                                  "minItems": 1
                                },
                                {
                                  "type": "string"
                                },
                                {
                                  "type": "integer"
                                },
                                {
                                  "type": "boolean"
                                },
                                {
                                  "type": "number"
                                },
                                {
                                  "type": "object"
                                }
                              ]
                            }
                          },
                          "additionalProperties": false
                        }
                      ],
                      "patternProperties": {
                        "^lpDesktop|lpTitle|dwFillAttribute|dwFlags|wShowWindow|hStdInput|hStdOutput|hStdError$": {
                          "type": "string"
                        },
                        "^lpReserved|lpReserved2$": {
                          "type": "null"
                        },
                        "^cb|dwX|dwY|dwXSize|dwYSize|dwXCountChars|dwYCountChars$": {
                          "type": "integer"
                        },
                        "^cbReserved2$": {
                          "type": "integer",
                          "minimum": 0,
                          "maximum": 0
                        }
                      },
                      "additionalProperties": false
                    },
                    "windows-integrity-level-enum": {
                      "type": "string",
                      "enum": [
                        "low",
                        "medium",
                        "high",
                        "system"
                      ]
                    }
                  }
                },
                {
                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/observables/software.json",
                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                  "title": "software",
                  "description": "The Software Object represents high-level properties associated with software, including software products.",
                  "type": "object",
                  "allOf": [
                    {
                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/cyber-observable-core.json",
                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                      "title": "cyber-observable-core",
                      "description": "Common properties and behavior across all Cyber Observable Objects.",
                      "type": "object",
                      "properties": {
                        "type": {
                          "type": "string",
                          "pattern": "^([a-z][a-z0-9]*)+(-[a-z0-9]+)*\\-?$",
                          "minLength": 3,
                          "maxLength": 250,
                          "description": "Indicates that this object is an Observable Object. The value of this property MUST be a valid Observable Object type name, but to allow for custom objects this has been removed from the schema.",
                          "not": {
                            "enum": [
                              "action"
                            ]
                          }
                        },
                        "spec_version": {
                          "type": "string",
                          "enum": [
                            "2.0",
                            "2.1"
                          ],
                          "description": "The version of the STIX specification used to represent the content in this cyber-observable."
                        },
                        "object_marking_refs": {
                          "type": "array",
                          "description": "The list of marking-definition objects to be applied to this object.",
                          "items": {
                            "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/identifier.json",
                            "$schema": "http://json-schema.org/draft/2020-12/schema#",
                            "title": "identifier",
                            "description": "Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.",
                            "type": "string",
                            "pattern": "^[a-z][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
                          },
                          "minItems": 1
                        },
                        "granular_markings": {
                          "type": "array",
                          "description": "The set of granular markings that apply to this object.",
                          "items": {
                            "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/granular-marking.json",
                            "$schema": "http://json-schema.org/draft/2020-12/schema#",
                            "title": "granular-marking",
                            "description": "The granular-marking type defines how the list of marking-definition objects referenced by the marking_refs property to apply to a set of content identified by the list of selectors in the selectors property.",
                            "type": "object",
                            "properties": {
                              "selectors": {
                                "type": "array",
                                "description": "A list of selectors for content contained within the STIX object in which this property appears.",
                                "items": {
                                  "type": "string",
                                  "pattern": "^([a-z0-9_-]{3,249}(\\.(\\[\\d+\\]|[a-z0-9_-]{1,250}))*|id)$"
                                },
                                "minItems": 1
                              },
                              "lang": {
                                "type": "string",
                                "description": "Identifies the language of the text identified by this marking."
                              },
                              "marking_ref": {
                                "allOf": [
                                  {
                                    "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/identifier.json",
                                    "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                    "title": "identifier",
                                    "description": "Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.",
                                    "type": "string",
                                    "pattern": "^[a-z][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
                                  },
                                  {
                                    "pattern": "^marking-definition--",
                                    "description": "The marking_ref property specifies the ID of the marking-definition object that describes the marking."
                                  }
                                ]
                              }
                            },
                            "required": [
                              "selectors",
                              "marking_ref"
                            ]
                          },
                          "minItems": 1
                        },
                        "defanged": {
                          "type": "boolean",
                          "description": "Defines whether or not the data contained within the object has been defanged."
                        },
                        "id": {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/identifier.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "identifier",
                          "description": "Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.",
                          "type": "string",
                          "pattern": "^[a-z][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
                        },
                        "extensions": {
                          "description": "Specifies any extensions of the object, as a dictionary.",
                          "type": "object",
                          "minProperties": 1,
                          "patternProperties": {
                            "^([a-z][a-z0-9]*)+(-[a-z0-9]+)*\\-ext$": {
                              "type": "object",
                              "minProperties": 1,
                              "allOf": [
                                {
                                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/properties.json",
                                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                  "title": "properties",
                                  "description": "Rules for custom properties",
                                  "patternProperties": {
                                    "^[a-z][a-z0-9_]{0,245}_bin$": {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/binary.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "binary",
                                      "description": "The ​binary data type represents a sequence of bytes. In order to allow pattern matching on custom objects, for all properties that use the binary type, the property name MUST end with '_bin'. The JSON MTI serialization represents this as a base64-­encoded string as specified in RFC4648​. Other serializations SHOULD use a native binary type, if available.",
                                      "type": "string",
                                      "pattern": "^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$"
                                    },
                                    "^[a-z][a-z0-9_]{0,245}_hex$": {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "hex",
                                      "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                                      "type": "string",
                                      "pattern": "^([a-fA-F0-9]{2})+$"
                                    },
                                    "^([a-z][a-z0-9_]{2,249})|id$": {
                                      "anyOf": [
                                        {
                                          "type": "array",
                                          "minItems": 1
                                        },
                                        {
                                          "type": "string"
                                        },
                                        {
                                          "type": "integer"
                                        },
                                        {
                                          "type": "boolean"
                                        },
                                        {
                                          "type": "number"
                                        },
                                        {
                                          "type": "object"
                                        }
                                      ]
                                    }
                                  },
                                  "additionalProperties": false
                                }
                              ]
                            },
                            "^extension-definition--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$": {
                              "allOf": [
                                {
                                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/extension.json",
                                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                  "type": "object",
                                  "minProperties": 1,
                                  "properties": {
                                    "extension_type": {
                                      "description": "The type of extension.",
                                      "type": "string",
                                      "enum": [
                                        "new-sdo",
                                        "new-sco",
                                        "new-sro",
                                        "property-extension",
                                        "toplevel-property-extension"
                                      ]
                                    }
                                  },
                                  "allOf": [
                                    {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/properties.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "properties",
                                      "description": "Rules for custom properties",
                                      "patternProperties": {
                                        "^[a-z][a-z0-9_]{0,245}_bin$": {
                                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/binary.json",
                                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                          "title": "binary",
                                          "description": "The ​binary data type represents a sequence of bytes. In order to allow pattern matching on custom objects, for all properties that use the binary type, the property name MUST end with '_bin'. The JSON MTI serialization represents this as a base64-­encoded string as specified in RFC4648​. Other serializations SHOULD use a native binary type, if available.",
                                          "type": "string",
                                          "pattern": "^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$"
                                        },
                                        "^[a-z][a-z0-9_]{0,245}_hex$": {
                                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                          "title": "hex",
                                          "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                                          "type": "string",
                                          "pattern": "^([a-fA-F0-9]{2})+$"
                                        },
                                        "^([a-z][a-z0-9_]{2,249})|id$": {
                                          "anyOf": [
                                            {
                                              "type": "array",
                                              "minItems": 1
                                            },
                                            {
                                              "type": "string"
                                            },
                                            {
                                              "type": "integer"
                                            },
                                            {
                                              "type": "boolean"
                                            },
                                            {
                                              "type": "number"
                                            },
                                            {
                                              "type": "object"
                                            }
                                          ]
                                        }
                                      },
                                      "additionalProperties": false
                                    }
                                  ],
                                  "required": [
                                    "extension_type"
                                  ],
                                  "definitions": {
                                    "extension-type-enum": {
                                      "type": "string",
                                      "enum": [
                                        "new-sdo",
                                        "new-sco",
                                        "new-sro",
                                        "property-extension",
                                        "toplevel-property-extension"
                                      ]
                                    }
                                  }
                                }
                              ]
                            }
                          },
                          "additionalProperties": false
                        }
                      },
                      "allOf": [
                        {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/properties.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "properties",
                          "description": "Rules for custom properties",
                          "patternProperties": {
                            "^[a-z][a-z0-9_]{0,245}_bin$": {
                              "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/binary.json",
                              "$schema": "http://json-schema.org/draft/2020-12/schema#",
                              "title": "binary",
                              "description": "The ​binary data type represents a sequence of bytes. In order to allow pattern matching on custom objects, for all properties that use the binary type, the property name MUST end with '_bin'. The JSON MTI serialization represents this as a base64-­encoded string as specified in RFC4648​. Other serializations SHOULD use a native binary type, if available.",
                              "type": "string",
                              "pattern": "^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$"
                            },
                            "^[a-z][a-z0-9_]{0,245}_hex$": {
                              "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                              "$schema": "http://json-schema.org/draft/2020-12/schema#",
                              "title": "hex",
                              "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                              "type": "string",
                              "pattern": "^([a-fA-F0-9]{2})+$"
                            },
                            "^([a-z][a-z0-9_]{2,249})|id$": {
                              "anyOf": [
                                {
                                  "type": "array",
                                  "minItems": 1
                                },
                                {
                                  "type": "string"
                                },
                                {
                                  "type": "integer"
                                },
                                {
                                  "type": "boolean"
                                },
                                {
                                  "type": "number"
                                },
                                {
                                  "type": "object"
                                }
                              ]
                            }
                          },
                          "additionalProperties": false
                        }
                      ],
                      "not": {
                        "anyOf": [
                          {
                            "required": [
                              "severity"
                            ]
                          },
                          {
                            "required": [
                              "action"
                            ]
                          },
                          {
                            "required": [
                              "username"
                            ]
                          },
                          {
                            "required": [
                              "phone_numbers"
                            ]
                          }
                        ]
                      },
                      "required": [
                        "type",
                        "id"
                      ]
                    },
                    {
                      "properties": {
                        "type": {
                          "type": "string",
                          "description": "The value of this property MUST be `software`.",
                          "enum": [
                            "software"
                          ]
                        },
                        "id": {
                          "title": "id",
                          "pattern": "^software--"
                        },
                        "name": {
                          "type": "string",
                          "description": "Specifies the name of the software."
                        },
                        "cpe": {
                          "type": "string",
                          "pattern": "cpe:2\\.3:[aho\\*\\-](:(((\\?*|\\*?)([a-zA-Z0-9\\-\\._]|(\\\\[\\\\\\*\\?!\"#$$%&'\\(\\)\\+,/:;<=>@\\[\\]\\^`\\{\\|}~]))+(\\?*|\\*?))|[\\*\\-])){5}(:(([a-zA-Z]{2,3}(-([a-zA-Z]{2}|[0-9]{3}))?)|[\\*\\-]))(:(((\\?*|\\*?)([a-zA-Z0-9\\-\\._]|(\\\\[\\\\\\*\\?!\"#$$%&'\\(\\)\\+,/:;<=>@\\[\\]\\^`\\{\\|}~]))+(\\?*|\\*?))|[\\*\\-])){4}",
                          "description": "Specifies the Common Platform Enumeration (CPE) entry for the software, if available. The value for this property MUST be a CPE v2.3 entry from the official NVD CPE Dictionary."
                        },
                        "swid": {
                          "type": "string",
                          "description": "Specifies the Software Identification (SWID) Tags entry for the software, if available."
                        },
                        "languages": {
                          "type": "array",
                          "description": "Specifies the languages supported by the software. The value of each list member MUST be an ISO 639-2 language code.",
                          "items": {
                            "type": "string",
                            "pattern": "^[a-z]{3}$"
                          },
                          "minItems": 1
                        },
                        "vendor": {
                          "type": "string",
                          "description": "Specifies the name of the vendor of the software."
                        },
                        "version": {
                          "type": "string",
                          "description": "Specifies the version of the software."
                        }
                      }
                    }
                  ],
                  "required": [
                    "name"
                  ]
                },
                {
                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/observables/url.json",
                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                  "title": "url",
                  "description": "The URL Object represents the properties of a uniform resource locator (URL).",
                  "type": "object",
                  "allOf": [
                    {
                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/cyber-observable-core.json",
                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                      "title": "cyber-observable-core",
                      "description": "Common properties and behavior across all Cyber Observable Objects.",
                      "type": "object",
                      "properties": {
                        "type": {
                          "type": "string",
                          "pattern": "^([a-z][a-z0-9]*)+(-[a-z0-9]+)*\\-?$",
                          "minLength": 3,
                          "maxLength": 250,
                          "description": "Indicates that this object is an Observable Object. The value of this property MUST be a valid Observable Object type name, but to allow for custom objects this has been removed from the schema.",
                          "not": {
                            "enum": [
                              "action"
                            ]
                          }
                        },
                        "spec_version": {
                          "type": "string",
                          "enum": [
                            "2.0",
                            "2.1"
                          ],
                          "description": "The version of the STIX specification used to represent the content in this cyber-observable."
                        },
                        "object_marking_refs": {
                          "type": "array",
                          "description": "The list of marking-definition objects to be applied to this object.",
                          "items": {
                            "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/identifier.json",
                            "$schema": "http://json-schema.org/draft/2020-12/schema#",
                            "title": "identifier",
                            "description": "Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.",
                            "type": "string",
                            "pattern": "^[a-z][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
                          },
                          "minItems": 1
                        },
                        "granular_markings": {
                          "type": "array",
                          "description": "The set of granular markings that apply to this object.",
                          "items": {
                            "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/granular-marking.json",
                            "$schema": "http://json-schema.org/draft/2020-12/schema#",
                            "title": "granular-marking",
                            "description": "The granular-marking type defines how the list of marking-definition objects referenced by the marking_refs property to apply to a set of content identified by the list of selectors in the selectors property.",
                            "type": "object",
                            "properties": {
                              "selectors": {
                                "type": "array",
                                "description": "A list of selectors for content contained within the STIX object in which this property appears.",
                                "items": {
                                  "type": "string",
                                  "pattern": "^([a-z0-9_-]{3,249}(\\.(\\[\\d+\\]|[a-z0-9_-]{1,250}))*|id)$"
                                },
                                "minItems": 1
                              },
                              "lang": {
                                "type": "string",
                                "description": "Identifies the language of the text identified by this marking."
                              },
                              "marking_ref": {
                                "allOf": [
                                  {
                                    "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/identifier.json",
                                    "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                    "title": "identifier",
                                    "description": "Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.",
                                    "type": "string",
                                    "pattern": "^[a-z][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
                                  },
                                  {
                                    "pattern": "^marking-definition--",
                                    "description": "The marking_ref property specifies the ID of the marking-definition object that describes the marking."
                                  }
                                ]
                              }
                            },
                            "required": [
                              "selectors",
                              "marking_ref"
                            ]
                          },
                          "minItems": 1
                        },
                        "defanged": {
                          "type": "boolean",
                          "description": "Defines whether or not the data contained within the object has been defanged."
                        },
                        "id": {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/identifier.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "identifier",
                          "description": "Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.",
                          "type": "string",
                          "pattern": "^[a-z][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
                        },
                        "extensions": {
                          "description": "Specifies any extensions of the object, as a dictionary.",
                          "type": "object",
                          "minProperties": 1,
                          "patternProperties": {
                            "^([a-z][a-z0-9]*)+(-[a-z0-9]+)*\\-ext$": {
                              "type": "object",
                              "minProperties": 1,
                              "allOf": [
                                {
                                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/properties.json",
                                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                  "title": "properties",
                                  "description": "Rules for custom properties",
                                  "patternProperties": {
                                    "^[a-z][a-z0-9_]{0,245}_bin$": {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/binary.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "binary",
                                      "description": "The ​binary data type represents a sequence of bytes. In order to allow pattern matching on custom objects, for all properties that use the binary type, the property name MUST end with '_bin'. The JSON MTI serialization represents this as a base64-­encoded string as specified in RFC4648​. Other serializations SHOULD use a native binary type, if available.",
                                      "type": "string",
                                      "pattern": "^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$"
                                    },
                                    "^[a-z][a-z0-9_]{0,245}_hex$": {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "hex",
                                      "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                                      "type": "string",
                                      "pattern": "^([a-fA-F0-9]{2})+$"
                                    },
                                    "^([a-z][a-z0-9_]{2,249})|id$": {
                                      "anyOf": [
                                        {
                                          "type": "array",
                                          "minItems": 1
                                        },
                                        {
                                          "type": "string"
                                        },
                                        {
                                          "type": "integer"
                                        },
                                        {
                                          "type": "boolean"
                                        },
                                        {
                                          "type": "number"
                                        },
                                        {
                                          "type": "object"
                                        }
                                      ]
                                    }
                                  },
                                  "additionalProperties": false
                                }
                              ]
                            },
                            "^extension-definition--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$": {
                              "allOf": [
                                {
                                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/extension.json",
                                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                  "type": "object",
                                  "minProperties": 1,
                                  "properties": {
                                    "extension_type": {
                                      "description": "The type of extension.",
                                      "type": "string",
                                      "enum": [
                                        "new-sdo",
                                        "new-sco",
                                        "new-sro",
                                        "property-extension",
                                        "toplevel-property-extension"
                                      ]
                                    }
                                  },
                                  "allOf": [
                                    {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/properties.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "properties",
                                      "description": "Rules for custom properties",
                                      "patternProperties": {
                                        "^[a-z][a-z0-9_]{0,245}_bin$": {
                                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/binary.json",
                                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                          "title": "binary",
                                          "description": "The ​binary data type represents a sequence of bytes. In order to allow pattern matching on custom objects, for all properties that use the binary type, the property name MUST end with '_bin'. The JSON MTI serialization represents this as a base64-­encoded string as specified in RFC4648​. Other serializations SHOULD use a native binary type, if available.",
                                          "type": "string",
                                          "pattern": "^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$"
                                        },
                                        "^[a-z][a-z0-9_]{0,245}_hex$": {
                                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                          "title": "hex",
                                          "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                                          "type": "string",
                                          "pattern": "^([a-fA-F0-9]{2})+$"
                                        },
                                        "^([a-z][a-z0-9_]{2,249})|id$": {
                                          "anyOf": [
                                            {
                                              "type": "array",
                                              "minItems": 1
                                            },
                                            {
                                              "type": "string"
                                            },
                                            {
                                              "type": "integer"
                                            },
                                            {
                                              "type": "boolean"
                                            },
                                            {
                                              "type": "number"
                                            },
                                            {
                                              "type": "object"
                                            }
                                          ]
                                        }
                                      },
                                      "additionalProperties": false
                                    }
                                  ],
                                  "required": [
                                    "extension_type"
                                  ],
                                  "definitions": {
                                    "extension-type-enum": {
                                      "type": "string",
                                      "enum": [
                                        "new-sdo",
                                        "new-sco",
                                        "new-sro",
                                        "property-extension",
                                        "toplevel-property-extension"
                                      ]
                                    }
                                  }
                                }
                              ]
                            }
                          },
                          "additionalProperties": false
                        }
                      },
                      "allOf": [
                        {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/properties.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "properties",
                          "description": "Rules for custom properties",
                          "patternProperties": {
                            "^[a-z][a-z0-9_]{0,245}_bin$": {
                              "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/binary.json",
                              "$schema": "http://json-schema.org/draft/2020-12/schema#",
                              "title": "binary",
                              "description": "The ​binary data type represents a sequence of bytes. In order to allow pattern matching on custom objects, for all properties that use the binary type, the property name MUST end with '_bin'. The JSON MTI serialization represents this as a base64-­encoded string as specified in RFC4648​. Other serializations SHOULD use a native binary type, if available.",
                              "type": "string",
                              "pattern": "^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$"
                            },
                            "^[a-z][a-z0-9_]{0,245}_hex$": {
                              "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                              "$schema": "http://json-schema.org/draft/2020-12/schema#",
                              "title": "hex",
                              "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                              "type": "string",
                              "pattern": "^([a-fA-F0-9]{2})+$"
                            },
                            "^([a-z][a-z0-9_]{2,249})|id$": {
                              "anyOf": [
                                {
                                  "type": "array",
                                  "minItems": 1
                                },
                                {
                                  "type": "string"
                                },
                                {
                                  "type": "integer"
                                },
                                {
                                  "type": "boolean"
                                },
                                {
                                  "type": "number"
                                },
                                {
                                  "type": "object"
                                }
                              ]
                            }
                          },
                          "additionalProperties": false
                        }
                      ],
                      "not": {
                        "anyOf": [
                          {
                            "required": [
                              "severity"
                            ]
                          },
                          {
                            "required": [
                              "action"
                            ]
                          },
                          {
                            "required": [
                              "username"
                            ]
                          },
                          {
                            "required": [
                              "phone_numbers"
                            ]
                          }
                        ]
                      },
                      "required": [
                        "type",
                        "id"
                      ]
                    },
                    {
                      "properties": {
                        "type": {
                          "type": "string",
                          "description": "The value of this property MUST be `url`.",
                          "enum": [
                            "url"
                          ]
                        },
                        "id": {
                          "title": "id",
                          "pattern": "^url--"
                        },
                        "value": {
                          "description": "Specifies the value of the URL.",
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/url-regex.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "url-regex",
                          "type": "string",
                          "format": "uri"
                        }
                      }
                    }
                  ],
                  "required": [
                    "value"
                  ]
                },
                {
                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/observables/user-account.json",
                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                  "title": "user-account",
                  "description": "The User Account Object represents an instance of any type of user account, including but not limited to operating system, device, messaging service, and social media platform accounts.",
                  "type": "object",
                  "allOf": [
                    {
                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/cyber-observable-core.json",
                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                      "title": "cyber-observable-core",
                      "description": "Common properties and behavior across all Cyber Observable Objects.",
                      "type": "object",
                      "properties": {
                        "type": {
                          "type": "string",
                          "pattern": "^([a-z][a-z0-9]*)+(-[a-z0-9]+)*\\-?$",
                          "minLength": 3,
                          "maxLength": 250,
                          "description": "Indicates that this object is an Observable Object. The value of this property MUST be a valid Observable Object type name, but to allow for custom objects this has been removed from the schema.",
                          "not": {
                            "enum": [
                              "action"
                            ]
                          }
                        },
                        "spec_version": {
                          "type": "string",
                          "enum": [
                            "2.0",
                            "2.1"
                          ],
                          "description": "The version of the STIX specification used to represent the content in this cyber-observable."
                        },
                        "object_marking_refs": {
                          "type": "array",
                          "description": "The list of marking-definition objects to be applied to this object.",
                          "items": {
                            "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/identifier.json",
                            "$schema": "http://json-schema.org/draft/2020-12/schema#",
                            "title": "identifier",
                            "description": "Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.",
                            "type": "string",
                            "pattern": "^[a-z][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
                          },
                          "minItems": 1
                        },
                        "granular_markings": {
                          "type": "array",
                          "description": "The set of granular markings that apply to this object.",
                          "items": {
                            "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/granular-marking.json",
                            "$schema": "http://json-schema.org/draft/2020-12/schema#",
                            "title": "granular-marking",
                            "description": "The granular-marking type defines how the list of marking-definition objects referenced by the marking_refs property to apply to a set of content identified by the list of selectors in the selectors property.",
                            "type": "object",
                            "properties": {
                              "selectors": {
                                "type": "array",
                                "description": "A list of selectors for content contained within the STIX object in which this property appears.",
                                "items": {
                                  "type": "string",
                                  "pattern": "^([a-z0-9_-]{3,249}(\\.(\\[\\d+\\]|[a-z0-9_-]{1,250}))*|id)$"
                                },
                                "minItems": 1
                              },
                              "lang": {
                                "type": "string",
                                "description": "Identifies the language of the text identified by this marking."
                              },
                              "marking_ref": {
                                "allOf": [
                                  {
                                    "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/identifier.json",
                                    "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                    "title": "identifier",
                                    "description": "Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.",
                                    "type": "string",
                                    "pattern": "^[a-z][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
                                  },
                                  {
                                    "pattern": "^marking-definition--",
                                    "description": "The marking_ref property specifies the ID of the marking-definition object that describes the marking."
                                  }
                                ]
                              }
                            },
                            "required": [
                              "selectors",
                              "marking_ref"
                            ]
                          },
                          "minItems": 1
                        },
                        "defanged": {
                          "type": "boolean",
                          "description": "Defines whether or not the data contained within the object has been defanged."
                        },
                        "id": {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/identifier.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "identifier",
                          "description": "Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.",
                          "type": "string",
                          "pattern": "^[a-z][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
                        },
                        "extensions": {
                          "description": "Specifies any extensions of the object, as a dictionary.",
                          "type": "object",
                          "minProperties": 1,
                          "patternProperties": {
                            "^([a-z][a-z0-9]*)+(-[a-z0-9]+)*\\-ext$": {
                              "type": "object",
                              "minProperties": 1,
                              "allOf": [
                                {
                                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/properties.json",
                                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                  "title": "properties",
                                  "description": "Rules for custom properties",
                                  "patternProperties": {
                                    "^[a-z][a-z0-9_]{0,245}_bin$": {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/binary.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "binary",
                                      "description": "The ​binary data type represents a sequence of bytes. In order to allow pattern matching on custom objects, for all properties that use the binary type, the property name MUST end with '_bin'. The JSON MTI serialization represents this as a base64-­encoded string as specified in RFC4648​. Other serializations SHOULD use a native binary type, if available.",
                                      "type": "string",
                                      "pattern": "^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$"
                                    },
                                    "^[a-z][a-z0-9_]{0,245}_hex$": {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "hex",
                                      "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                                      "type": "string",
                                      "pattern": "^([a-fA-F0-9]{2})+$"
                                    },
                                    "^([a-z][a-z0-9_]{2,249})|id$": {
                                      "anyOf": [
                                        {
                                          "type": "array",
                                          "minItems": 1
                                        },
                                        {
                                          "type": "string"
                                        },
                                        {
                                          "type": "integer"
                                        },
                                        {
                                          "type": "boolean"
                                        },
                                        {
                                          "type": "number"
                                        },
                                        {
                                          "type": "object"
                                        }
                                      ]
                                    }
                                  },
                                  "additionalProperties": false
                                }
                              ]
                            },
                            "^extension-definition--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$": {
                              "allOf": [
                                {
                                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/extension.json",
                                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                  "type": "object",
                                  "minProperties": 1,
                                  "properties": {
                                    "extension_type": {
                                      "description": "The type of extension.",
                                      "type": "string",
                                      "enum": [
                                        "new-sdo",
                                        "new-sco",
                                        "new-sro",
                                        "property-extension",
                                        "toplevel-property-extension"
                                      ]
                                    }
                                  },
                                  "allOf": [
                                    {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/properties.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "properties",
                                      "description": "Rules for custom properties",
                                      "patternProperties": {
                                        "^[a-z][a-z0-9_]{0,245}_bin$": {
                                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/binary.json",
                                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                          "title": "binary",
                                          "description": "The ​binary data type represents a sequence of bytes. In order to allow pattern matching on custom objects, for all properties that use the binary type, the property name MUST end with '_bin'. The JSON MTI serialization represents this as a base64-­encoded string as specified in RFC4648​. Other serializations SHOULD use a native binary type, if available.",
                                          "type": "string",
                                          "pattern": "^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$"
                                        },
                                        "^[a-z][a-z0-9_]{0,245}_hex$": {
                                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                          "title": "hex",
                                          "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                                          "type": "string",
                                          "pattern": "^([a-fA-F0-9]{2})+$"
                                        },
                                        "^([a-z][a-z0-9_]{2,249})|id$": {
                                          "anyOf": [
                                            {
                                              "type": "array",
                                              "minItems": 1
                                            },
                                            {
                                              "type": "string"
                                            },
                                            {
                                              "type": "integer"
                                            },
                                            {
                                              "type": "boolean"
                                            },
                                            {
                                              "type": "number"
                                            },
                                            {
                                              "type": "object"
                                            }
                                          ]
                                        }
                                      },
                                      "additionalProperties": false
                                    }
                                  ],
                                  "required": [
                                    "extension_type"
                                  ],
                                  "definitions": {
                                    "extension-type-enum": {
                                      "type": "string",
                                      "enum": [
                                        "new-sdo",
                                        "new-sco",
                                        "new-sro",
                                        "property-extension",
                                        "toplevel-property-extension"
                                      ]
                                    }
                                  }
                                }
                              ]
                            }
                          },
                          "additionalProperties": false
                        }
                      },
                      "allOf": [
                        {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/properties.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "properties",
                          "description": "Rules for custom properties",
                          "patternProperties": {
                            "^[a-z][a-z0-9_]{0,245}_bin$": {
                              "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/binary.json",
                              "$schema": "http://json-schema.org/draft/2020-12/schema#",
                              "title": "binary",
                              "description": "The ​binary data type represents a sequence of bytes. In order to allow pattern matching on custom objects, for all properties that use the binary type, the property name MUST end with '_bin'. The JSON MTI serialization represents this as a base64-­encoded string as specified in RFC4648​. Other serializations SHOULD use a native binary type, if available.",
                              "type": "string",
                              "pattern": "^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$"
                            },
                            "^[a-z][a-z0-9_]{0,245}_hex$": {
                              "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                              "$schema": "http://json-schema.org/draft/2020-12/schema#",
                              "title": "hex",
                              "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                              "type": "string",
                              "pattern": "^([a-fA-F0-9]{2})+$"
                            },
                            "^([a-z][a-z0-9_]{2,249})|id$": {
                              "anyOf": [
                                {
                                  "type": "array",
                                  "minItems": 1
                                },
                                {
                                  "type": "string"
                                },
                                {
                                  "type": "integer"
                                },
                                {
                                  "type": "boolean"
                                },
                                {
                                  "type": "number"
                                },
                                {
                                  "type": "object"
                                }
                              ]
                            }
                          },
                          "additionalProperties": false
                        }
                      ],
                      "not": {
                        "anyOf": [
                          {
                            "required": [
                              "severity"
                            ]
                          },
                          {
                            "required": [
                              "action"
                            ]
                          },
                          {
                            "required": [
                              "username"
                            ]
                          },
                          {
                            "required": [
                              "phone_numbers"
                            ]
                          }
                        ]
                      },
                      "required": [
                        "type",
                        "id"
                      ]
                    },
                    {
                      "properties": {
                        "type": {
                          "type": "string",
                          "description": "The value of this property MUST be `user-account`.",
                          "enum": [
                            "user-account"
                          ]
                        },
                        "id": {
                          "title": "id",
                          "pattern": "^user-account--"
                        },
                        "extensions": {
                          "description": "The User Account Object defines the following extensions. In addition to these, producers MAY create their own. Extensions: unix-account-ext.",
                          "allOf": [
                            {
                              "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/dictionary.json",
                              "$schema": "http://json-schema.org/draft/2020-12/schema#",
                              "title": "dictionary",
                              "description": "A dictionary captures a set of key/value pairs",
                              "type": "object",
                              "minProperties": 1,
                              "patternProperties": {
                                "^[a-zA-Z0-9_-]{0,250}$": {
                                  "anyOf": [
                                    {
                                      "type": "array",
                                      "minItems": 1
                                    },
                                    {
                                      "type": "string"
                                    },
                                    {
                                      "type": "integer"
                                    },
                                    {
                                      "type": "boolean"
                                    },
                                    {
                                      "type": "number"
                                    },
                                    {
                                      "type": "object"
                                    }
                                  ]
                                }
                              },
                              "additionalProperties": false
                            }
                          ],
                          "patternProperties": {
                            "^unix-account-ext$": {
                              "type": "object",
                              "description": "The User Account Object defines the following extensions. In addition to these, producers MAY create their own.",
                              "allOf": [
                                {
                                  "properties": {
                                    "gid": {
                                      "type": "number",
                                      "description": "Specifies the primary group ID of the account."
                                    },
                                    "groups": {
                                      "type": "array",
                                      "description": "Specifies a list of names of groups that the account is a member of.",
                                      "items": {
                                        "type": "string"
                                      },
                                      "minItems": 1
                                    },
                                    "home_dir": {
                                      "type": "string",
                                      "description": "Specifies the home directory of the account."
                                    },
                                    "shell": {
                                      "type": "string",
                                      "description": "Specifies the account’s command shell."
                                    }
                                  }
                                },
                                {
                                  "anyOf": [
                                    {
                                      "required": [
                                        "gid"
                                      ]
                                    },
                                    {
                                      "required": [
                                        "groups"
                                      ]
                                    },
                                    {
                                      "required": [
                                        "home_dir"
                                      ]
                                    },
                                    {
                                      "required": [
                                        "shell"
                                      ]
                                    }
                                  ]
                                }
                              ]
                            }
                          },
                          "additionalProperties": {
                            "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/dictionary.json",
                            "$schema": "http://json-schema.org/draft/2020-12/schema#",
                            "title": "dictionary",
                            "description": "A dictionary captures a set of key/value pairs",
                            "type": "object",
                            "minProperties": 1,
                            "patternProperties": {
                              "^[a-zA-Z0-9_-]{0,250}$": {
                                "anyOf": [
                                  {
                                    "type": "array",
                                    "minItems": 1
                                  },
                                  {
                                    "type": "string"
                                  },
                                  {
                                    "type": "integer"
                                  },
                                  {
                                    "type": "boolean"
                                  },
                                  {
                                    "type": "number"
                                  },
                                  {
                                    "type": "object"
                                  }
                                ]
                              }
                            },
                            "additionalProperties": false
                          }
                        },
                        "user_id": {
                          "type": "string",
                          "description": "Specifies the identifier of the account."
                        },
                        "credential": {
                          "type": "string",
                          "description": "Specifies a cleartext credential. This is only intended to be used in capturing metadata from malware analysis (e.g., a hard-coded domain administrator password that the malware attempts to use for lateral movement) and SHOULD NOT be used for sharing of PII."
                        },
                        "account_login": {
                          "type": "string",
                          "description": "Specifies the account login string, used in cases where the user_id property specifies something other than what a user would type when they login."
                        },
                        "account_type": {
                          "type": "string",
                          "description": "Specifies the type of the account. This is an open vocabulary and values SHOULD come from the account-type-ov vocabulary."
                        },
                        "display_name": {
                          "type": "string",
                          "description": "Specifies the display name of the account, to be shown in user interfaces, if applicable."
                        },
                        "is_service_account": {
                          "type": "boolean",
                          "description": "Indicates that the account is associated with a network service or system process (daemon), not a specific individual."
                        },
                        "is_privileged": {
                          "type": "boolean",
                          "description": "Specifies that the account has elevated privileges (i.e., in the case of root on Unix or the Windows Administrator account)."
                        },
                        "can_escalate_privs": {
                          "type": "boolean",
                          "description": "Specifies that the account has the ability to escalate privileges (i.e., in the case of sudo on Unix or a Windows Domain Admin account)."
                        },
                        "is_disabled": {
                          "type": "boolean",
                          "description": "Specifies if the account is disabled."
                        },
                        "account_created": {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/timestamp.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "timestamp",
                          "description": "Represents timestamps across the CTI specifications. The format is an RFC3339 timestamp, with a required timezone specification of 'Z'.",
                          "type": "string",
                          "pattern": "^[0-9]{4}-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])T([01][0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9]|60)(\\.[0-9]+)?Z$"
                        },
                        "account_expires": {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/timestamp.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "timestamp",
                          "description": "Represents timestamps across the CTI specifications. The format is an RFC3339 timestamp, with a required timezone specification of 'Z'.",
                          "type": "string",
                          "pattern": "^[0-9]{4}-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])T([01][0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9]|60)(\\.[0-9]+)?Z$"
                        },
                        "credential_last_changed": {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/timestamp.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "timestamp",
                          "description": "Represents timestamps across the CTI specifications. The format is an RFC3339 timestamp, with a required timezone specification of 'Z'.",
                          "type": "string",
                          "pattern": "^[0-9]{4}-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])T([01][0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9]|60)(\\.[0-9]+)?Z$"
                        },
                        "account_first_login": {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/timestamp.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "timestamp",
                          "description": "Represents timestamps across the CTI specifications. The format is an RFC3339 timestamp, with a required timezone specification of 'Z'.",
                          "type": "string",
                          "pattern": "^[0-9]{4}-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])T([01][0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9]|60)(\\.[0-9]+)?Z$"
                        },
                        "account_last_login": {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/timestamp.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "timestamp",
                          "description": "Represents timestamps across the CTI specifications. The format is an RFC3339 timestamp, with a required timezone specification of 'Z'.",
                          "type": "string",
                          "pattern": "^[0-9]{4}-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])T([01][0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9]|60)(\\.[0-9]+)?Z$"
                        }
                      }
                    }
                  ],
                  "anyOf": [
                    {
                      "required": [
                        "extensions"
                      ]
                    },
                    {
                      "required": [
                        "user_id"
                      ]
                    },
                    {
                      "required": [
                        "credential"
                      ]
                    },
                    {
                      "required": [
                        "account_login"
                      ]
                    },
                    {
                      "required": [
                        "account_type"
                      ]
                    },
                    {
                      "required": [
                        "display_name"
                      ]
                    },
                    {
                      "required": [
                        "is_service_account"
                      ]
                    },
                    {
                      "required": [
                        "is_privileged"
                      ]
                    },
                    {
                      "required": [
                        "can_escalate_privs"
                      ]
                    },
                    {
                      "required": [
                        "is_disabled"
                      ]
                    },
                    {
                      "required": [
                        "account_created"
                      ]
                    },
                    {
                      "required": [
                        "account_expires"
                      ]
                    },
                    {
                      "required": [
                        "credential_last_changed"
                      ]
                    },
                    {
                      "required": [
                        "account_first_login"
                      ]
                    },
                    {
                      "required": [
                        "account_last_login"
                      ]
                    }
                  ],
                  "definitions": {
                    "user-account-extensions-dictionary": {
                      "allOf": [
                        {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/dictionary.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "dictionary",
                          "description": "A dictionary captures a set of key/value pairs",
                          "type": "object",
                          "minProperties": 1,
                          "patternProperties": {
                            "^[a-zA-Z0-9_-]{0,250}$": {
                              "anyOf": [
                                {
                                  "type": "array",
                                  "minItems": 1
                                },
                                {
                                  "type": "string"
                                },
                                {
                                  "type": "integer"
                                },
                                {
                                  "type": "boolean"
                                },
                                {
                                  "type": "number"
                                },
                                {
                                  "type": "object"
                                }
                              ]
                            }
                          },
                          "additionalProperties": false
                        }
                      ],
                      "patternProperties": {
                        "^unix-account-ext$": {
                          "type": "object",
                          "description": "The User Account Object defines the following extensions. In addition to these, producers MAY create their own.",
                          "allOf": [
                            {
                              "properties": {
                                "gid": {
                                  "type": "number",
                                  "description": "Specifies the primary group ID of the account."
                                },
                                "groups": {
                                  "type": "array",
                                  "description": "Specifies a list of names of groups that the account is a member of.",
                                  "items": {
                                    "type": "string"
                                  },
                                  "minItems": 1
                                },
                                "home_dir": {
                                  "type": "string",
                                  "description": "Specifies the home directory of the account."
                                },
                                "shell": {
                                  "type": "string",
                                  "description": "Specifies the account’s command shell."
                                }
                              }
                            },
                            {
                              "anyOf": [
                                {
                                  "required": [
                                    "gid"
                                  ]
                                },
                                {
                                  "required": [
                                    "groups"
                                  ]
                                },
                                {
                                  "required": [
                                    "home_dir"
                                  ]
                                },
                                {
                                  "required": [
                                    "shell"
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      },
                      "additionalProperties": {
                        "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/dictionary.json",
                        "$schema": "http://json-schema.org/draft/2020-12/schema#",
                        "title": "dictionary",
                        "description": "A dictionary captures a set of key/value pairs",
                        "type": "object",
                        "minProperties": 1,
                        "patternProperties": {
                          "^[a-zA-Z0-9_-]{0,250}$": {
                            "anyOf": [
                              {
                                "type": "array",
                                "minItems": 1
                              },
                              {
                                "type": "string"
                              },
                              {
                                "type": "integer"
                              },
                              {
                                "type": "boolean"
                              },
                              {
                                "type": "number"
                              },
                              {
                                "type": "object"
                              }
                            ]
                          }
                        },
                        "additionalProperties": false
                      }
                    },
                    "account-type-ov": {
                      "type": "string",
                      "enum": [
                        "unix",
                        "windows local",
                        "windows domain",
                        "ldap",
                        "tacacs",
                        "radius",
                        "nis",
                        "openid",
                        "facebook",
                        "skype",
                        "twitter",
                        "kavi"
                      ]
                    }
                  }
                },
                {
                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/observables/windows-registry-key.json",
                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                  "title": "windows-registry-key",
                  "description": "The Registry Key Object represents the properties of a Windows registry key.",
                  "type": "object",
                  "allOf": [
                    {
                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/cyber-observable-core.json",
                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                      "title": "cyber-observable-core",
                      "description": "Common properties and behavior across all Cyber Observable Objects.",
                      "type": "object",
                      "properties": {
                        "type": {
                          "type": "string",
                          "pattern": "^([a-z][a-z0-9]*)+(-[a-z0-9]+)*\\-?$",
                          "minLength": 3,
                          "maxLength": 250,
                          "description": "Indicates that this object is an Observable Object. The value of this property MUST be a valid Observable Object type name, but to allow for custom objects this has been removed from the schema.",
                          "not": {
                            "enum": [
                              "action"
                            ]
                          }
                        },
                        "spec_version": {
                          "type": "string",
                          "enum": [
                            "2.0",
                            "2.1"
                          ],
                          "description": "The version of the STIX specification used to represent the content in this cyber-observable."
                        },
                        "object_marking_refs": {
                          "type": "array",
                          "description": "The list of marking-definition objects to be applied to this object.",
                          "items": {
                            "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/identifier.json",
                            "$schema": "http://json-schema.org/draft/2020-12/schema#",
                            "title": "identifier",
                            "description": "Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.",
                            "type": "string",
                            "pattern": "^[a-z][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
                          },
                          "minItems": 1
                        },
                        "granular_markings": {
                          "type": "array",
                          "description": "The set of granular markings that apply to this object.",
                          "items": {
                            "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/granular-marking.json",
                            "$schema": "http://json-schema.org/draft/2020-12/schema#",
                            "title": "granular-marking",
                            "description": "The granular-marking type defines how the list of marking-definition objects referenced by the marking_refs property to apply to a set of content identified by the list of selectors in the selectors property.",
                            "type": "object",
                            "properties": {
                              "selectors": {
                                "type": "array",
                                "description": "A list of selectors for content contained within the STIX object in which this property appears.",
                                "items": {
                                  "type": "string",
                                  "pattern": "^([a-z0-9_-]{3,249}(\\.(\\[\\d+\\]|[a-z0-9_-]{1,250}))*|id)$"
                                },
                                "minItems": 1
                              },
                              "lang": {
                                "type": "string",
                                "description": "Identifies the language of the text identified by this marking."
                              },
                              "marking_ref": {
                                "allOf": [
                                  {
                                    "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/identifier.json",
                                    "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                    "title": "identifier",
                                    "description": "Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.",
                                    "type": "string",
                                    "pattern": "^[a-z][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
                                  },
                                  {
                                    "pattern": "^marking-definition--",
                                    "description": "The marking_ref property specifies the ID of the marking-definition object that describes the marking."
                                  }
                                ]
                              }
                            },
                            "required": [
                              "selectors",
                              "marking_ref"
                            ]
                          },
                          "minItems": 1
                        },
                        "defanged": {
                          "type": "boolean",
                          "description": "Defines whether or not the data contained within the object has been defanged."
                        },
                        "id": {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/identifier.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "identifier",
                          "description": "Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.",
                          "type": "string",
                          "pattern": "^[a-z][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
                        },
                        "extensions": {
                          "description": "Specifies any extensions of the object, as a dictionary.",
                          "type": "object",
                          "minProperties": 1,
                          "patternProperties": {
                            "^([a-z][a-z0-9]*)+(-[a-z0-9]+)*\\-ext$": {
                              "type": "object",
                              "minProperties": 1,
                              "allOf": [
                                {
                                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/properties.json",
                                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                  "title": "properties",
                                  "description": "Rules for custom properties",
                                  "patternProperties": {
                                    "^[a-z][a-z0-9_]{0,245}_bin$": {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/binary.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "binary",
                                      "description": "The ​binary data type represents a sequence of bytes. In order to allow pattern matching on custom objects, for all properties that use the binary type, the property name MUST end with '_bin'. The JSON MTI serialization represents this as a base64-­encoded string as specified in RFC4648​. Other serializations SHOULD use a native binary type, if available.",
                                      "type": "string",
                                      "pattern": "^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$"
                                    },
                                    "^[a-z][a-z0-9_]{0,245}_hex$": {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "hex",
                                      "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                                      "type": "string",
                                      "pattern": "^([a-fA-F0-9]{2})+$"
                                    },
                                    "^([a-z][a-z0-9_]{2,249})|id$": {
                                      "anyOf": [
                                        {
                                          "type": "array",
                                          "minItems": 1
                                        },
                                        {
                                          "type": "string"
                                        },
                                        {
                                          "type": "integer"
                                        },
                                        {
                                          "type": "boolean"
                                        },
                                        {
                                          "type": "number"
                                        },
                                        {
                                          "type": "object"
                                        }
                                      ]
                                    }
                                  },
                                  "additionalProperties": false
                                }
                              ]
                            },
                            "^extension-definition--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$": {
                              "allOf": [
                                {
                                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/extension.json",
                                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                  "type": "object",
                                  "minProperties": 1,
                                  "properties": {
                                    "extension_type": {
                                      "description": "The type of extension.",
                                      "type": "string",
                                      "enum": [
                                        "new-sdo",
                                        "new-sco",
                                        "new-sro",
                                        "property-extension",
                                        "toplevel-property-extension"
                                      ]
                                    }
                                  },
                                  "allOf": [
                                    {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/properties.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "properties",
                                      "description": "Rules for custom properties",
                                      "patternProperties": {
                                        "^[a-z][a-z0-9_]{0,245}_bin$": {
                                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/binary.json",
                                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                          "title": "binary",
                                          "description": "The ​binary data type represents a sequence of bytes. In order to allow pattern matching on custom objects, for all properties that use the binary type, the property name MUST end with '_bin'. The JSON MTI serialization represents this as a base64-­encoded string as specified in RFC4648​. Other serializations SHOULD use a native binary type, if available.",
                                          "type": "string",
                                          "pattern": "^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$"
                                        },
                                        "^[a-z][a-z0-9_]{0,245}_hex$": {
                                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                          "title": "hex",
                                          "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                                          "type": "string",
                                          "pattern": "^([a-fA-F0-9]{2})+$"
                                        },
                                        "^([a-z][a-z0-9_]{2,249})|id$": {
                                          "anyOf": [
                                            {
                                              "type": "array",
                                              "minItems": 1
                                            },
                                            {
                                              "type": "string"
                                            },
                                            {
                                              "type": "integer"
                                            },
                                            {
                                              "type": "boolean"
                                            },
                                            {
                                              "type": "number"
                                            },
                                            {
                                              "type": "object"
                                            }
                                          ]
                                        }
                                      },
                                      "additionalProperties": false
                                    }
                                  ],
                                  "required": [
                                    "extension_type"
                                  ],
                                  "definitions": {
                                    "extension-type-enum": {
                                      "type": "string",
                                      "enum": [
                                        "new-sdo",
                                        "new-sco",
                                        "new-sro",
                                        "property-extension",
                                        "toplevel-property-extension"
                                      ]
                                    }
                                  }
                                }
                              ]
                            }
                          },
                          "additionalProperties": false
                        }
                      },
                      "allOf": [
                        {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/properties.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "properties",
                          "description": "Rules for custom properties",
                          "patternProperties": {
                            "^[a-z][a-z0-9_]{0,245}_bin$": {
                              "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/binary.json",
                              "$schema": "http://json-schema.org/draft/2020-12/schema#",
                              "title": "binary",
                              "description": "The ​binary data type represents a sequence of bytes. In order to allow pattern matching on custom objects, for all properties that use the binary type, the property name MUST end with '_bin'. The JSON MTI serialization represents this as a base64-­encoded string as specified in RFC4648​. Other serializations SHOULD use a native binary type, if available.",
                              "type": "string",
                              "pattern": "^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$"
                            },
                            "^[a-z][a-z0-9_]{0,245}_hex$": {
                              "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                              "$schema": "http://json-schema.org/draft/2020-12/schema#",
                              "title": "hex",
                              "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                              "type": "string",
                              "pattern": "^([a-fA-F0-9]{2})+$"
                            },
                            "^([a-z][a-z0-9_]{2,249})|id$": {
                              "anyOf": [
                                {
                                  "type": "array",
                                  "minItems": 1
                                },
                                {
                                  "type": "string"
                                },
                                {
                                  "type": "integer"
                                },
                                {
                                  "type": "boolean"
                                },
                                {
                                  "type": "number"
                                },
                                {
                                  "type": "object"
                                }
                              ]
                            }
                          },
                          "additionalProperties": false
                        }
                      ],
                      "not": {
                        "anyOf": [
                          {
                            "required": [
                              "severity"
                            ]
                          },
                          {
                            "required": [
                              "action"
                            ]
                          },
                          {
                            "required": [
                              "username"
                            ]
                          },
                          {
                            "required": [
                              "phone_numbers"
                            ]
                          }
                        ]
                      },
                      "required": [
                        "type",
                        "id"
                      ]
                    },
                    {
                      "properties": {
                        "type": {
                          "type": "string",
                          "description": "The value of this property MUST be `windows-registry-key`.",
                          "enum": [
                            "windows-registry-key"
                          ]
                        },
                        "id": {
                          "title": "id",
                          "pattern": "^windows-registry-key--"
                        },
                        "key": {
                          "type": "string",
                          "not": {
                            "pattern": "^HKLM|HKCC|HKCR|HKCU|HKU|hklm|hkcc|hkcr|hkcu|hku"
                          },
                          "description": "Specifies the full registry key including the hive."
                        },
                        "values": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "name": {
                                "type": "string",
                                "description": "Specifies the name of the registry value. For specifying the default value in a registry key, an empty string MUST be used."
                              },
                              "data": {
                                "type": "string",
                                "description": "Specifies the data contained in the registry value."
                              },
                              "data_type": {
                                "type": "string",
                                "description": "Specifies the registry (REG_*) data type used in the registry value.",
                                "enum": [
                                  "REG_NONE",
                                  "REG_SZ",
                                  "REG_EXPAND_SZ",
                                  "REG_BINARY",
                                  "REG_DWORD",
                                  "REG_DWORD_BIG_ENDIAN",
                                  "REG_DWORD_LITTLE_ENDIAN",
                                  "REG_LINK",
                                  "REG_MULTI_SZ",
                                  "REG_RESOURCE_LIST",
                                  "REG_FULL_RESOURCE_DESCRIPTION",
                                  "REG_RESOURCE_REQUIREMENTS_LIST",
                                  "REG_QWORD",
                                  "REG_INVALID_TYPE"
                                ]
                              }
                            },
                            "anyOf": [
                              {
                                "required": [
                                  "name"
                                ]
                              },
                              {
                                "required": [
                                  "data"
                                ]
                              },
                              {
                                "required": [
                                  "data_type"
                                ]
                              }
                            ]
                          },
                          "description": "Specifies the values found under the registry key."
                        },
                        "modified_time": {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/timestamp.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "timestamp",
                          "description": "Represents timestamps across the CTI specifications. The format is an RFC3339 timestamp, with a required timezone specification of 'Z'.",
                          "type": "string",
                          "pattern": "^[0-9]{4}-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])T([01][0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9]|60)(\\.[0-9]+)?Z$"
                        },
                        "creator_user_ref": {
                          "description": "Specifies a reference to a user account, represented as a User Account Object, that created the registry key.",
                          "type": "string"
                        },
                        "number_of_subkeys": {
                          "type": "integer",
                          "description": "Specifies the number of subkeys contained under the registry key."
                        }
                      }
                    }
                  ],
                  "anyOf": [
                    {
                      "required": [
                        "key"
                      ]
                    },
                    {
                      "required": [
                        "values"
                      ]
                    },
                    {
                      "required": [
                        "modified"
                      ]
                    },
                    {
                      "required": [
                        "creator_user_ref"
                      ]
                    },
                    {
                      "required": [
                        "number_of_subkeys"
                      ]
                    }
                  ],
                  "definitions": {
                    "windows-registry-value-type": {
                      "type": "object",
                      "properties": {
                        "name": {
                          "type": "string",
                          "description": "Specifies the name of the registry value. For specifying the default value in a registry key, an empty string MUST be used."
                        },
                        "data": {
                          "type": "string",
                          "description": "Specifies the data contained in the registry value."
                        },
                        "data_type": {
                          "type": "string",
                          "description": "Specifies the registry (REG_*) data type used in the registry value.",
                          "enum": [
                            "REG_NONE",
                            "REG_SZ",
                            "REG_EXPAND_SZ",
                            "REG_BINARY",
                            "REG_DWORD",
                            "REG_DWORD_BIG_ENDIAN",
                            "REG_DWORD_LITTLE_ENDIAN",
                            "REG_LINK",
                            "REG_MULTI_SZ",
                            "REG_RESOURCE_LIST",
                            "REG_FULL_RESOURCE_DESCRIPTION",
                            "REG_RESOURCE_REQUIREMENTS_LIST",
                            "REG_QWORD",
                            "REG_INVALID_TYPE"
                          ]
                        }
                      },
                      "anyOf": [
                        {
                          "required": [
                            "name"
                          ]
                        },
                        {
                          "required": [
                            "data"
                          ]
                        },
                        {
                          "required": [
                            "data_type"
                          ]
                        }
                      ]
                    }
                  }
                },
                {
                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/observables/x509-certificate.json",
                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                  "title": "x509-certificate",
                  "description": "The X509 Certificate Object represents the properties of an X.509 certificate.",
                  "type": "object",
                  "allOf": [
                    {
                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/cyber-observable-core.json",
                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                      "title": "cyber-observable-core",
                      "description": "Common properties and behavior across all Cyber Observable Objects.",
                      "type": "object",
                      "properties": {
                        "type": {
                          "type": "string",
                          "pattern": "^([a-z][a-z0-9]*)+(-[a-z0-9]+)*\\-?$",
                          "minLength": 3,
                          "maxLength": 250,
                          "description": "Indicates that this object is an Observable Object. The value of this property MUST be a valid Observable Object type name, but to allow for custom objects this has been removed from the schema.",
                          "not": {
                            "enum": [
                              "action"
                            ]
                          }
                        },
                        "spec_version": {
                          "type": "string",
                          "enum": [
                            "2.0",
                            "2.1"
                          ],
                          "description": "The version of the STIX specification used to represent the content in this cyber-observable."
                        },
                        "object_marking_refs": {
                          "type": "array",
                          "description": "The list of marking-definition objects to be applied to this object.",
                          "items": {
                            "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/identifier.json",
                            "$schema": "http://json-schema.org/draft/2020-12/schema#",
                            "title": "identifier",
                            "description": "Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.",
                            "type": "string",
                            "pattern": "^[a-z][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
                          },
                          "minItems": 1
                        },
                        "granular_markings": {
                          "type": "array",
                          "description": "The set of granular markings that apply to this object.",
                          "items": {
                            "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/granular-marking.json",
                            "$schema": "http://json-schema.org/draft/2020-12/schema#",
                            "title": "granular-marking",
                            "description": "The granular-marking type defines how the list of marking-definition objects referenced by the marking_refs property to apply to a set of content identified by the list of selectors in the selectors property.",
                            "type": "object",
                            "properties": {
                              "selectors": {
                                "type": "array",
                                "description": "A list of selectors for content contained within the STIX object in which this property appears.",
                                "items": {
                                  "type": "string",
                                  "pattern": "^([a-z0-9_-]{3,249}(\\.(\\[\\d+\\]|[a-z0-9_-]{1,250}))*|id)$"
                                },
                                "minItems": 1
                              },
                              "lang": {
                                "type": "string",
                                "description": "Identifies the language of the text identified by this marking."
                              },
                              "marking_ref": {
                                "allOf": [
                                  {
                                    "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/identifier.json",
                                    "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                    "title": "identifier",
                                    "description": "Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.",
                                    "type": "string",
                                    "pattern": "^[a-z][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
                                  },
                                  {
                                    "pattern": "^marking-definition--",
                                    "description": "The marking_ref property specifies the ID of the marking-definition object that describes the marking."
                                  }
                                ]
                              }
                            },
                            "required": [
                              "selectors",
                              "marking_ref"
                            ]
                          },
                          "minItems": 1
                        },
                        "defanged": {
                          "type": "boolean",
                          "description": "Defines whether or not the data contained within the object has been defanged."
                        },
                        "id": {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/identifier.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "identifier",
                          "description": "Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.",
                          "type": "string",
                          "pattern": "^[a-z][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
                        },
                        "extensions": {
                          "description": "Specifies any extensions of the object, as a dictionary.",
                          "type": "object",
                          "minProperties": 1,
                          "patternProperties": {
                            "^([a-z][a-z0-9]*)+(-[a-z0-9]+)*\\-ext$": {
                              "type": "object",
                              "minProperties": 1,
                              "allOf": [
                                {
                                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/properties.json",
                                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                  "title": "properties",
                                  "description": "Rules for custom properties",
                                  "patternProperties": {
                                    "^[a-z][a-z0-9_]{0,245}_bin$": {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/binary.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "binary",
                                      "description": "The ​binary data type represents a sequence of bytes. In order to allow pattern matching on custom objects, for all properties that use the binary type, the property name MUST end with '_bin'. The JSON MTI serialization represents this as a base64-­encoded string as specified in RFC4648​. Other serializations SHOULD use a native binary type, if available.",
                                      "type": "string",
                                      "pattern": "^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$"
                                    },
                                    "^[a-z][a-z0-9_]{0,245}_hex$": {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "hex",
                                      "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                                      "type": "string",
                                      "pattern": "^([a-fA-F0-9]{2})+$"
                                    },
                                    "^([a-z][a-z0-9_]{2,249})|id$": {
                                      "anyOf": [
                                        {
                                          "type": "array",
                                          "minItems": 1
                                        },
                                        {
                                          "type": "string"
                                        },
                                        {
                                          "type": "integer"
                                        },
                                        {
                                          "type": "boolean"
                                        },
                                        {
                                          "type": "number"
                                        },
                                        {
                                          "type": "object"
                                        }
                                      ]
                                    }
                                  },
                                  "additionalProperties": false
                                }
                              ]
                            },
                            "^extension-definition--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$": {
                              "allOf": [
                                {
                                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/extension.json",
                                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                  "type": "object",
                                  "minProperties": 1,
                                  "properties": {
                                    "extension_type": {
                                      "description": "The type of extension.",
                                      "type": "string",
                                      "enum": [
                                        "new-sdo",
                                        "new-sco",
                                        "new-sro",
                                        "property-extension",
                                        "toplevel-property-extension"
                                      ]
                                    }
                                  },
                                  "allOf": [
                                    {
                                      "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/properties.json",
                                      "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                      "title": "properties",
                                      "description": "Rules for custom properties",
                                      "patternProperties": {
                                        "^[a-z][a-z0-9_]{0,245}_bin$": {
                                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/binary.json",
                                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                          "title": "binary",
                                          "description": "The ​binary data type represents a sequence of bytes. In order to allow pattern matching on custom objects, for all properties that use the binary type, the property name MUST end with '_bin'. The JSON MTI serialization represents this as a base64-­encoded string as specified in RFC4648​. Other serializations SHOULD use a native binary type, if available.",
                                          "type": "string",
                                          "pattern": "^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$"
                                        },
                                        "^[a-z][a-z0-9_]{0,245}_hex$": {
                                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                          "title": "hex",
                                          "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                                          "type": "string",
                                          "pattern": "^([a-fA-F0-9]{2})+$"
                                        },
                                        "^([a-z][a-z0-9_]{2,249})|id$": {
                                          "anyOf": [
                                            {
                                              "type": "array",
                                              "minItems": 1
                                            },
                                            {
                                              "type": "string"
                                            },
                                            {
                                              "type": "integer"
                                            },
                                            {
                                              "type": "boolean"
                                            },
                                            {
                                              "type": "number"
                                            },
                                            {
                                              "type": "object"
                                            }
                                          ]
                                        }
                                      },
                                      "additionalProperties": false
                                    }
                                  ],
                                  "required": [
                                    "extension_type"
                                  ],
                                  "definitions": {
                                    "extension-type-enum": {
                                      "type": "string",
                                      "enum": [
                                        "new-sdo",
                                        "new-sco",
                                        "new-sro",
                                        "property-extension",
                                        "toplevel-property-extension"
                                      ]
                                    }
                                  }
                                }
                              ]
                            }
                          },
                          "additionalProperties": false
                        }
                      },
                      "allOf": [
                        {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/properties.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "properties",
                          "description": "Rules for custom properties",
                          "patternProperties": {
                            "^[a-z][a-z0-9_]{0,245}_bin$": {
                              "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/binary.json",
                              "$schema": "http://json-schema.org/draft/2020-12/schema#",
                              "title": "binary",
                              "description": "The ​binary data type represents a sequence of bytes. In order to allow pattern matching on custom objects, for all properties that use the binary type, the property name MUST end with '_bin'. The JSON MTI serialization represents this as a base64-­encoded string as specified in RFC4648​. Other serializations SHOULD use a native binary type, if available.",
                              "type": "string",
                              "pattern": "^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$"
                            },
                            "^[a-z][a-z0-9_]{0,245}_hex$": {
                              "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hex.json",
                              "$schema": "http://json-schema.org/draft/2020-12/schema#",
                              "title": "hex",
                              "description": "The hex data type encodes an array of octets (8-bit bytes) as hexadecimal. The string MUST consist of an even number of hexadecimal characters, which are the digits '0' through '9' and the letters 'a' through 'f'.  In order to allow pattern matching on custom objects, all properties that use the hex type, the property name MUST end with '_hex'.",
                              "type": "string",
                              "pattern": "^([a-fA-F0-9]{2})+$"
                            },
                            "^([a-z][a-z0-9_]{2,249})|id$": {
                              "anyOf": [
                                {
                                  "type": "array",
                                  "minItems": 1
                                },
                                {
                                  "type": "string"
                                },
                                {
                                  "type": "integer"
                                },
                                {
                                  "type": "boolean"
                                },
                                {
                                  "type": "number"
                                },
                                {
                                  "type": "object"
                                }
                              ]
                            }
                          },
                          "additionalProperties": false
                        }
                      ],
                      "not": {
                        "anyOf": [
                          {
                            "required": [
                              "severity"
                            ]
                          },
                          {
                            "required": [
                              "action"
                            ]
                          },
                          {
                            "required": [
                              "username"
                            ]
                          },
                          {
                            "required": [
                              "phone_numbers"
                            ]
                          }
                        ]
                      },
                      "required": [
                        "type",
                        "id"
                      ]
                    },
                    {
                      "properties": {
                        "type": {
                          "type": "string",
                          "description": "The value of this property MUST be `x509-certificate`.",
                          "enum": [
                            "x509-certificate"
                          ]
                        },
                        "id": {
                          "title": "id",
                          "pattern": "^x509-certificate--"
                        },
                        "is_self_signed": {
                          "type": "boolean",
                          "description": "Specifies whether the certificate is self-signed, i.e., whether it is signed by the same entity whose identity it certifies."
                        },
                        "hashes": {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/hashes-type.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "hashes",
                          "description": "The Hashes type represents one or more cryptographic hashes, as a special set of key/value pairs",
                          "type": "object",
                          "allOf": [
                            {
                              "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/dictionary.json",
                              "$schema": "http://json-schema.org/draft/2020-12/schema#",
                              "title": "dictionary",
                              "description": "A dictionary captures a set of key/value pairs",
                              "type": "object",
                              "minProperties": 1,
                              "patternProperties": {
                                "^[a-zA-Z0-9_-]{0,250}$": {
                                  "anyOf": [
                                    {
                                      "type": "array",
                                      "minItems": 1
                                    },
                                    {
                                      "type": "string"
                                    },
                                    {
                                      "type": "integer"
                                    },
                                    {
                                      "type": "boolean"
                                    },
                                    {
                                      "type": "number"
                                    },
                                    {
                                      "type": "object"
                                    }
                                  ]
                                }
                              },
                              "additionalProperties": false
                            }
                          ],
                          "patternProperties": {
                            "^[a-zA-Z0-9_-]{3,250}$": {
                              "type": "string",
                              "description": "Custom hash key"
                            },
                            "^MD5$": {
                              "type": "string",
                              "description": "Specifies the MD5 message digest algorithm.",
                              "pattern": "^[a-fA-F0-9]{32}$"
                            },
                            "^SHA-1$": {
                              "type": "string",
                              "description": "Specifies the SHA-1 (secure-hash algorithm 1) cryptographic hash function.",
                              "pattern": "^[a-fA-F0-9]{40}$"
                            },
                            "^SHA-256$": {
                              "type": "string",
                              "description": "Specifies the SHA-256 cryptographic hash function (part of the SHA2 family).",
                              "pattern": "^[a-fA-F0-9]{64}$"
                            },
                            "^SHA-512$": {
                              "type": "string",
                              "description": "Specifies the SHA-512 cryptographic hash function (part of the SHA2 family).",
                              "pattern": "^[a-fA-F0-9]{128}$"
                            },
                            "^SHA3-256$": {
                              "type": "string",
                              "description": "Specifies the SHA3-256 cryptographic hash function.",
                              "pattern": "^[a-fA-F0-9]{64}$"
                            },
                            "^SHA3-512$": {
                              "type": "string",
                              "description": "Specifies the SHA3-512 cryptographic hash function.",
                              "pattern": "^[a-fA-F0-9]{128}$"
                            },
                            "^SSDEEP$": {
                              "type": "string",
                              "description": "Specifies the ssdeep fuzzy hashing algorithm.",
                              "pattern": "^[a-zA-Z0-9/+:.]{1,128}$"
                            },
                            "^TLSH$": {
                              "type": "string",
                              "description": "Specifies the TLSH locality-sensitive hashing algorithm.",
                              "pattern": "^[a-zA-Z0-9]{70}$"
                            }
                          },
                          "additionalProperties": false
                        },
                        "version": {
                          "type": "string",
                          "description": "Specifies the version of the encoded certificate."
                        },
                        "serial_number": {
                          "type": "string",
                          "description": "Specifies the unique identifier for the certificate, as issued by a specific Certificate Authority."
                        },
                        "signature_algorithm": {
                          "type": "string",
                          "description": "Specifies the name of the algorithm used to sign the certificate."
                        },
                        "issuer": {
                          "type": "string",
                          "description": "Specifies the name of the Certificate Authority that issued the certificate."
                        },
                        "validity_not_before": {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/timestamp.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "timestamp",
                          "description": "Represents timestamps across the CTI specifications. The format is an RFC3339 timestamp, with a required timezone specification of 'Z'.",
                          "type": "string",
                          "pattern": "^[0-9]{4}-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])T([01][0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9]|60)(\\.[0-9]+)?Z$"
                        },
                        "validity_not_after": {
                          "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/timestamp.json",
                          "$schema": "http://json-schema.org/draft/2020-12/schema#",
                          "title": "timestamp",
                          "description": "Represents timestamps across the CTI specifications. The format is an RFC3339 timestamp, with a required timezone specification of 'Z'.",
                          "type": "string",
                          "pattern": "^[0-9]{4}-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])T([01][0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9]|60)(\\.[0-9]+)?Z$"
                        },
                        "subject": {
                          "type": "string",
                          "description": "Specifies the name of the entity associated with the public key stored in the subject public key field of the certificate."
                        },
                        "subject_public_key_algorithm": {
                          "type": "string",
                          "description": "Specifies the name of the algorithm with which to encrypt data being sent to the subject."
                        },
                        "subject_public_key_modulus": {
                          "type": "string",
                          "description": "Specifies the modulus portion of the subject’s public RSA key."
                        },
                        "subject_public_key_exponent": {
                          "type": "integer",
                          "description": "Specifies the exponent portion of the subject’s public RSA key, as an integer."
                        },
                        "x509_v3_extensions": {
                          "description": "Specifies any standard X.509 v3 extensions that may be used in the certificate.",
                          "type": "object",
                          "allOf": [
                            {
                              "properties": {
                                "basic_constraints": {
                                  "type": "string",
                                  "description": "Specifies a multi-valued extension which indicates whether a certificate is a CA certificate."
                                },
                                "name_constraints": {
                                  "type": "string",
                                  "description": "Specifies a namespace within which all subject names in subsequent certificates in a certification path MUST be located."
                                },
                                "policy_constraints": {
                                  "type": "string",
                                  "description": "Specifies any constraints on path validation for certificates issued to CAs."
                                },
                                "key_usage": {
                                  "type": "string",
                                  "description": "Specifies a multi-valued extension consisting of a list of names of the permitted key usages."
                                },
                                "extended_key_usage": {
                                  "type": "string",
                                  "description": "Specifies a list of usages indicating purposes for which the certificate public key can be used for."
                                },
                                "subject_key_identifier": {
                                  "type": "string",
                                  "description": "Specifies the identifier that provides a means of identifying certificates that contain a particular public key."
                                },
                                "authority_key_identifier": {
                                  "type": "string",
                                  "description": "Specifies the identifier that provides a means of identifying the public key corresponding to the private key used to sign a certificate."
                                },
                                "subject_alternative_name": {
                                  "type": "string",
                                  "description": "Specifies the additional identities to be bound to the subject of the certificate."
                                },
                                "issuer_alternative_name": {
                                  "type": "string",
                                  "description": "Specifies the additional identities to be bound to the issuer of the certificate."
                                },
                                "subject_directory_attributes": {
                                  "type": "string",
                                  "description": "Specifies the identification attributes (e.g., nationality) of the subject."
                                },
                                "crl_distribution_points": {
                                  "type": "string",
                                  "description": "Specifies how CRL information is obtained."
                                },
                                "inhibit_any_policy": {
                                  "type": "string",
                                  "description": "Specifies the number of additional certificates that may appear in the path before anyPolicy is no longer permitted."
                                },
                                "private_key_usage_period_not_before": {
                                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/timestamp.json",
                                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                  "title": "timestamp",
                                  "description": "Represents timestamps across the CTI specifications. The format is an RFC3339 timestamp, with a required timezone specification of 'Z'.",
                                  "type": "string",
                                  "pattern": "^[0-9]{4}-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])T([01][0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9]|60)(\\.[0-9]+)?Z$"
                                },
                                "private_key_usage_period_not_after": {
                                  "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/timestamp.json",
                                  "$schema": "http://json-schema.org/draft/2020-12/schema#",
                                  "title": "timestamp",
                                  "description": "Represents timestamps across the CTI specifications. The format is an RFC3339 timestamp, with a required timezone specification of 'Z'.",
                                  "type": "string",
                                  "pattern": "^[0-9]{4}-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])T([01][0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9]|60)(\\.[0-9]+)?Z$"
                                },
                                "certificate_policies": {
                                  "type": "string",
                                  "description": "Specifies a sequence of one or more policy information terms, each of which consists of an object identifier (OID) and optional qualifiers."
                                },
                                "policy_mappings": {
                                  "type": "string",
                                  "description": "Specifies one or more pairs of OIDs; each pair includes an issuerDomainPolicy and a subjectDomainPolicy"
                                }
                              }
                            },
                            {
                              "anyOf": [
                                {
                                  "required": [
                                    "basic_constraints"
                                  ]
                                },
                                {
                                  "required": [
                                    "name_constraints"
                                  ]
                                },
                                {
                                  "required": [
                                    "policy_constraints"
                                  ]
                                },
                                {
                                  "required": [
                                    "key_usage"
                                  ]
                                },
                                {
                                  "required": [
                                    "extended_key_usage"
                                  ]
                                },
                                {
                                  "required": [
                                    "subject_key_identifier"
                                  ]
                                },
                                {
                                  "required": [
                                    "authority_key_identifier"
                                  ]
                                },
                                {
                                  "required": [
                                    "subject_alternative_name"
                                  ]
                                },
                                {
                                  "required": [
                                    "issuer_alternative_name"
                                  ]
                                },
                                {
                                  "required": [
                                    "subject_directory_attributes"
                                  ]
                                },
                                {
                                  "required": [
                                    "crl_distribution_points"
                                  ]
                                },
                                {
                                  "required": [
                                    "inhibit_any_policy"
                                  ]
                                },
                                {
                                  "required": [
                                    "private_key_usage_period_not_before"
                                  ]
                                },
                                {
                                  "required": [
                                    "private_key_usage_period_not_after"
                                  ]
                                },
                                {
                                  "required": [
                                    "certificate_policies"
                                  ]
                                },
                                {
                                  "required": [
                                    "policy_mappings"
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      }
                    },
                    {
                      "anyOf": [
                        {
                          "required": [
                            "is_self_signed"
                          ]
                        },
                        {
                          "required": [
                            "hashes"
                          ]
                        },
                        {
                          "required": [
                            "version"
                          ]
                        },
                        {
                          "required": [
                            "serial_number"
                          ]
                        },
                        {
                          "required": [
                            "signature_algorithm"
                          ]
                        },
                        {
                          "required": [
                            "issuer"
                          ]
                        },
                        {
                          "required": [
                            "validity_not_before"
                          ]
                        },
                        {
                          "required": [
                            "validity_not_after"
                          ]
                        },
                        {
                          "required": [
                            "subject"
                          ]
                        },
                        {
                          "required": [
                            "subject_public_key_algorithm"
                          ]
                        },
                        {
                          "required": [
                            "subject_public_key_modulus"
                          ]
                        },
                        {
                          "required": [
                            "subject_public_key_exponent"
                          ]
                        },
                        {
                          "required": [
                            "x509_v3_extensions"
                          ]
                        }
                      ]
                    }
                  ],
                  "definitions": {
                    "x509-v3-extensions-type": {
                      "type": "object",
                      "allOf": [
                        {
                          "properties": {
                            "basic_constraints": {
                              "type": "string",
                              "description": "Specifies a multi-valued extension which indicates whether a certificate is a CA certificate."
                            },
                            "name_constraints": {
                              "type": "string",
                              "description": "Specifies a namespace within which all subject names in subsequent certificates in a certification path MUST be located."
                            },
                            "policy_constraints": {
                              "type": "string",
                              "description": "Specifies any constraints on path validation for certificates issued to CAs."
                            },
                            "key_usage": {
                              "type": "string",
                              "description": "Specifies a multi-valued extension consisting of a list of names of the permitted key usages."
                            },
                            "extended_key_usage": {
                              "type": "string",
                              "description": "Specifies a list of usages indicating purposes for which the certificate public key can be used for."
                            },
                            "subject_key_identifier": {
                              "type": "string",
                              "description": "Specifies the identifier that provides a means of identifying certificates that contain a particular public key."
                            },
                            "authority_key_identifier": {
                              "type": "string",
                              "description": "Specifies the identifier that provides a means of identifying the public key corresponding to the private key used to sign a certificate."
                            },
                            "subject_alternative_name": {
                              "type": "string",
                              "description": "Specifies the additional identities to be bound to the subject of the certificate."
                            },
                            "issuer_alternative_name": {
                              "type": "string",
                              "description": "Specifies the additional identities to be bound to the issuer of the certificate."
                            },
                            "subject_directory_attributes": {
                              "type": "string",
                              "description": "Specifies the identification attributes (e.g., nationality) of the subject."
                            },
                            "crl_distribution_points": {
                              "type": "string",
                              "description": "Specifies how CRL information is obtained."
                            },
                            "inhibit_any_policy": {
                              "type": "string",
                              "description": "Specifies the number of additional certificates that may appear in the path before anyPolicy is no longer permitted."
                            },
                            "private_key_usage_period_not_before": {
                              "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/timestamp.json",
                              "$schema": "http://json-schema.org/draft/2020-12/schema#",
                              "title": "timestamp",
                              "description": "Represents timestamps across the CTI specifications. The format is an RFC3339 timestamp, with a required timezone specification of 'Z'.",
                              "type": "string",
                              "pattern": "^[0-9]{4}-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])T([01][0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9]|60)(\\.[0-9]+)?Z$"
                            },
                            "private_key_usage_period_not_after": {
                              "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/timestamp.json",
                              "$schema": "http://json-schema.org/draft/2020-12/schema#",
                              "title": "timestamp",
                              "description": "Represents timestamps across the CTI specifications. The format is an RFC3339 timestamp, with a required timezone specification of 'Z'.",
                              "type": "string",
                              "pattern": "^[0-9]{4}-(0[1-9]|1[012])-(0[1-9]|[12][0-9]|3[01])T([01][0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9]|60)(\\.[0-9]+)?Z$"
                            },
                            "certificate_policies": {
                              "type": "string",
                              "description": "Specifies a sequence of one or more policy information terms, each of which consists of an object identifier (OID) and optional qualifiers."
                            },
                            "policy_mappings": {
                              "type": "string",
                              "description": "Specifies one or more pairs of OIDs; each pair includes an issuerDomainPolicy and a subjectDomainPolicy"
                            }
                          }
                        },
                        {
                          "anyOf": [
                            {
                              "required": [
                                "basic_constraints"
                              ]
                            },
                            {
                              "required": [
                                "name_constraints"
                              ]
                            },
                            {
                              "required": [
                                "policy_constraints"
                              ]
                            },
                            {
                              "required": [
                                "key_usage"
                              ]
                            },
                            {
                              "required": [
                                "extended_key_usage"
                              ]
                            },
                            {
                              "required": [
                                "subject_key_identifier"
                              ]
                            },
                            {
                              "required": [
                                "authority_key_identifier"
                              ]
                            },
                            {
                              "required": [
                                "subject_alternative_name"
                              ]
                            },
                            {
                              "required": [
                                "issuer_alternative_name"
                              ]
                            },
                            {
                              "required": [
                                "subject_directory_attributes"
                              ]
                            },
                            {
                              "required": [
                                "crl_distribution_points"
                              ]
                            },
                            {
                              "required": [
                                "inhibit_any_policy"
                              ]
                            },
                            {
                              "required": [
                                "private_key_usage_period_not_before"
                              ]
                            },
                            {
                              "required": [
                                "private_key_usage_period_not_after"
                              ]
                            },
                            {
                              "required": [
                                "certificate_policies"
                              ]
                            },
                            {
                              "required": [
                                "policy_mappings"
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  }
                }
              ]
            }
          }
        },
        "object_refs": {
          "type": "array",
          "description": "A list of SCOs and SROs representing the observation.",
          "items": {
            "$id": "http://raw.githubusercontent.com/oasis-open/cti-stix2-json-schemas/stix2.1/schemas/common/identifier.json",
            "$schema": "http://json-schema.org/draft/2020-12/schema#",
            "title": "identifier",
            "description": "Represents identifiers across the CTI specifications. The format consists of the name of the top-level object being identified, followed by two dashes (--), followed by a UUIDv4.",
            "type": "string",
            "pattern": "^[a-z][a-z0-9-]+[a-z0-9]--[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-5][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$"
          },
          "minItems": 1
        }
      }
    }
  ],
  "required": [
    "first_observed",
    "last_observed",
    "number_observed"
  ],
  "oneOf": [
    {
      "required": [
        "objects"
      ]
    },
    {
      "required": [
        "object_refs"
      ]
    }
  ]
}